async function setManualInputStyles(){await timeout({milliseconds:300}),isDarkThemeEnabled()?addDarkManualInputStyles():removeDarkManualInputStyles()}function isDarkThemeEnabled(){return"dark"===getThemeName()}function getThemeName(){return Array.from(document.documentElement.classList).find((t=>t.startsWith("theme_"))).replace("theme_","")}function addDarkManualInputStyles(){if($(".clockify-custom-style-dark"))return;const t=createTag("style","clockify-custom-style-dark","\n\t\t.clockify-input {\n\t\t\tbackground: #1f1f1f !important;\n\t\t\tcolor: #eee !important;\n\t\t\tborder: 1px solid #444 !important;\n\t\t}\n\t");document.head.append(t)}function removeDarkManualInputStyles(){$(".clockify-custom-style-dark")?.remove()}function withoutSection(t){return Boolean(t)?t.includes("/")?t.split("/")[0]:t:null}function observeBodyChanges(){const t=new MutationObserver(bodyChanges),e=document.body;t.observe(e,{childList:!0})}async function bodyChanges(){await timeout({milliseconds:500});const t=$('[data-testid="task-details-modal"]'),e=$(".clockify-integration-popup");if(!t||!e)return;const a=$(".task-overview-content",t),n=$(".clockify-input",t),o=["textarea","input"].map((t=>$$(t,e))).map((t=>Array.from(t))).flat();blockPropagation({elements:[a,n],eventName:"focusout"}),blockPropagation({elements:o,eventName:"focusin"})}function blockPropagation({elements:t=[],eventName:e}){t.forEach((t=>t.addEventListener(e,(t=>t.stopPropagation()))))}clockifyButton.render('[data-action-hint="task-root"]:not(.clockify)',{observe:!0},(t=>{const e=text(".task_content",t),a={description:text(".task_description",t)??e,projectName:withoutSection(text('[data-testid="task-details-modal"] button[aria-label="Select a project"] span')||text(".task_list_item__project",t)||text("header h1 .simple_content")||text("header h1")),taskName:e,tagNames:()=>textList(".task_list_item__info_tags__label",t),small:!0},n=clockifyButton.createButton(a);n.style.paddingRight="10px",n.style.marginTop="12px",n.style.height="fit-content",t.prepend(n)})),clockifyButton.render('[data-testid="task-card"]:not(.clockify)',{observe:!0},(t=>{const e=text(".task_content",t),a={description:text(".task_description",t)??e,projectName:withoutSection(text(".task_list_item__project",t)||text("header h1")),taskName:e,small:!0},n=clockifyButton.createButton(a);t.style.minHeight="70px",n.style.position="absolute",n.style.top="40px",n.style.left="13px",t.append(n)})),clockifyButton.render('[data-testid="task-details-modal"]:not(.clockify)',{observe:!0},(t=>{const e=()=>text(".task-overview-content .task_content",t),a={description:()=>text(".task-overview-description .task_content",t)??e(),projectName:()=>withoutSection(text('button[aria-label="Select a project"] span',t)),taskName:()=>e(),tagNames:()=>textList("[data-item-label-name]",t),small:!0},n=clockifyButton.createButton(a),o=clockifyButton.createInput(a);n.style.marginRight="20px";const s=createTag("div","clockify-widget-container");s.style.padding="2px 8px",s.style.width="190px",s.style.display="flex",s.style.alignItems="center",s.style.justifyContent="space-between",s.append(n),s.append(o);const i=$('[data-testid="task-details-sidebar"]',t);i.style.justifyContent="start",i.append(s)})),setManualInputStyles(),observeBodyChanges();