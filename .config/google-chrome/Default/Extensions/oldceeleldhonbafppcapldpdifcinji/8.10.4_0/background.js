(()=>{var e={4080:e=>{e.exports&&(e.exports=function(){var e=3,t=4,r=12,n=13,s=16,a=17;function i(e,t){void 0===t&&(t=0);var r=e.charCodeAt(t);if(55296<=r&&r<=56319&&t<e.length-1){var n=r;return 56320<=(s=e.charCodeAt(t+1))&&s<=57343?1024*(n-55296)+(s-56320)+65536:n}if(56320<=r&&r<=57343&&t>=1){var s=r;return 55296<=(n=e.charCodeAt(t-1))&&n<=56319?1024*(n-55296)+(s-56320)+65536:s}return r}function o(i,o,c){var l=[i].concat(o).concat([c]),u=l[l.length-2],g=c,d=l.lastIndexOf(14);if(d>1&&l.slice(1,d).every((function(t){return t==e}))&&-1==[e,n,a].indexOf(i))return 2;var h=l.lastIndexOf(t);if(h>0&&l.slice(1,h).every((function(e){return e==t}))&&-1==[r,t].indexOf(u))return l.filter((function(e){return e==t})).length%2==1?3:4;if(0==u&&1==g)return 0;if(2==u||0==u||1==u)return 14==g&&o.every((function(t){return t==e}))?2:1;if(2==g||0==g||1==g)return 1;if(6==u&&(6==g||7==g||9==g||10==g))return 0;if(!(9!=u&&7!=u||7!=g&&8!=g))return 0;if((10==u||8==u)&&8==g)return 0;if(g==e||15==g)return 0;if(5==g)return 0;if(u==r)return 0;var m=-1!=l.indexOf(e)?l.lastIndexOf(e)-1:l.length-2;return-1!=[n,a].indexOf(l[m])&&l.slice(m+1,-1).every((function(t){return t==e}))&&14==g||15==u&&-1!=[s,a].indexOf(g)?0:-1!=o.indexOf(t)?2:u==t&&g==t?0:1}function c(i){return 1536<=i&&i<=1541||1757==i||1807==i||2274==i||3406==i||69821==i||70082<=i&&i<=70083||72250==i||72326<=i&&i<=72329||73030==i?r:13==i?0:10==i?1:0<=i&&i<=9||11<=i&&i<=12||14<=i&&i<=31||127<=i&&i<=159||173==i||1564==i||6158==i||8203==i||8206<=i&&i<=8207||8232==i||8233==i||8234<=i&&i<=8238||8288<=i&&i<=8292||8293==i||8294<=i&&i<=8303||55296<=i&&i<=57343||65279==i||65520<=i&&i<=65528||65529<=i&&i<=65531||113824<=i&&i<=113827||119155<=i&&i<=119162||917504==i||917505==i||917506<=i&&i<=917535||917632<=i&&i<=917759||918e3<=i&&i<=921599?2:768<=i&&i<=879||1155<=i&&i<=1159||1160<=i&&i<=1161||1425<=i&&i<=1469||1471==i||1473<=i&&i<=1474||1476<=i&&i<=1477||1479==i||1552<=i&&i<=1562||1611<=i&&i<=1631||1648==i||1750<=i&&i<=1756||1759<=i&&i<=1764||1767<=i&&i<=1768||1770<=i&&i<=1773||1809==i||1840<=i&&i<=1866||1958<=i&&i<=1968||2027<=i&&i<=2035||2070<=i&&i<=2073||2075<=i&&i<=2083||2085<=i&&i<=2087||2089<=i&&i<=2093||2137<=i&&i<=2139||2260<=i&&i<=2273||2275<=i&&i<=2306||2362==i||2364==i||2369<=i&&i<=2376||2381==i||2385<=i&&i<=2391||2402<=i&&i<=2403||2433==i||2492==i||2494==i||2497<=i&&i<=2500||2509==i||2519==i||2530<=i&&i<=2531||2561<=i&&i<=2562||2620==i||2625<=i&&i<=2626||2631<=i&&i<=2632||2635<=i&&i<=2637||2641==i||2672<=i&&i<=2673||2677==i||2689<=i&&i<=2690||2748==i||2753<=i&&i<=2757||2759<=i&&i<=2760||2765==i||2786<=i&&i<=2787||2810<=i&&i<=2815||2817==i||2876==i||2878==i||2879==i||2881<=i&&i<=2884||2893==i||2902==i||2903==i||2914<=i&&i<=2915||2946==i||3006==i||3008==i||3021==i||3031==i||3072==i||3134<=i&&i<=3136||3142<=i&&i<=3144||3146<=i&&i<=3149||3157<=i&&i<=3158||3170<=i&&i<=3171||3201==i||3260==i||3263==i||3266==i||3270==i||3276<=i&&i<=3277||3285<=i&&i<=3286||3298<=i&&i<=3299||3328<=i&&i<=3329||3387<=i&&i<=3388||3390==i||3393<=i&&i<=3396||3405==i||3415==i||3426<=i&&i<=3427||3530==i||3535==i||3538<=i&&i<=3540||3542==i||3551==i||3633==i||3636<=i&&i<=3642||3655<=i&&i<=3662||3761==i||3764<=i&&i<=3769||3771<=i&&i<=3772||3784<=i&&i<=3789||3864<=i&&i<=3865||3893==i||3895==i||3897==i||3953<=i&&i<=3966||3968<=i&&i<=3972||3974<=i&&i<=3975||3981<=i&&i<=3991||3993<=i&&i<=4028||4038==i||4141<=i&&i<=4144||4146<=i&&i<=4151||4153<=i&&i<=4154||4157<=i&&i<=4158||4184<=i&&i<=4185||4190<=i&&i<=4192||4209<=i&&i<=4212||4226==i||4229<=i&&i<=4230||4237==i||4253==i||4957<=i&&i<=4959||5906<=i&&i<=5908||5938<=i&&i<=5940||5970<=i&&i<=5971||6002<=i&&i<=6003||6068<=i&&i<=6069||6071<=i&&i<=6077||6086==i||6089<=i&&i<=6099||6109==i||6155<=i&&i<=6157||6277<=i&&i<=6278||6313==i||6432<=i&&i<=6434||6439<=i&&i<=6440||6450==i||6457<=i&&i<=6459||6679<=i&&i<=6680||6683==i||6742==i||6744<=i&&i<=6750||6752==i||6754==i||6757<=i&&i<=6764||6771<=i&&i<=6780||6783==i||6832<=i&&i<=6845||6846==i||6912<=i&&i<=6915||6964==i||6966<=i&&i<=6970||6972==i||6978==i||7019<=i&&i<=7027||7040<=i&&i<=7041||7074<=i&&i<=7077||7080<=i&&i<=7081||7083<=i&&i<=7085||7142==i||7144<=i&&i<=7145||7149==i||7151<=i&&i<=7153||7212<=i&&i<=7219||7222<=i&&i<=7223||7376<=i&&i<=7378||7380<=i&&i<=7392||7394<=i&&i<=7400||7405==i||7412==i||7416<=i&&i<=7417||7616<=i&&i<=7673||7675<=i&&i<=7679||8204==i||8400<=i&&i<=8412||8413<=i&&i<=8416||8417==i||8418<=i&&i<=8420||8421<=i&&i<=8432||11503<=i&&i<=11505||11647==i||11744<=i&&i<=11775||12330<=i&&i<=12333||12334<=i&&i<=12335||12441<=i&&i<=12442||42607==i||42608<=i&&i<=42610||42612<=i&&i<=42621||42654<=i&&i<=42655||42736<=i&&i<=42737||43010==i||43014==i||43019==i||43045<=i&&i<=43046||43204<=i&&i<=43205||43232<=i&&i<=43249||43302<=i&&i<=43309||43335<=i&&i<=43345||43392<=i&&i<=43394||43443==i||43446<=i&&i<=43449||43452==i||43493==i||43561<=i&&i<=43566||43569<=i&&i<=43570||43573<=i&&i<=43574||43587==i||43596==i||43644==i||43696==i||43698<=i&&i<=43700||43703<=i&&i<=43704||43710<=i&&i<=43711||43713==i||43756<=i&&i<=43757||43766==i||44005==i||44008==i||44013==i||64286==i||65024<=i&&i<=65039||65056<=i&&i<=65071||65438<=i&&i<=65439||66045==i||66272==i||66422<=i&&i<=66426||68097<=i&&i<=68099||68101<=i&&i<=68102||68108<=i&&i<=68111||68152<=i&&i<=68154||68159==i||68325<=i&&i<=68326||69633==i||69688<=i&&i<=69702||69759<=i&&i<=69761||69811<=i&&i<=69814||69817<=i&&i<=69818||69888<=i&&i<=69890||69927<=i&&i<=69931||69933<=i&&i<=69940||70003==i||70016<=i&&i<=70017||70070<=i&&i<=70078||70090<=i&&i<=70092||70191<=i&&i<=70193||70196==i||70198<=i&&i<=70199||70206==i||70367==i||70371<=i&&i<=70378||70400<=i&&i<=70401||70460==i||70462==i||70464==i||70487==i||70502<=i&&i<=70508||70512<=i&&i<=70516||70712<=i&&i<=70719||70722<=i&&i<=70724||70726==i||70832==i||70835<=i&&i<=70840||70842==i||70845==i||70847<=i&&i<=70848||70850<=i&&i<=70851||71087==i||71090<=i&&i<=71093||71100<=i&&i<=71101||71103<=i&&i<=71104||71132<=i&&i<=71133||71219<=i&&i<=71226||71229==i||71231<=i&&i<=71232||71339==i||71341==i||71344<=i&&i<=71349||71351==i||71453<=i&&i<=71455||71458<=i&&i<=71461||71463<=i&&i<=71467||72193<=i&&i<=72198||72201<=i&&i<=72202||72243<=i&&i<=72248||72251<=i&&i<=72254||72263==i||72273<=i&&i<=72278||72281<=i&&i<=72283||72330<=i&&i<=72342||72344<=i&&i<=72345||72752<=i&&i<=72758||72760<=i&&i<=72765||72767==i||72850<=i&&i<=72871||72874<=i&&i<=72880||72882<=i&&i<=72883||72885<=i&&i<=72886||73009<=i&&i<=73014||73018==i||73020<=i&&i<=73021||73023<=i&&i<=73029||73031==i||92912<=i&&i<=92916||92976<=i&&i<=92982||94095<=i&&i<=94098||113821<=i&&i<=113822||119141==i||119143<=i&&i<=119145||119150<=i&&i<=119154||119163<=i&&i<=119170||119173<=i&&i<=119179||119210<=i&&i<=119213||119362<=i&&i<=119364||121344<=i&&i<=121398||121403<=i&&i<=121452||121461==i||121476==i||121499<=i&&i<=121503||121505<=i&&i<=121519||122880<=i&&i<=122886||122888<=i&&i<=122904||122907<=i&&i<=122913||122915<=i&&i<=122916||122918<=i&&i<=122922||125136<=i&&i<=125142||125252<=i&&i<=125258||917536<=i&&i<=917631||917760<=i&&i<=917999?e:127462<=i&&i<=127487?t:2307==i||2363==i||2366<=i&&i<=2368||2377<=i&&i<=2380||2382<=i&&i<=2383||2434<=i&&i<=2435||2495<=i&&i<=2496||2503<=i&&i<=2504||2507<=i&&i<=2508||2563==i||2622<=i&&i<=2624||2691==i||2750<=i&&i<=2752||2761==i||2763<=i&&i<=2764||2818<=i&&i<=2819||2880==i||2887<=i&&i<=2888||2891<=i&&i<=2892||3007==i||3009<=i&&i<=3010||3014<=i&&i<=3016||3018<=i&&i<=3020||3073<=i&&i<=3075||3137<=i&&i<=3140||3202<=i&&i<=3203||3262==i||3264<=i&&i<=3265||3267<=i&&i<=3268||3271<=i&&i<=3272||3274<=i&&i<=3275||3330<=i&&i<=3331||3391<=i&&i<=3392||3398<=i&&i<=3400||3402<=i&&i<=3404||3458<=i&&i<=3459||3536<=i&&i<=3537||3544<=i&&i<=3550||3570<=i&&i<=3571||3635==i||3763==i||3902<=i&&i<=3903||3967==i||4145==i||4155<=i&&i<=4156||4182<=i&&i<=4183||4228==i||6070==i||6078<=i&&i<=6085||6087<=i&&i<=6088||6435<=i&&i<=6438||6441<=i&&i<=6443||6448<=i&&i<=6449||6451<=i&&i<=6456||6681<=i&&i<=6682||6741==i||6743==i||6765<=i&&i<=6770||6916==i||6965==i||6971==i||6973<=i&&i<=6977||6979<=i&&i<=6980||7042==i||7073==i||7078<=i&&i<=7079||7082==i||7143==i||7146<=i&&i<=7148||7150==i||7154<=i&&i<=7155||7204<=i&&i<=7211||7220<=i&&i<=7221||7393==i||7410<=i&&i<=7411||7415==i||43043<=i&&i<=43044||43047==i||43136<=i&&i<=43137||43188<=i&&i<=43203||43346<=i&&i<=43347||43395==i||43444<=i&&i<=43445||43450<=i&&i<=43451||43453<=i&&i<=43456||43567<=i&&i<=43568||43571<=i&&i<=43572||43597==i||43755==i||43758<=i&&i<=43759||43765==i||44003<=i&&i<=44004||44006<=i&&i<=44007||44009<=i&&i<=44010||44012==i||69632==i||69634==i||69762==i||69808<=i&&i<=69810||69815<=i&&i<=69816||69932==i||70018==i||70067<=i&&i<=70069||70079<=i&&i<=70080||70188<=i&&i<=70190||70194<=i&&i<=70195||70197==i||70368<=i&&i<=70370||70402<=i&&i<=70403||70463==i||70465<=i&&i<=70468||70471<=i&&i<=70472||70475<=i&&i<=70477||70498<=i&&i<=70499||70709<=i&&i<=70711||70720<=i&&i<=70721||70725==i||70833<=i&&i<=70834||70841==i||70843<=i&&i<=70844||70846==i||70849==i||71088<=i&&i<=71089||71096<=i&&i<=71099||71102==i||71216<=i&&i<=71218||71227<=i&&i<=71228||71230==i||71340==i||71342<=i&&i<=71343||71350==i||71456<=i&&i<=71457||71462==i||72199<=i&&i<=72200||72249==i||72279<=i&&i<=72280||72343==i||72751==i||72766==i||72873==i||72881==i||72884==i||94033<=i&&i<=94078||119142==i||119149==i?5:4352<=i&&i<=4447||43360<=i&&i<=43388?6:4448<=i&&i<=4519||55216<=i&&i<=55238?7:4520<=i&&i<=4607||55243<=i&&i<=55291?8:44032==i||44060==i||44088==i||44116==i||44144==i||44172==i||44200==i||44228==i||44256==i||44284==i||44312==i||44340==i||44368==i||44396==i||44424==i||44452==i||44480==i||44508==i||44536==i||44564==i||44592==i||44620==i||44648==i||44676==i||44704==i||44732==i||44760==i||44788==i||44816==i||44844==i||44872==i||44900==i||44928==i||44956==i||44984==i||45012==i||45040==i||45068==i||45096==i||45124==i||45152==i||45180==i||45208==i||45236==i||45264==i||45292==i||45320==i||45348==i||45376==i||45404==i||45432==i||45460==i||45488==i||45516==i||45544==i||45572==i||45600==i||45628==i||45656==i||45684==i||45712==i||45740==i||45768==i||45796==i||45824==i||45852==i||45880==i||45908==i||45936==i||45964==i||45992==i||46020==i||46048==i||46076==i||46104==i||46132==i||46160==i||46188==i||46216==i||46244==i||46272==i||46300==i||46328==i||46356==i||46384==i||46412==i||46440==i||46468==i||46496==i||46524==i||46552==i||46580==i||46608==i||46636==i||46664==i||46692==i||46720==i||46748==i||46776==i||46804==i||46832==i||46860==i||46888==i||46916==i||46944==i||46972==i||47e3==i||47028==i||47056==i||47084==i||47112==i||47140==i||47168==i||47196==i||47224==i||47252==i||47280==i||47308==i||47336==i||47364==i||47392==i||47420==i||47448==i||47476==i||47504==i||47532==i||47560==i||47588==i||47616==i||47644==i||47672==i||47700==i||47728==i||47756==i||47784==i||47812==i||47840==i||47868==i||47896==i||47924==i||47952==i||47980==i||48008==i||48036==i||48064==i||48092==i||48120==i||48148==i||48176==i||48204==i||48232==i||48260==i||48288==i||48316==i||48344==i||48372==i||48400==i||48428==i||48456==i||48484==i||48512==i||48540==i||48568==i||48596==i||48624==i||48652==i||48680==i||48708==i||48736==i||48764==i||48792==i||48820==i||48848==i||48876==i||48904==i||48932==i||48960==i||48988==i||49016==i||49044==i||49072==i||49100==i||49128==i||49156==i||49184==i||49212==i||49240==i||49268==i||49296==i||49324==i||49352==i||49380==i||49408==i||49436==i||49464==i||49492==i||49520==i||49548==i||49576==i||49604==i||49632==i||49660==i||49688==i||49716==i||49744==i||49772==i||49800==i||49828==i||49856==i||49884==i||49912==i||49940==i||49968==i||49996==i||50024==i||50052==i||50080==i||50108==i||50136==i||50164==i||50192==i||50220==i||50248==i||50276==i||50304==i||50332==i||50360==i||50388==i||50416==i||50444==i||50472==i||50500==i||50528==i||50556==i||50584==i||50612==i||50640==i||50668==i||50696==i||50724==i||50752==i||50780==i||50808==i||50836==i||50864==i||50892==i||50920==i||50948==i||50976==i||51004==i||51032==i||51060==i||51088==i||51116==i||51144==i||51172==i||51200==i||51228==i||51256==i||51284==i||51312==i||51340==i||51368==i||51396==i||51424==i||51452==i||51480==i||51508==i||51536==i||51564==i||51592==i||51620==i||51648==i||51676==i||51704==i||51732==i||51760==i||51788==i||51816==i||51844==i||51872==i||51900==i||51928==i||51956==i||51984==i||52012==i||52040==i||52068==i||52096==i||52124==i||52152==i||52180==i||52208==i||52236==i||52264==i||52292==i||52320==i||52348==i||52376==i||52404==i||52432==i||52460==i||52488==i||52516==i||52544==i||52572==i||52600==i||52628==i||52656==i||52684==i||52712==i||52740==i||52768==i||52796==i||52824==i||52852==i||52880==i||52908==i||52936==i||52964==i||52992==i||53020==i||53048==i||53076==i||53104==i||53132==i||53160==i||53188==i||53216==i||53244==i||53272==i||53300==i||53328==i||53356==i||53384==i||53412==i||53440==i||53468==i||53496==i||53524==i||53552==i||53580==i||53608==i||53636==i||53664==i||53692==i||53720==i||53748==i||53776==i||53804==i||53832==i||53860==i||53888==i||53916==i||53944==i||53972==i||54e3==i||54028==i||54056==i||54084==i||54112==i||54140==i||54168==i||54196==i||54224==i||54252==i||54280==i||54308==i||54336==i||54364==i||54392==i||54420==i||54448==i||54476==i||54504==i||54532==i||54560==i||54588==i||54616==i||54644==i||54672==i||54700==i||54728==i||54756==i||54784==i||54812==i||54840==i||54868==i||54896==i||54924==i||54952==i||54980==i||55008==i||55036==i||55064==i||55092==i||55120==i||55148==i||55176==i?9:44033<=i&&i<=44059||44061<=i&&i<=44087||44089<=i&&i<=44115||44117<=i&&i<=44143||44145<=i&&i<=44171||44173<=i&&i<=44199||44201<=i&&i<=44227||44229<=i&&i<=44255||44257<=i&&i<=44283||44285<=i&&i<=44311||44313<=i&&i<=44339||44341<=i&&i<=44367||44369<=i&&i<=44395||44397<=i&&i<=44423||44425<=i&&i<=44451||44453<=i&&i<=44479||44481<=i&&i<=44507||44509<=i&&i<=44535||44537<=i&&i<=44563||44565<=i&&i<=44591||44593<=i&&i<=44619||44621<=i&&i<=44647||44649<=i&&i<=44675||44677<=i&&i<=44703||44705<=i&&i<=44731||44733<=i&&i<=44759||44761<=i&&i<=44787||44789<=i&&i<=44815||44817<=i&&i<=44843||44845<=i&&i<=44871||44873<=i&&i<=44899||44901<=i&&i<=44927||44929<=i&&i<=44955||44957<=i&&i<=44983||44985<=i&&i<=45011||45013<=i&&i<=45039||45041<=i&&i<=45067||45069<=i&&i<=45095||45097<=i&&i<=45123||45125<=i&&i<=45151||45153<=i&&i<=45179||45181<=i&&i<=45207||45209<=i&&i<=45235||45237<=i&&i<=45263||45265<=i&&i<=45291||45293<=i&&i<=45319||45321<=i&&i<=45347||45349<=i&&i<=45375||45377<=i&&i<=45403||45405<=i&&i<=45431||45433<=i&&i<=45459||45461<=i&&i<=45487||45489<=i&&i<=45515||45517<=i&&i<=45543||45545<=i&&i<=45571||45573<=i&&i<=45599||45601<=i&&i<=45627||45629<=i&&i<=45655||45657<=i&&i<=45683||45685<=i&&i<=45711||45713<=i&&i<=45739||45741<=i&&i<=45767||45769<=i&&i<=45795||45797<=i&&i<=45823||45825<=i&&i<=45851||45853<=i&&i<=45879||45881<=i&&i<=45907||45909<=i&&i<=45935||45937<=i&&i<=45963||45965<=i&&i<=45991||45993<=i&&i<=46019||46021<=i&&i<=46047||46049<=i&&i<=46075||46077<=i&&i<=46103||46105<=i&&i<=46131||46133<=i&&i<=46159||46161<=i&&i<=46187||46189<=i&&i<=46215||46217<=i&&i<=46243||46245<=i&&i<=46271||46273<=i&&i<=46299||46301<=i&&i<=46327||46329<=i&&i<=46355||46357<=i&&i<=46383||46385<=i&&i<=46411||46413<=i&&i<=46439||46441<=i&&i<=46467||46469<=i&&i<=46495||46497<=i&&i<=46523||46525<=i&&i<=46551||46553<=i&&i<=46579||46581<=i&&i<=46607||46609<=i&&i<=46635||46637<=i&&i<=46663||46665<=i&&i<=46691||46693<=i&&i<=46719||46721<=i&&i<=46747||46749<=i&&i<=46775||46777<=i&&i<=46803||46805<=i&&i<=46831||46833<=i&&i<=46859||46861<=i&&i<=46887||46889<=i&&i<=46915||46917<=i&&i<=46943||46945<=i&&i<=46971||46973<=i&&i<=46999||47001<=i&&i<=47027||47029<=i&&i<=47055||47057<=i&&i<=47083||47085<=i&&i<=47111||47113<=i&&i<=47139||47141<=i&&i<=47167||47169<=i&&i<=47195||47197<=i&&i<=47223||47225<=i&&i<=47251||47253<=i&&i<=47279||47281<=i&&i<=47307||47309<=i&&i<=47335||47337<=i&&i<=47363||47365<=i&&i<=47391||47393<=i&&i<=47419||47421<=i&&i<=47447||47449<=i&&i<=47475||47477<=i&&i<=47503||47505<=i&&i<=47531||47533<=i&&i<=47559||47561<=i&&i<=47587||47589<=i&&i<=47615||47617<=i&&i<=47643||47645<=i&&i<=47671||47673<=i&&i<=47699||47701<=i&&i<=47727||47729<=i&&i<=47755||47757<=i&&i<=47783||47785<=i&&i<=47811||47813<=i&&i<=47839||47841<=i&&i<=47867||47869<=i&&i<=47895||47897<=i&&i<=47923||47925<=i&&i<=47951||47953<=i&&i<=47979||47981<=i&&i<=48007||48009<=i&&i<=48035||48037<=i&&i<=48063||48065<=i&&i<=48091||48093<=i&&i<=48119||48121<=i&&i<=48147||48149<=i&&i<=48175||48177<=i&&i<=48203||48205<=i&&i<=48231||48233<=i&&i<=48259||48261<=i&&i<=48287||48289<=i&&i<=48315||48317<=i&&i<=48343||48345<=i&&i<=48371||48373<=i&&i<=48399||48401<=i&&i<=48427||48429<=i&&i<=48455||48457<=i&&i<=48483||48485<=i&&i<=48511||48513<=i&&i<=48539||48541<=i&&i<=48567||48569<=i&&i<=48595||48597<=i&&i<=48623||48625<=i&&i<=48651||48653<=i&&i<=48679||48681<=i&&i<=48707||48709<=i&&i<=48735||48737<=i&&i<=48763||48765<=i&&i<=48791||48793<=i&&i<=48819||48821<=i&&i<=48847||48849<=i&&i<=48875||48877<=i&&i<=48903||48905<=i&&i<=48931||48933<=i&&i<=48959||48961<=i&&i<=48987||48989<=i&&i<=49015||49017<=i&&i<=49043||49045<=i&&i<=49071||49073<=i&&i<=49099||49101<=i&&i<=49127||49129<=i&&i<=49155||49157<=i&&i<=49183||49185<=i&&i<=49211||49213<=i&&i<=49239||49241<=i&&i<=49267||49269<=i&&i<=49295||49297<=i&&i<=49323||49325<=i&&i<=49351||49353<=i&&i<=49379||49381<=i&&i<=49407||49409<=i&&i<=49435||49437<=i&&i<=49463||49465<=i&&i<=49491||49493<=i&&i<=49519||49521<=i&&i<=49547||49549<=i&&i<=49575||49577<=i&&i<=49603||49605<=i&&i<=49631||49633<=i&&i<=49659||49661<=i&&i<=49687||49689<=i&&i<=49715||49717<=i&&i<=49743||49745<=i&&i<=49771||49773<=i&&i<=49799||49801<=i&&i<=49827||49829<=i&&i<=49855||49857<=i&&i<=49883||49885<=i&&i<=49911||49913<=i&&i<=49939||49941<=i&&i<=49967||49969<=i&&i<=49995||49997<=i&&i<=50023||50025<=i&&i<=50051||50053<=i&&i<=50079||50081<=i&&i<=50107||50109<=i&&i<=50135||50137<=i&&i<=50163||50165<=i&&i<=50191||50193<=i&&i<=50219||50221<=i&&i<=50247||50249<=i&&i<=50275||50277<=i&&i<=50303||50305<=i&&i<=50331||50333<=i&&i<=50359||50361<=i&&i<=50387||50389<=i&&i<=50415||50417<=i&&i<=50443||50445<=i&&i<=50471||50473<=i&&i<=50499||50501<=i&&i<=50527||50529<=i&&i<=50555||50557<=i&&i<=50583||50585<=i&&i<=50611||50613<=i&&i<=50639||50641<=i&&i<=50667||50669<=i&&i<=50695||50697<=i&&i<=50723||50725<=i&&i<=50751||50753<=i&&i<=50779||50781<=i&&i<=50807||50809<=i&&i<=50835||50837<=i&&i<=50863||50865<=i&&i<=50891||50893<=i&&i<=50919||50921<=i&&i<=50947||50949<=i&&i<=50975||50977<=i&&i<=51003||51005<=i&&i<=51031||51033<=i&&i<=51059||51061<=i&&i<=51087||51089<=i&&i<=51115||51117<=i&&i<=51143||51145<=i&&i<=51171||51173<=i&&i<=51199||51201<=i&&i<=51227||51229<=i&&i<=51255||51257<=i&&i<=51283||51285<=i&&i<=51311||51313<=i&&i<=51339||51341<=i&&i<=51367||51369<=i&&i<=51395||51397<=i&&i<=51423||51425<=i&&i<=51451||51453<=i&&i<=51479||51481<=i&&i<=51507||51509<=i&&i<=51535||51537<=i&&i<=51563||51565<=i&&i<=51591||51593<=i&&i<=51619||51621<=i&&i<=51647||51649<=i&&i<=51675||51677<=i&&i<=51703||51705<=i&&i<=51731||51733<=i&&i<=51759||51761<=i&&i<=51787||51789<=i&&i<=51815||51817<=i&&i<=51843||51845<=i&&i<=51871||51873<=i&&i<=51899||51901<=i&&i<=51927||51929<=i&&i<=51955||51957<=i&&i<=51983||51985<=i&&i<=52011||52013<=i&&i<=52039||52041<=i&&i<=52067||52069<=i&&i<=52095||52097<=i&&i<=52123||52125<=i&&i<=52151||52153<=i&&i<=52179||52181<=i&&i<=52207||52209<=i&&i<=52235||52237<=i&&i<=52263||52265<=i&&i<=52291||52293<=i&&i<=52319||52321<=i&&i<=52347||52349<=i&&i<=52375||52377<=i&&i<=52403||52405<=i&&i<=52431||52433<=i&&i<=52459||52461<=i&&i<=52487||52489<=i&&i<=52515||52517<=i&&i<=52543||52545<=i&&i<=52571||52573<=i&&i<=52599||52601<=i&&i<=52627||52629<=i&&i<=52655||52657<=i&&i<=52683||52685<=i&&i<=52711||52713<=i&&i<=52739||52741<=i&&i<=52767||52769<=i&&i<=52795||52797<=i&&i<=52823||52825<=i&&i<=52851||52853<=i&&i<=52879||52881<=i&&i<=52907||52909<=i&&i<=52935||52937<=i&&i<=52963||52965<=i&&i<=52991||52993<=i&&i<=53019||53021<=i&&i<=53047||53049<=i&&i<=53075||53077<=i&&i<=53103||53105<=i&&i<=53131||53133<=i&&i<=53159||53161<=i&&i<=53187||53189<=i&&i<=53215||53217<=i&&i<=53243||53245<=i&&i<=53271||53273<=i&&i<=53299||53301<=i&&i<=53327||53329<=i&&i<=53355||53357<=i&&i<=53383||53385<=i&&i<=53411||53413<=i&&i<=53439||53441<=i&&i<=53467||53469<=i&&i<=53495||53497<=i&&i<=53523||53525<=i&&i<=53551||53553<=i&&i<=53579||53581<=i&&i<=53607||53609<=i&&i<=53635||53637<=i&&i<=53663||53665<=i&&i<=53691||53693<=i&&i<=53719||53721<=i&&i<=53747||53749<=i&&i<=53775||53777<=i&&i<=53803||53805<=i&&i<=53831||53833<=i&&i<=53859||53861<=i&&i<=53887||53889<=i&&i<=53915||53917<=i&&i<=53943||53945<=i&&i<=53971||53973<=i&&i<=53999||54001<=i&&i<=54027||54029<=i&&i<=54055||54057<=i&&i<=54083||54085<=i&&i<=54111||54113<=i&&i<=54139||54141<=i&&i<=54167||54169<=i&&i<=54195||54197<=i&&i<=54223||54225<=i&&i<=54251||54253<=i&&i<=54279||54281<=i&&i<=54307||54309<=i&&i<=54335||54337<=i&&i<=54363||54365<=i&&i<=54391||54393<=i&&i<=54419||54421<=i&&i<=54447||54449<=i&&i<=54475||54477<=i&&i<=54503||54505<=i&&i<=54531||54533<=i&&i<=54559||54561<=i&&i<=54587||54589<=i&&i<=54615||54617<=i&&i<=54643||54645<=i&&i<=54671||54673<=i&&i<=54699||54701<=i&&i<=54727||54729<=i&&i<=54755||54757<=i&&i<=54783||54785<=i&&i<=54811||54813<=i&&i<=54839||54841<=i&&i<=54867||54869<=i&&i<=54895||54897<=i&&i<=54923||54925<=i&&i<=54951||54953<=i&&i<=54979||54981<=i&&i<=55007||55009<=i&&i<=55035||55037<=i&&i<=55063||55065<=i&&i<=55091||55093<=i&&i<=55119||55121<=i&&i<=55147||55149<=i&&i<=55175||55177<=i&&i<=55203?10:9757==i||9977==i||9994<=i&&i<=9997||127877==i||127938<=i&&i<=127940||127943==i||127946<=i&&i<=127948||128066<=i&&i<=128067||128070<=i&&i<=128080||128110==i||128112<=i&&i<=128120||128124==i||128129<=i&&i<=128131||128133<=i&&i<=128135||128170==i||128372<=i&&i<=128373||128378==i||128400==i||128405<=i&&i<=128406||128581<=i&&i<=128583||128587<=i&&i<=128591||128675==i||128692<=i&&i<=128694||128704==i||128716==i||129304<=i&&i<=129308||129310<=i&&i<=129311||129318==i||129328<=i&&i<=129337||129341<=i&&i<=129342||129489<=i&&i<=129501?n:127995<=i&&i<=127999?14:8205==i?15:9792==i||9794==i||9877<=i&&i<=9878||9992==i||10084==i||127752==i||127806==i||127859==i||127891==i||127908==i||127912==i||127979==i||127981==i||128139==i||128187<=i&&i<=128188||128295==i||128300==i||128488==i||128640==i||128658==i?s:128102<=i&&i<=128105?a:11}return this.nextBreak=function(e,t){if(void 0===t&&(t=0),t<0)return 0;if(t>=e.length-1)return e.length;for(var r,n,s=c(i(e,t)),a=[],l=t+1;l<e.length;l++)if(n=l-1,!(55296<=(r=e).charCodeAt(n)&&r.charCodeAt(n)<=56319&&56320<=r.charCodeAt(n+1)&&r.charCodeAt(n+1)<=57343)){var u=c(i(e,l));if(o(s,a,u))return l;a.push(u)}return e.length},this.splitGraphemes=function(e){for(var t,r=[],n=0;(t=this.nextBreak(e,n))<e.length;)r.push(e.slice(n,t)),n=t;return n<e.length&&r.push(e.slice(n)),r},this.iterateGraphemes=function(e){var t=0,r={next:function(){var r,n;return(n=this.nextBreak(e,t))<e.length?(r=e.slice(t,n),t=n,{value:r,done:!1}):t<e.length?(r=e.slice(t),t=e.length,{value:r,done:!1}):{value:void 0,done:!0}}.bind(this)};return"undefined"!=typeof Symbol&&Symbol.iterator&&(r[Symbol.iterator]=function(){return r}),r},this.countGraphemes=function(e){for(var t,r=0,n=0;(t=this.nextBreak(e,n))<e.length;)n=t,r++;return n<e.length&&r++,r},this})},4403:(e,t)=>{"use strict";var r=Symbol.for("react.element"),n=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),c=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),h=Symbol.iterator;
/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,E={};function p(e,t,r){this.props=e,this.context=t,this.refs=E,this.updater=r||m}function f(){}function A(e,t,r){this.props=e,this.context=t,this.refs=E,this.updater=r||m}p.prototype.isReactComponent={},p.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},p.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},f.prototype=p.prototype;var S=A.prototype=new f;S.constructor=A,_(S,p.prototype),S.isPureReactComponent=!0;var T=Array.isArray,C=Object.prototype.hasOwnProperty,R={current:null},I={key:!0,ref:!0,__self:!0,__source:!0};function P(e,t,n){var s,a={},i=null,o=null;if(null!=t)for(s in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(i=""+t.key),t)C.call(t,s)&&!I.hasOwnProperty(s)&&(a[s]=t[s]);var c=arguments.length-2;if(1===c)a.children=n;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];a.children=l}if(e&&e.defaultProps)for(s in c=e.defaultProps)void 0===a[s]&&(a[s]=c[s]);return{$$typeof:r,type:e,key:i,ref:o,props:a,_owner:R.current}}function N(e){return"object"==typeof e&&null!==e&&e.$$typeof===r}var y=/\/+/g;function O(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function b(e,t,s,a,i){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var c=!1;if(null===e)c=!0;else switch(o){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case r:case n:c=!0}}if(c)return i=i(c=e),e=""===a?"."+O(c,0):a,T(i)?(s="",null!=e&&(s=e.replace(y,"$&/")+"/"),b(i,t,s,"",(function(e){return e}))):null!=i&&(N(i)&&(i=function(e,t){return{$$typeof:r,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,s+(!i.key||c&&c.key===i.key?"":(""+i.key).replace(y,"$&/")+"/")+e)),t.push(i)),1;if(c=0,a=""===a?".":a+":",T(e))for(var l=0;l<e.length;l++){var u=a+O(o=e[l],l);c+=b(o,t,s,u,i)}else if(u=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=h&&e[h]||e["@@iterator"])?e:null}(e),"function"==typeof u)for(e=u.call(e),l=0;!(o=e.next()).done;)c+=b(o=o.value,t,s,u=a+O(o,l++),i);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return c}function L(e,t,r){if(null==e)return e;var n=[],s=0;return b(e,n,"","",(function(e){return t.call(r,e,s++)})),n}function w(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var v={current:null},D={transition:null};function x(){throw Error("act(...) is not supported in production builds of React.")}},3696:(e,t,r)=>{"use strict";r(4403)},3131:function(e,t){var r,n,s;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,n=[e],r=function(e){"use strict";if(!globalThis.chrome?.runtime?.id)throw new Error("This script should only be loaded in a browser extension.");if(void 0===globalThis.browser||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){const t="The message port closed before a response was received.",r=e=>{const r={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(r).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class n extends WeakMap{constructor(e,t=void 0){super(t),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}const s=e=>e&&"object"==typeof e&&"function"==typeof e.then,a=(t,r)=>(...n)=>{e.runtime.lastError?t.reject(new Error(e.runtime.lastError.message)):r.singleCallbackArg||n.length<=1&&!1!==r.singleCallbackArg?t.resolve(n[0]):t.resolve(n)},i=e=>1==e?"argument":"arguments",o=(e,t)=>function(r,...n){if(n.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${i(t.minArgs)} for ${e}(), got ${n.length}`);if(n.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${i(t.maxArgs)} for ${e}(), got ${n.length}`);return new Promise(((s,i)=>{if(t.fallbackToNoCallback)try{r[e](...n,a({resolve:s,reject:i},t))}catch(a){console.warn(`${e} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,a),r[e](...n),t.fallbackToNoCallback=!1,t.noCallback=!0,s()}else t.noCallback?(r[e](...n),s()):r[e](...n,a({resolve:s,reject:i},t))}))},c=(e,t,r)=>new Proxy(t,{apply:(t,n,s)=>r.call(n,e,...s)});let l=Function.call.bind(Object.prototype.hasOwnProperty);const u=(e,t={},r={})=>{let n=Object.create(null),s={has:(t,r)=>r in e||r in n,get(s,a,i){if(a in n)return n[a];if(!(a in e))return;let g=e[a];if("function"==typeof g)if("function"==typeof t[a])g=c(e,e[a],t[a]);else if(l(r,a)){let t=o(a,r[a]);g=c(e,e[a],t)}else g=g.bind(e);else if("object"==typeof g&&null!==g&&(l(t,a)||l(r,a)))g=u(g,t[a],r[a]);else{if(!l(r,"*"))return Object.defineProperty(n,a,{configurable:!0,enumerable:!0,get:()=>e[a],set(t){e[a]=t}}),g;g=u(g,t[a],r["*"])}return n[a]=g,g},set:(t,r,s,a)=>(r in n?n[r]=s:e[r]=s,!0),defineProperty:(e,t,r)=>Reflect.defineProperty(n,t,r),deleteProperty:(e,t)=>Reflect.deleteProperty(n,t)},a=Object.create(e);return new Proxy(a,s)},g=e=>({addListener(t,r,...n){t.addListener(e.get(r),...n)},hasListener:(t,r)=>t.hasListener(e.get(r)),removeListener(t,r){t.removeListener(e.get(r))}}),d=new n((e=>"function"!=typeof e?e:function(t){const r=u(t,{},{getContent:{minArgs:0,maxArgs:0}});e(r)})),h=new n((e=>"function"!=typeof e?e:function(t,r,n){let a,i,o=!1,c=new Promise((e=>{a=function(t){o=!0,e(t)}}));try{i=e(t,r,a)}catch(e){i=Promise.reject(e)}const l=!0!==i&&s(i);if(!0!==i&&!l&&!o)return!1;const u=e=>{e.then((e=>{n(e)}),(e=>{let t;t=e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred",n({__mozWebExtensionPolyfillReject__:!0,message:t})})).catch((e=>{console.error("Failed to send onMessage rejected reply",e)}))};return u(l?i:c),!0})),m=({reject:r,resolve:n},s)=>{e.runtime.lastError?e.runtime.lastError.message===t?n():r(new Error(e.runtime.lastError.message)):s&&s.__mozWebExtensionPolyfillReject__?r(new Error(s.message)):n(s)},_=(e,t,r,...n)=>{if(n.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${i(t.minArgs)} for ${e}(), got ${n.length}`);if(n.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${i(t.maxArgs)} for ${e}(), got ${n.length}`);return new Promise(((e,t)=>{const s=m.bind(null,{resolve:e,reject:t});n.push(s),r.sendMessage(...n)}))},E={devtools:{network:{onRequestFinished:g(d)}},runtime:{onMessage:g(h),onMessageExternal:g(h),sendMessage:_.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:_.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},p={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return r.privacy={network:{"*":p},services:{"*":p},websites:{"*":p}},u(e,E,r)};e.exports=r(chrome)}else e.exports=globalThis.browser},void 0===(s="function"==typeof r?r.apply(t,n):r)||(e.exports=s)}},t={};function r(n){var s=t[n];if(void 0!==s)return s.exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,r),a.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e={};r.r(e),r.d(e,{ACCOUNT_STATUS_RECHECK_INTERVAL:()=>$,BASE_REPHRASING_SERVER_URL:()=>ce,BASE_SERVER_URL:()=>oe,CHECK_DELAY:()=>we,CHECK_MAX_DELAY:()=>ve,CHECK_REQUEST_TIMEOUT:()=>te,CHECK_THROTTLING_LIMIT:()=>re,CLIENT_LOGIN_URL:()=>Ee,COLORS:()=>Fe,COLORS_ON_DARK:()=>Be,COUNTRY_COUPON_MAPPING:()=>qe,COUPON_INTERVAL:()=>ze,DICTIONARY_SYNC_INTERVAL:()=>J,ERRORS_THAT_CAN_BE_CORRECTED_ALL_AT_ONCE:()=>rt,EXTENSION_HEALTH_RECHECK_INTERVAL:()=>j,EXTERNAL_CONFIG_RELOAD_INTERVAL:()=>Z,EXTERNAL_CONFIG_URL:()=>_e,FEEDBACK_SERVER_URL:()=>me,FIX_SENTENCE_MIN_ERROR_AMOUNT:()=>Ze,HOVER_DELAY:()=>xe,HOVER_MAX_DELAY:()=>Ue,HTTP_ERROR_ABORT:()=>ct,HTTP_ERROR_GENERIC:()=>gt,HTTP_ERROR_PAYLOAD_TOO_LARGE:()=>lt,HTTP_ERROR_TIMEOUT:()=>ut,IFRAME_INITILIZATION_RECHECK_INTERVAL:()=>z,INSTALL_URL:()=>se,LOCAL_SERVER_URL:()=>he,MAIN_FALLBACK_SERVER_URL:()=>ue,MAIN_SERVER_RECHECK_INTERVAL:()=>Ce,MAIN_SERVER_URL:()=>le,MASCOT_NAME:()=>tt,MAX_EXCEPTION_COUNT:()=>We,MAX_FIXES_COUNT:()=>He,MAX_FREEMIUM_REPHRASINGS_PER_DAY:()=>at,MAX_TEXT_LENGTH:()=>Pe,MAX_TEXT_LENGTH_CUSTOM_SERVER:()=>be,MAX_TEXT_LENGTH_PERFORMANCE_DEGRADATION:()=>ye,MAX_TEXT_LENGTH_PREMIUM:()=>Oe,MAX_USAGE_COUNT_ONBOARDING:()=>Ve,MIN_TEXT_LENGTH:()=>Re,NARROW_WHITESPACE_REGEXP:()=>ot,NEW_SYNONYMS_URL:()=>Se,PACKAGE:()=>Je,PARAGRAPH_LEVEL_CHUNK_LENGTH:()=>Le,PICKY_RULES_THAT_ARE_CONSIDERED_ANNOYING:()=>Qe,PING_INTERVAL:()=>K,PING_URL:()=>pe,PREMIUM_FALLBACK_SERVER_URL:()=>de,PREMIUM_SERVER_URL:()=>ge,RELIABLE_MOTHER_TONGUES:()=>st,RENDER_INTERVAL:()=>Q,RULES_ALLOWED_TO_BE_SENT_TO_API:()=>et,SEND_AND_DESTROY_COMPLETED_USER_ACTIVITIES_INTERVAL:()=>Ge,SHORT_TEXT_MAX_LENGTH:()=>Ie,SPLIT_SENTENCE_LIMIT:()=>ne,STATISTICS_URL:()=>Ae,STOPPED_TYPING_TIMEOUT:()=>De,SUPPORTED_FIX_COMPLETE_SENTENCE_LANGUAGES:()=>Xe,SUPPORTED_PHRASAL_PARAPHRASING_LANGUAGES:()=>$e,SUPPORTED_REPHRASE_LANGUAGES:()=>Ye,SUPPORTED_SENTENCE_SPLITTING_LANGUAGES:()=>je,SUPPORTED_SYNONYM_LANGUAGES:()=>Ke,SWITCH_TO_FALLBACK_SERVER_ERRORS:()=>Te,SYNC_USER_DATA_INTERVAL:()=>q,TEXT_LEVEL_MAX_LENGTH_PER_REQUEST:()=>Ne,TOOLBAR_DECREASE_SIZE_INTERVAL:()=>ee,TOOLBOX_THEME:()=>dt,TRACK_RULE_EVENT_LANGUAGES:()=>nt,TRAILING_WHITESPACE_REGEXP:()=>it,UI_MODE_RECHECK_INTERVAL:()=>X,UNINSTALL_URL:()=>ae,USER_ACTIVITY_DESTRUCTION_DELAY:()=>ke,USER_ACTIVITY_PING_INTERVAL_LENGTH:()=>Me,USER_DATA_URL:()=>ie,WEBAPI_URL:()=>fe});r(3696);const t="​‌‍­⁠‪‫‬‭",n=(new RegExp("^["+t+"]$"),new RegExp("["+t+"]"),new RegExp("["+t+"]","g"),String.fromCharCode(160),"\b\t          ‏　");new RegExp("^["+n+"]$"),new RegExp("["+n+"]","g");function s(e){return"string"==typeof e}
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class a{static _contructor(){if(this._isInitialized)return;a._isChromium=navigator.userAgent.includes("Chrome/")||navigator.userAgent.includes("Chromium/"),a._isFirefox=navigator.userAgent.includes("Firefox/"),a._isThunderbird=navigator.userAgent.includes("Thunderbird/"),a._isOpera=navigator.userAgent.includes("OPR/"),a._isEdge=navigator.userAgent.includes("Edg/"),a._isOldEdge=navigator.userAgent.includes("Edge/"),a._isSafari=(navigator.userAgent.includes("Safari/")||navigator.userAgent.includes("AppleWebKit"))&&!a._isChromium&&!a._isEdge&&!a._isOpera,a._isYaBrowser=navigator.userAgent.includes("YaBrowser/"),a._isChrome=a._isChromium&&!a._isOpera&&!a._isEdge&&!a._isOldEdge&&!a._isYaBrowser;const e=navigator.userAgent.match(/Chrome\/(\d+)/);e&&(a._isUnsupportedChrome=parseInt(e[1])<67&&!navigator.userAgent.includes("Edge/"));const t=navigator.userAgent.match(/Firefox\/(\d+)/);t&&(a._isUnsupportedFirefox=parseInt(t[1])<60),this._isInitialized=!0}static getOS(){return navigator.userAgent.includes("Macintosh")?"Mac":navigator.userAgent.includes("Windows")?"Windows":navigator.userAgent.includes("CrOS")?"CrOS":navigator.userAgent.includes("Linux")?"Linux":"Other"}static isChromium(){return a._isChromium}static isChrome(){return a._isChrome}static isThunderbird(){return a._isThunderbird}static isFirefox(){return a._isFirefox}static isOpera(){return a._isOpera}static isEdge(){return a._isEdge}static isSafari(){return a._isSafari}static isYaBrowser(){return a._isYaBrowser}static isUnsupportedChrome(){return a._isUnsupportedChrome}static isUnsupportedFirefox(){return a._isUnsupportedFirefox}static isUnsupportedBrowser(){return a.isUnsupportedChrome()||a.isUnsupportedFirefox()}static getBrowserName(){return a.isChrome()?"Chrome":a.isFirefox()?"Firefox":a.isOpera()?"Opera":a.isEdge()?"Edge":a.isSafari()?"Safari":a.isYaBrowser()?"Yandex":"Unknown Browser"}static getUserAgentIdentifier(){let e="webextension";return this.isChrome()?e+="-chrome":this.isFirefox()?e+="-firefox":this.isOpera()?e+="-opera":this.isEdge()?e+="-edge":this.isYaBrowser()?e+="-chrome":this.isSafari()?e+="-safari":e+="-unknown",e+"-ng"}static isTouchDevice(){if(!("ontouchstart"in self))return!1;const e=navigator.userAgent.includes("Android");return this.isIOS()||e}static isIOS(){const e=navigator.userAgent.includes("iPhone OS"),t=navigator.userAgent.includes("Macintosh")&&Boolean(navigator.maxTouchPoints&&navigator.maxTouchPoints>2);return e||t}static isIOSTouchDevice(){return"ontouchstart"in self&&this.isIOS()}static isMacApp(){return navigator.userAgent.includes("AppleWebKit/")&&navigator.userAgent.includes("LanguageTool/")&&!navigator.userAgent.includes("Chrome/")&&!navigator.userAgent.includes("Chromium/")}static isWindowsApp(){return navigator.userAgent.includes("LanguageToolWindows/")}}a._isChromium=!1,a._isChrome=!1,a._isFirefox=!1,a._isThunderbird=!1,a._isOpera=!1,a._isOldEdge=!1,a._isEdge=!1,a._isSafari=!1,a._isYaBrowser=!1,a._isUnsupportedChrome=!1,a._isUnsupportedFirefox=!1,a._isInitialized=!1,a._contructor();
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class i{}const o=class{static init(e){this._instance=e}static isProductionEnvironment(){return this._instance.isProductionEnvironment()}static isRuntimeConnected(){return this._instance.isRuntimeConnected()}static getVersion(){return this._instance.getVersion()}static getTrackingId(){return this._instance.getTrackingId()}static shouldTrack(){return this._instance.shouldTrack()}static getType(){return this._instance.getType()}static getBeforeUnloadEventName(){return this._instance.getBeforeUnloadEventName()}static getURL(e){return this._instance.getURL(e)}static getUILanguageCode(){return this._instance.getUILanguageCode()}static openWindow(e){return this._instance.openWindow(e)}static canLoadContentScripts(e){return this._instance.canLoadContentScripts(e)}static loadContentScripts(e,t){return this._instance.loadContentScripts(e,t)}static loadStylesheets(e,t){return this._instance.loadStylesheets(e,t)}static injectShadowStyles(e){return this._instance.injectShadowStyles(e)}static initializeLTAssistant(e,t={}){return this._instance.initializeLTAssistant(e,t)}static getPreferredLanguages(){return this._instance.getPreferredLanguages()}static startDictionarySync(){return this._instance.startDictionarySync()}static addWordToDictionary(e){return this._instance.addWordToDictionary(e)}static addWordsToDictionary(e){return this._instance.addWordsToDictionary(e)}static removeWordFromDictionary(e){return this._instance.removeWordFromDictionary(e)}static clearDictionary(){return this._instance.clearDictionary()}static updateDictionary(){return this._instance.updateDictionary()}static injectExecutor(){return this._instance.injectExecutor()}static destroyExecutor(){return this._instance.destroyExecutor()}static executeScript(e,t){return this._instance.executeScript(e,t)}static linkInputAreaProperties(e){return this._instance.linkInputAreaProperties(e)}static ping(){return this._instance.ping()}static loadSynonyms(e,t,r){return this._instance.loadSynonyms(e,t,r)}static abortSynonymsRequest(){return this._instance.abortSynonymsRequest()}static loadPhrases(e,t,r,n,s){return this._instance.loadPhrases(e,t,r,n,s)}static reportPhrase(e,t){return this._instance.reportPhrase(e,t)}static initializeUserActivity(e){return this._instance.initializeUserActivity(e)}static sendUserActivityPings(e){return this._instance.sendUserActivityPings(e)}static updateUserActivityTextStatistics(e,t){return this._instance.updateUserActivityTextStatistics(e,t)}static updateUserActivityAppliedSuggestions(e,t,r){return this._instance.updateUserActivityAppliedSuggestions(e,t,r)}static updateUserActivityAppliedRewritings(e){return this._instance.updateUserActivityAppliedRewritings(e)}static updateUserActivityMeta(e,t){return this._instance.updateUserActivityMeta(e,t)}static sendUserActivity(e){return this._instance.sendUserActivity(e)}static destroyUserActivity(e){return this._instance.destroyUserActivity(e)}static abortPhraseRequests(e){return this._instance.abortPhraseRequests(e)}static loadSplitSentence(e,t,r,n,s){return this._instance.loadSplitSentence(e,t,r,n,s)}static trackEvent(e,t){return this._instance.trackEvent(e,t)}static trackTextLength(e){return this._instance.trackTextLength(e)}static pageLoaded(e,t,r,n,s){return this._instance.pageLoaded(e,t,r,n,s)}static ltAssistantStatusChanged(e,t){return"number"==typeof e?this._instance.ltAssistantStatusChanged(e,t):this._instance.ltAssistantStatusChanged(e)}static check(e,t,r,n,s,a,i){return this._instance.check(e,t,r,n,s,a,i)}static isOptionsPageSupported(){return this._instance.isOptionsPageSupported()}static openOptionsPage(e,t){return this._instance.openOptionsPage(e,t)}static isFeedbackFormSupported(){return this._instance.isFeedbackFormSupported()}static openFeedbackForm(e,t,r){return this._instance.openFeedbackForm(e,t,r)}static openPremiumPage(e,t=0,r=0,n=0,s="",a){return this._instance.openPremiumPage(e,t,r,n,s,a)}static checkForPaidSubscription(){return this._instance.checkForPaidSubscription()}static canUseShadowDom(){return this._instance.canUseShadowDom()}static toolboxNetworkInitiateRequest(e){return this._instance.toolboxNetworkInitiateRequest(e)}},c=r(4080);let l;try{l=new RegExp("\\p{L}","u")}catch(e){l=/[a-zäöüß]/i}function u(e){return l.test(e)}const g=e=>"string"==typeof e;let d,h,m,_,E;!function(){const e="\b\t          ‏　",t=new RegExp("^["+e+"]$"),r=new RegExp("["+e+"]","g");d=function(e){return" "===e||" "===e||t.test(e)},h=function(e){return e.replace(r," ")}}(),function(){const e="​‌‍­⁠‪‫‬‭",t=new RegExp("^["+e+"]$"),r=new RegExp("["+e+"]"),n=new RegExp("["+e+"]","g");m=function(e){return t.test(e)},_=function(e){const t=e.match(r);return t?t.index:-1},E=function(e){return e.replace(n,"")}}();const p=function(){const e=/^[A-ZÈÉÊÁÀÂÓÒÔÚÙÛÍÌÎÄÜÖ]+[A-ZÈÉÊÁÀÂÓÒÔÚÙÛÍÌÎÄÜÖ\-!?#@=%().:;<>'’´`"”“*+,\s]+[A-ZÈÉÊÁÀÂÓÒÔÍÌÎÄÜÖ]$/;return function(t){return e.test(t)}}();function f(e,t){const{start:r,end:n=r}=t||{start:-1};if(!e||-1===r)return;const s=e.map((e=>Array.isArray(e)?e:[e.start,e.end])).findIndex((([e,t])=>r>=e&&n<=t));return s<0?void 0:e[s]}let A,S,T,C;function R(e,t){if(e===t)return null;let r=0;const n=Math.max(e.length,t.length);for(r=0;r<n&&e[r]===t[r];r++);let s=0;const a=Math.min(e.length,t.length);for(;r+s<a;){if(e[e.length-s-1]!==t[t.length-s-1])break;s++}return{from:r,oldFragment:e.substring(r,e.length-s),newFragment:t.substring(r,t.length-s)}}function I(e,t){const r=[],n=e.split("\n"),s=t.split("\n");let a=0;const i=Math.max(n.length,s.length);for(a=0;a<i&&n[a]===s[a];a++);let o=0;const c=Math.min(n.length,s.length);for(;a+o<c;){if(n[n.length-o-1]!==s[s.length-o-1])break;o++}let l=0;for(let e=0;e<a;e++)l+=n[e].length+1;let u=l;for(let e=a;e<i-o;e++){const t=e<n.length-o?n[e]:null,a=e<s.length-o?s[e]:null;t===a&&l===u||r.push({oldText:t,newText:a,oldOffset:l,newOffset:u,textDiff:R(t||"",a||"")}),null!==t&&(l+=t.length+1),null!==a&&(u+=a.length+1)}if(l!==u)for(let e=o-1;e>=0;e--){const t=n[n.length-e-1],a=s[s.length-e-1];r.push({oldText:t,newText:a,oldOffset:l,newOffset:u,textDiff:null}),l+=t.length+1,u+=a.length+1}return r}function P(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/`/g,"&#x60;").replace(/\//g,"&#x2F;")}function N(e,t){let r=0,n=e.length-1;for(;r<=n;){const s=r+Math.ceil((n-r)/2),a=t(e[s]);if(a>0)r=s+1;else{if(!(a<0)){for(let r=s;r>0;r--)if(0!==t(e[r-1]))return e[r];return e[0]}n=s-1}}return null}function y(e){const t=[];return e.forEach((e=>{-1===t.indexOf(e)&&t.push(e)})),t}function O(e){return null===e||"object"!=typeof e?e:e instanceof Date?new Date(e):e instanceof RegExp?new RegExp(e):Array.isArray(e)?Array.from(e):Object.assign({},e)}function b(e){if(null===e||"object"!=typeof e)return e;if(e instanceof Date)return new Date(e);if(e instanceof RegExp)return new RegExp(e);const t=Array.isArray(e)?[]:{};for(const r in e)t[r]=b(e[r]);return t}!function(){let e,t;const r=/(?:\S+\s+){0,4}\S+$/,n=/^\S+(?:\s+\S+){0,4}/;try{e=new RegExp("^\\s*(-?\\p{L}+)*-?\\s*$","u"),t=new RegExp("^\\s*\\p{L}+(-\\p{L}+)*\\s*$","u")}catch(r){e=/^\s*(-?[a-zäöüß]+)*-?\s*$/i,t=/^\s*[a-zäöüß]+(-[a-zäöüß]+)*\s*$/i}A=(r,n,s=n)=>{const a=r.substring(n,s);if(!e.test(a))return null;let i=0===a.length||u(a[0]),o="-"===a[0],c=n;if(i||o)for(;c>0;){const e=r[c-1],t=u(e),n="-"===e;if(!t&&!n)break;if(n&&o)return null;c--,i=t,o=n}i=u(a[a.length-1]),o=a.endsWith("-");let l=s;if(i||o)for(;l<r.length;){const e=r[l],t=u(e),n="-"===e;if(!t&&!n)break;if(n&&o)return null;l++,i=t,o=n}const g=a.match(/\s+$/);g&&(l-=g[0].length);const d=r.substring(c,l);return t.test(d)?{start:c,end:l}:null},S=(e,t,s=t,a)=>{const i=A(e,t,s);if(!i)return null;const o=f(a,{start:t,end:s});let c="",l="",u="";if(o)u=e.substring(o.start,o.end).trim(),c=e.slice(o.start,i.start).trim(),l=e.slice(i.end,o.end).trim();else{const t=r.exec(e.substring(0,i.start).trim());c=t?t[0]:"",c=c.replace(/^.+\n\n/,"");const s=n.exec(e.substring(i.end).trim());l=s?s[0]:"",l=l.replace(/\n\n.+/,"")}return{word:e.substring(i.start,i.end),position:i,sentence:u,beforeText:c,afterText:l}}}(),function(){let e,t;const r=/(?:\S+\s+){0,4}\S+$/,n=/^\S+(?:\s+\S+){0,4}/;try{e=new RegExp("^\\s*(-?\\p{L}+)*-?\\s*$","u"),t=new RegExp("^\\s*\\p{L}+(-\\p{L}+)*\\s*$","u")}catch(r){e=/^\s*(-?[a-zäöüß]+)*-?\s*$/i,t=/^\s*[a-zäöüß]+(-[a-zäöüß]+)*\s*$/i}T=(e,r,n=r)=>{const s=e.substring(r,n);if(s.split(" ").length>5)return null;let a=0===s.length||u(s[0]),i="-"===s[0],o=r;if(a||i)for(;o>0;){const t=e[o-1],r=u(t),n="-"===t;if(!r&&!n)break;if(n&&i)return null;o--,a=r,i=n}a=u(s[s.length-1]),i=s.endsWith("-");let c=n;if(a||i)for(;c<e.length;){const t=e[c],r=u(t),n="-"===t;if(!r&&!n)break;if(n&&i)return null;c++,a=r,i=n}const l=s.match(/\s+$/);l&&(c-=l[0].length);return e.substring(o,c).split(t).length<6?{start:o,end:c}:null},C=(e,t,s=t,a)=>{const i=T(e,t,s);if(!i)return null;const o=f(a,{start:t,end:s});let c="",l="",u="";if(o)u=e.substring(o.start,o.end).trim(),c=e.slice(o.start,i.start).trim(),l=e.slice(i.end,o.end).trim();else{const t=r.exec(e.substring(0,i.start).trim());c=t?t[0]:"",c=c.replace(/^.+\n\n/,"");const s=n.exec(e.substring(i.end).trim());l=s?s[0]:"",l=l.replace(/\n\n.+/,"")}return{word:e.substring(i.start,i.end),position:i,sentence:u,beforeText:c,afterText:l}}}();let L=null,w=null;function v(e){return Intl.Segmenter?(L||(L=new Intl.Segmenter(void 0,{granularity:"grapheme"})),Array.from(L.segment(e)).map((e=>e.segment))):(w||(w=new c),w.splitGraphemes(e))}function D(){if("about:blank"===location.href||"about:srcdoc"===location.href)try{return(self.opener||self.parent).location.href}catch(e){}return location.href}function x(e,t=e){if(e.startsWith("about:blank"))return"blank";if(e.startsWith("about:srcdoc"))return"srcdoc";if(e.startsWith("file:"))return"file";e&&!/^([a-z\-]+:\/\/)/i.test(e)&&(e="http://"+e);try{return new URL(e).hostname}catch(e){return t}}function U(e){return x(e).toLowerCase().trim().replace(/^www\./,"")}function M(e,t){const r=U(t);return(e||[]).some(((e,t)=>{const n=U(e);return n===r||r.endsWith("."+n)}))}const k=function(){const e=/^\w+\.$/;return(t,r)=>{if(!t.isSpellingError)return!1;let n=t.originalPhrase;if(e.test(n)&&(n=n.substring(0,n.length-1)),r.includes(n))return!0;if(function(e){const t=e.charAt(0);return t===t.toUpperCase()&&t!==t.toLowerCase()}(n)){const e=(s=n).charAt(0).toLowerCase()+s.substr(1);if(r.includes(e))return!0}var s;return!1}}();!function(){const e=/[\u0300-\u036f]/g,t=/\u0142/g,r=/\u00F8/g}();function G(e,t,r,n,s=!1){return s?e<=n&&t>=r:e<n&&t>r}function F(e,t,r,n=!1){if(n){if(t<=e&&e<r)return 0}else if(t<=e&&e<=r)return 0;return e-t}async function B(e,t,r){if(t.signal)throw new Error("cannot fetchWithTimeout if 'signal' is already set");const n=new AbortController;t.signal=n.signal;const s=self.setTimeout((()=>n.abort()),r);return await fetch(e,t).finally((()=>{clearTimeout(s)}))}var H;!function(e){e.CHROME_EXTENSION_ID="CHROME_EXTENSION_ID",e.EXTN_PREFIX="EVENT_PREFIX",e.COLORS_GRAMMAR="COLORS_GRAMMAR",e.CARD_TARGET_BOX_MARGIN="CARD_TARGET_BOX_MARGIN",e.CARD_LAYOUT="CARD_LAYOUT"}(H||(H={}));const W={[H.CHROME_EXTENSION_ID]:"oldceeleldhonbafppcapldpdifcinji",[H.EXTN_PREFIX]:"lt",[H.COLORS_GRAMMAR]:{UNDERLINE:"#f2b24c",BACKGROUND:"rgba(242,179,77,0.3)",EMPHASIZE:"rgba(241,179,76,0.1)"},[H.CARD_LAYOUT]:{TARGET_BOX_MARGIN:5,HEADER_HEIGHT:36,FOOTER_HEIGHT:36,KEYBOARD_HINT_HEIGHT:60,MIN_HEIGHT_PARAPHRASE:200,MIN_HEIGHT_TOOLBOX:230,MAX_HEIGHT_TOOLBOX:360}};class V{constructor(){this.extnConfig=new Map,Object.keys(W).map((e=>{this.extnConfig.set(e,W[e])}))}static getInstance(){return this.instance||self._qb_lt_config||(this.instance=new V,self._qb_lt_config=this.instance),this.instance||self._qb_lt_config}get(e){return this.extnConfig.get(e)}set(e,t){this.extnConfig.set(e,t)}setAll(e){this.extnConfig=e}getAll(){return this.extnConfig}}const Y=V.getInstance(),j=3e3,X=6e4,$=36e5,Z=144e5,K=864e5,q=864e5,z=1500,J=72e5,Q=300,ee=900,te=5e4,re=30,ne=500,se="https://languagetool.org/webextension/welcome",ae="https://languagetool.org/webextension/uninstall",ie="https://languagetool.org/webextension/user",oe="https://api.languagetool.org",ce="https://rewriting.languagetoolplus.com",le=`${oe}/v2`,ue="https://api-fallback.languagetool.org/v2",ge="https://api.languagetoolplus.com/v2",de="https://languagetoolplus.com/api/v2",he="http://localhost:8081/v2",me="https://languagetool.org/send-feedback/",_e="https://languagetool.org/webextension_config.json",Ee="https://languagetool.org/client-login",pe="https://languagetool.org/ping",fe="https://languagetool.org/webapi",Ae="https://api.languagetoolplus.com/statistics/api/store",Se="https://qb-grammar-en.languagetool.org/phrasal-paraphraser/subscribe",Te=[502,503,504],Ce=18e4,Re=4,Ie=50,Pe=1e4,Ne=2e4,ye=4e4,Oe=15e4,be=Number.MAX_SAFE_INTEGER,Le=5e3,we=1500,ve=4e3,De=2e3,xe=50,Ue=200,Me=2e4,ke=3e5,Ge=6e5,Fe={GRAMMAR:Y.get(H.COLORS_GRAMMAR),STYLE:{UNDERLINE:"#8F7FFF",BACKGROUND:"rgba(142,128,255,0.2)",EMPHASIZE:"rgba(138,128,255,0.2)",TITLE:"#5C4CFF"},LONG_SENTENCE:{UNDERLINE:"#D2CBFF",BACKGROUND:"rgba(210,203,255,0.2)",EMPHASIZE:"rgba(210,203,255,0.1)"},IGNORED_RANGE:{UNDERLINE:"#00bbe6",BACKGROUND:"rgb(92, 222, 251, 0.2)",EMPHASIZE:"rgb(154, 232, 250, 0.1)"},SPELLING:{UNDERLINE:"#EB5757",BACKGROUND:"rgba(235,88,88,0.2)",EMPHASIZE:"rgba(239,88,88,0.1)"},SYNONYMS:{UNDERLINE:"#0042d7"},NEW_SENTENCE:{BACKGROUND:"rgba(30, 225, 151, 0.2)"},DISABLED:{UNDERLINE:"rgba(0, 0, 0, 0.2)",BACKGROUND:"rgba(0, 0, 0, 0.2)",EMPHASIZE:"rgba(0, 0, 0, 0.2)",TITLE:"rgba(0, 0, 0, 0.2)"}},Be={...Fe,DISABLED:{UNDERLINE:"rgba(255, 255, 255, 0.3)",BACKGROUND:"rgba(255, 255, 255, 0.3)",EMPHASIZE:"rgba(255, 255, 255, 0.3)",TITLE:"rgba(255, 255, 255, 0.3)"}},He=5,We=6,Ve=5,Ye=["en","de","fr","nl","es","pt-BR","pt-PT"],je=["en"],Xe=["en"],$e=["en"],Ze=3,Ke=["de","de-CH","ru","sv","pt","pt-BR","el","en","eo","it","fr","es","uk","sk","sl","pl","da","ro","nl","ca"],qe={UKRAINE:{countries:["UA","BY"],percent:50},"ITALY-DISCOUNT":{countries:["IT"],percent:20},"SPAIN-DISCOUNT":{countries:["ES"],percent:20},SOUTH_EUROPE:{countries:["RO","AL","GR","ME","EE","LT","LV","BG","CY","MT","SK","SI","RS","HR","XK","HU","MD","TR","PT"],percent:20},AFRICA:{countries:["NG","ET","EG","CD","CG","TZ","KE","UG","DZ","SD","MA","AO","MZ","TN","CI","DJ","SZ","MU","GQ","GA","BW","SO","CD","ER","MG"],percent:50},ASIA:{countries:["ID","PK","BD","VN","MM","PH","UZ","MY","NP","KZ","KH","UZ","TH","YE","SY","JO"],percent:50},LATIN_AMERICA:{countries:["PE","VE","EC","SV","DO","BO","SR","AR","HN","BZ","CR","PA","GT","NI","GY","UY","HT","JM","TT","CU"],percent:50},BRAZIL:{countries:["BR"],percent:50}},ze=7776e6,Je={BASIC:"Basic",PREMIUM:"Premium"},Qe=["EN_QUOTES","PASSIVE_VOICE","DASH_RULE","SENTENCE_FRAGMENT","PONCTUATION_DOUBLE","TOO_LONG_SENTENCE","COMETES_TIPOGRAFIQUES","APOSTROF_TIPOGRAFIC","FALSCHE_VERWENDUNG_DES_BINDESTRICHS","HALBGEVIERTSTRICH","PARAGRAF_LEERZEICHEN","TYPOGRAFISCHE_APOSTROPHE","TYPOGRAFISCHE_ANFUEHRUNGSZEICHEN","TYPOGRAFISCHE_ANFUEHRUNGSZEICHEN_CH","TYPOGRAFISCHE_ANFUEHRUNGSZEICHEN_2","PUNCTUATION_PARAGRAPH_END","FINAL_STOPS","FINAL_PUNCTUATION","SMART_QUOTES","PT_SMART_QUOTES","DASH_SPACE_RULES","HIPHEN_SPACE_RULES","BRAK_KROPKI","DYWIZ","CUDZYSLOW_DRUKARSKI","TYPOGRAFISCHE_AANHALINGSTEKENS","TYPOGRAFISCHE_AANHALINGSTEKENS_2","EINDE_ZIN_ONVERWACHT","BACKTICK","GEDACHTESTREEPJE","OPTIONAL_HYPHEN","COMILLAS_TIPOGRAFICAS","COMETES_TIPOGRAFIQUES","GL_SMART_QUOTES"],et=["OXFORD_SPELLING_Z_NOT_S"],tt="jeremy",rt=[{ruleId:"FALSCHES_ANFUEHRUNGSZEICHEN",suggestions:[{match:/[„“]/,message:"Alle <lt-em>“</lt-em>…<lt-em>”</lt-em> zu <lt-em>„</lt-em>…<lt-em>“</lt-em> ändern"}]},{ruleId:"TYPOGRAFISCHE_ANFUEHRUNGSZEICHEN",suggestions:[{match:/[„“]/,message:"Alle <lt-em>&quot;</lt-em>…<lt-em>&quot;</lt-em> zu <lt-em>„</lt-em>…<lt-em>“</lt-em> ändern"},{match:/(^»)|(«$)/,message:"Alle <lt-em>&quot;</lt-em>…<lt-em>&quot;</lt-em> zu <lt-em>»</lt-em>…<lt-em>«</lt-em> ändern"}]},{ruleId:"TYPOGRAFISCHE_ANFUEHRUNGSZEICHEN_CH",suggestions:[{match:/[„“]/,message:"Alle <lt-em>&quot;</lt-em>…<lt-em>&quot;</lt-em> zu <lt-em>„</lt-em>…<lt-em>“</lt-em> ändern"},{match:/(^«)|(»$)/,message:"Alle <lt-em>&quot;</lt-em>…<lt-em>&quot;</lt-em> zu <lt-em>«</lt-em>…<lt-em>»</lt-em> ändern"}]},{ruleId:"TYPOGRAFISCHE_ANFUEHRUNGSZEICHEN_2",suggestions:[{match:/[‚‘]/,message:"Alle <lt-em>'</lt-em>…<lt-em>'</lt-em> zu <lt-em>‚</lt-em>…<lt-em>‘</lt-em> ändern"},{match:/[„“]/,message:"Alle <lt-em>'</lt-em>…<lt-em>'</lt-em> zu <lt-em>„</lt-em>…<lt-em>“</lt-em> ändern"}]},{ruleId:"TYPOGRAFISCHE_APOSTROPHE",suggestions:[{match:/’/,message:"Alle Apostrophe zu <lt-em>’</lt-em> ändern"}]},{ruleId:"EN_QUOTES",suggestions:[{match:/[“”]/,message:"Change all <lt-em>&quot;</lt-em>…<lt-em>&quot;</lt-em> to <lt-em>“</lt-em>…<lt-em>”</lt-em>"}]},{ruleId:"WRONG_APOSTROPHE",suggestions:[{match:/'/,message:"Use <lt-em>'</lt-em> for all bad apostrophes"},{match:/’/,message:"Use <lt-em>’</lt-em> for all bad apostrophes"}]},{ruleId:"PARAGRAF_LEERZEICHEN",suggestions:[{match:/§\u00A0/,message:"Alle Leerzeichen nach <lt-em>§</lt-em> ändern"}]},{ruleId:"CONSISTENCYRULE_JE_F",suggestions:[{match:/[^e]$/,message:"Remplacer tous les <lt-em>je</lt-em> vers le masculin"}]},{ruleId:"CONSISTENCYRULE_JE_M",suggestions:[{match:/e$/,message:"Remplacer tous les <lt-em>je</lt-em> vers le féminin"}]},{ruleId:"COMILLAS_TIPOGRAFICAS",suggestions:[{match:/[“”]/,message:"Cambiar todas las <lt-em>&quot;</lt-em>…<lt-em>&quot;</lt-em> por <lt-em>“</lt-em>…<lt-em>”</lt-em>"},{match:/(^«)|(»$)/,message:"Cambiar todas las <lt-em>&quot;</lt-em>…<lt-em>&quot;</lt-em> por <lt-em>«</lt-em>…<lt-em>»</lt-em>"}]},{ruleId:"COMETES_TIPOGRAFIQUES",suggestions:[{match:/[“”]/,message:"Canvia totes les <lt-em>&quot;</lt-em>…<lt-em>&quot;</lt-em> per <lt-em>“</lt-em>…<lt-em>”</lt-em>"},{match:/(^«)|(»$)/,message:"Canvia totes les <lt-em>&quot;</lt-em>…<lt-em>&quot;</lt-em> per <lt-em>«</lt-em>…<lt-em>»</lt-em>"}]},{ruleId:"TYPOGRAFISCHE_AANHALINGSTEKENS",suggestions:[{match:/[„“]/,message:"Alle <lt-em>&quot;</lt-em>…<lt-em>&quot;</lt-em> veranderen in <lt-em>„</lt-em>…<lt-em>“</lt-em>"}]},{ruleId:"PT_SMART_QUOTES",suggestions:[{match:/[“”]/,message:"Corrigir todas as aspas."}]},{ruleId:"GL_SMART_QUOTES",suggestions:[{match:/[“”]/,message:"Corrixir todas as comiñas."}]}],nt=["en","de","es","ca","fr","nl","pt"],st=["de","fr"],at=3,it=/^[ \u00A0]|[ \u00A0]$/g,ot=/\u202F/g,ct="E_ABORT",lt="E_PAYLOAD_TOO_LARGE",ut="E_TIMEOUT",gt="E_GENERIC",dt={borderRadiusSmall:4,borderRadiusMedium:8,borderRadiusLarge:12,light:{accentColorDark:"#1976F0",accentColorMedium:"#239AFF",accentColorLight:"#ECF6FF",textColorDark:"#2f3237",textColorMedium:"#5E636E",textColorLight:"#8F96A3",backgroundColorDark:"#DEE3ED",backgroundColorMedium:"#F1F3F9",backgroundColorLight:"#fff",borderColor:"#F1F3F9"},dark:{accentColorDark:"#ECF6FF",accentColorMedium:"#5EB5FF",accentColorLight:"#1976F0",textColorDark:"#f1f3f9",textColorMedium:"#DEE3ED",textColorLight:"#C2C9D6",backgroundColorDark:"#5E636E",backgroundColorMedium:"#2f3237",backgroundColorLight:"#111213",borderColor:"#1D1E20"},fontFamily:{macos:"LanguageTool-mac",win:"LanguageTool-win"}};class ht{static merge(e,t=!1){let{errors:r,pickyErrors:n,premiumErrors:s,premiumPickyErrors:a,sentenceRanges:i=[]}=this.filterAndMigrateErrors(e.existing.errors,e.existing.pickyErrors,e.existing.premiumErrors,e.existing.premiumPickyErrors,e.existing.sentenceRanges,e.existingCheckedText,e.newCheckedText);this.mergeParagraphLevelErrors(r,n,s,a,i,e.new.paragraphLevel.errors,e.new.paragraphLevel.pickyErrors,e.new.paragraphLevel.premiumErrors,e.new.paragraphLevel.premiumPickyErrors,e.new.paragraphLevel.sentenceRanges),this.mergeTextLevelErrors(r,n,s,a,e.new.textLevel.errors,e.new.textLevel.pickyErrors,e.new.textLevel.premiumErrors,e.new.textLevel.premiumPickyErrors);const o=this.getDuplicateErrors(e.existing,e.existingCheckedText,e.newCheckedText);return this.sortErrors(r,n,s,a),this.setIdsOnErrors(r,n,s,a,o),r=this.migrateOffsetsToOriginalText(r,e.newCheckedText.usedParts),n=this.migrateOffsetsToOriginalText(n,e.newCheckedText.usedParts),s=this.migrateOffsetsToOriginalText(s,e.newCheckedText.usedParts),a=this.migrateOffsetsToOriginalText(a,e.newCheckedText.usedParts),i=this.migrateOffsetsToOriginalText(i,e.newCheckedText.usedParts),t&&(n=n.filter((e=>!Qe.includes(e.rule.id))),n.forEach((e=>{e.rule.id="HIDDEN_RULE",e.fixes=[]})),s=[...s,...a,...n],a=[],n=[],this.sortErrorsByOffset(s)),{errors:r,pickyErrors:n,premiumErrors:s,premiumPickyErrors:a,sentenceRanges:i}}static getDuplicateErrors(e,t,r){let{errors:n,pickyErrors:s,premiumErrors:a,premiumPickyErrors:i}=e;n=this.migrateOffsetsToValuableText(n,t.usedParts),s=this.migrateOffsetsToValuableText(s,t.usedParts),a=this.migrateOffsetsToValuableText(a,t.usedParts),i=this.migrateOffsetsToValuableText(i,t.usedParts);const o=I(t.text,r.text),c=e=>{if(!e.isParagraphLevelCheck)return!0;const t=N(o,(t=>{const r=t.oldOffset;if(null===t.oldText)return e.start>=r?1:-1;const n=t.oldOffset+t.oldText.length+1;return F(e.start,r,n,!0)}));return!(!t||!t.textDiff)||void 0};return n=n.filter(c),s=s.filter(c),a=a.filter(c),i=i.filter(c),n=this.migrateOffsetsBetweenTexts(n,o),s=this.migrateOffsetsBetweenTexts(s,o),a=this.migrateOffsetsBetweenTexts(a,o),i=this.migrateOffsetsBetweenTexts(i,o),{errors:n,pickyErrors:s,premiumErrors:a,premiumPickyErrors:i}}static migrateOffsetsToValuableText(e,t){const r=[];for(const n of e){const e=N(t,(e=>F(n.start,e.originalStart,e.originalEnd,!0))),s=N(t,(e=>F(n.end,e.originalStart,e.originalEnd)));if(!e||!s)continue;const a=b(n);a.start-=e.posDiff,a.end-=s.posDiff,a.length=a.end-a.start,r.push(a)}return r}static migrateOffsetsBetweenTexts(e,t,r,n){let s,a=!1;"string"==typeof t&&"string"==typeof r?(s=I(t,r),a="boolean"==typeof n&&n):(s=t,a="boolean"==typeof r&&r);const i=[];for(const t of e){const e=N(s,(e=>{const r=e.oldOffset;if(null===e.oldText)return t.start>=r?1:-1;const n=e.oldOffset+e.oldText.length+1;return F(t.start,r,n,!0)})),r=b(t);if(e){if(e.textDiff){if(a)continue;{const t=e.oldOffset+e.textDiff.from,n=t+e.textDiff.oldFragment.length;if(G(t,n,r.start,r.end,!0))continue;if(r.start>=n){const t=e.textDiff.newFragment.length-e.textDiff.oldFragment.length;r.start+=t,r.end+=t}}}r.start+=e.newOffset-e.oldOffset,r.end=r.start+r.length}i.push(r)}return i}static migrateOffsetsToOriginalText(e,t){const r=[];for(const n of e){const e=N(t,(e=>F(n.start,e.start,e.end,!0))),s=N(t,(e=>F(n.end,e.start,e.end)));if(!e||!s)continue;const a=b(n);a.start+=e.posDiff,a.end+=s.posDiff,a.length=a.end-a.start,r.push(a)}return r}static filterAndMigrateErrors(e,t,r,n,s,a,i){e=e.filter((e=>e.isParagraphLevelCheck)),t=t.filter((e=>e.isParagraphLevelCheck)),r=r.filter((e=>e.isParagraphLevelCheck)),n=n.filter((e=>e.isParagraphLevelCheck)),e=this.migrateOffsetsToValuableText(e,a.usedParts),t=this.migrateOffsetsToValuableText(t,a.usedParts),r=this.migrateOffsetsToValuableText(r,a.usedParts),n=this.migrateOffsetsToValuableText(n,a.usedParts),s=this.migrateOffsetsToValuableText(s||[],a.usedParts);const o=I(a.text,i.text);return{errors:e=this.migrateOffsetsBetweenTexts(e,o,!0),pickyErrors:t=this.migrateOffsetsBetweenTexts(t,o,!0),premiumErrors:r=this.migrateOffsetsBetweenTexts(r,o,!0),premiumPickyErrors:n=this.migrateOffsetsBetweenTexts(n,o,!0),sentenceRanges:s=this.migrateOffsetsBetweenTexts(s,o,!0)}}static mergeParagraphLevelErrors(e,t,r,n,s,a,i,o,c,l=[]){e.push(...a),t.push(...i),r.push(...o),n.push(...c),s.push(...l)}static mergeTextLevelErrors(e,t,r,n,s,a,i,o){for(const t of s)e.some((e=>e.start===t.start&&e.end===t.end))||e.push(t);for(const e of a)t.some((t=>t.start===e.start&&t.end===e.end))||t.push(e);for(const e of i)r.some((t=>t.start===e.start&&t.end===e.end))||r.push(e);for(const e of o)n.some((t=>t.start===e.start&&t.end===e.end))||n.push(e)}static sortErrors(e,t,r,n){this.sortErrorsByOffset(e),this.sortErrorsByOffset(t),this.sortErrorsByOffset(r),this.sortErrorsByOffset(n)}static sortErrorsByOffset(e){e.sort(((e,t)=>e.start===t.start?e.isParagraphLevelCheck?1:-1:e.start>t.start?1:-1))}static migrateErrorsBetweenSameOriginalTexts(e,t,r){const n=[];for(const s of e){let e=s.start,a=s.end,i=N(t.usedParts,(t=>F(e,t.originalStart,t.originalEnd,!0))),o=N(t.usedParts,(e=>F(a,e.originalStart,e.originalEnd)));if(!i||!o)continue;if(e-=i.posDiff,a-=o.posDiff,i=N(r.usedParts,(t=>F(e,t.start,t.end,!0))),o=N(r.usedParts,(e=>F(a,e.start,e.end))),!i||!o)continue;e+=i.posDiff,a+=o.posDiff;const c=b(s);c.start=e,c.end=a,c.length=a-e,n.push(c)}return n}static setIdsOnErrors(e,t,r,n,s){function a(e,t){if(e.id)return;const r=t.find((t=>{return n=e,(r=t).start===n.start&&r.end===n.end&&r.isParagraphLevelCheck===n.isParagraphLevelCheck;var r,n}));e.id=r?r.id:"error:"+ ++ht.INCREMENTAL_ID}e.forEach((e=>a(e,s.errors))),t.forEach((e=>a(e,s.pickyErrors))),r.forEach((e=>a(e,s.premiumErrors))),n.forEach((e=>a(e,s.premiumPickyErrors)))}static sortSentenceRanges(e){e.sort((({start:e},{start:t})=>e-t))}}ht.INCREMENTAL_ID=0;
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class mt{constructor(e=document){this._window=e.defaultView,this._document=e,this.clearCache()}_getElementCache(e){let t=this._elementCache.get(e);return t||(t={},this._elementCache.set(e,t)),t}_consolidateSVGTransformMatrix(e){const t={a:1,b:0,c:0,d:1,e:0,f:0};for(let r=0;r<e.transform.baseVal.length;r++){const n=e.transform.baseVal[r];1===n.type?(t.a=n.matrix.a,t.b=n.matrix.b,t.c=n.matrix.c,t.d=n.matrix.d,t.e=n.matrix.e,t.f=n.matrix.f):2===n.type?(t.e=n.matrix.e,t.f=n.matrix.f):3===n.type?(t.a=n.matrix.a,t.d=n.matrix.d):5===n.type?t.b=n.matrix.b:6===n.type&&(t.c=n.matrix.c)}return t}clearCache(){this._documentVisibleBox=null,this._documentGap=null,this._documentScroll=null,this._elementCache=new WeakMap}_contains(e,t){return e&&e!==t&&e.contains(t)}_getComputedStyle(e,t,r){let n,s;return"object"==typeof t?(n=t,s=""):(n=r,s=t),n.computedStyle||(n.computedStyle=new Map),n.computedStyle.has(s)||n.computedStyle.set(s,this._window.getComputedStyle(e,s||null)),n.computedStyle.get(s)}getComputedStyle(e,t=""){return this._getComputedStyle(e,t,this._getElementCache(e))}_getComputedStyleMap(e,t){return e.computedStyleMap?(t.computedStyleMap||(t.computedStyleMap=e.computedStyleMap()),t.computedStyleMap):null}getComputedStyleMap(e){return this._getComputedStyleMap(e,this._getElementCache(e))}getInlineStyle(e,t){return e.style.getPropertyValue(t)}getStyle(e,t,r=""){return this.getStyles(e,[t],r)[t]}getStyles(e,t,r=""){let n=null,s={};const i=this._getElementCache(e);for(const o of t)if(n=n||this._getComputedStyle(e,r,i),"line-height"===o||"lineHeight"===o){const t=this.getInlineStyle(e,o);t&&t.includes("px")?s[o]=t:s[o]=n[o]||""}else if("font"!==o||n[o])if("transform"===o&&e instanceof SVGGElement&&a.isSafari()&&e.hasAttribute("transform")){const t=this._consolidateSVGTransformMatrix(e);s[o]=`matrix(${t.a}, ${t.b}, ${t.c}, ${t.d}, ${t.e}, ${t.f})`}else s[o]="zoom"===o?n[o]||"1":n[o]||"";else{const t=n["font-style"],r=n["font-variant"],a=n["font-weight"],i=n["font-size"],c=this.getInlineStyle(e,"line-height")||n["line-height"]||"",l=n["font-family"];s[o]=`${t} ${r} ${a} ${i} ${c?"/ "+c:""} ${l}`}return s}getExactStyle(e,t){return this.getExactStyles(e,[t])[t]}getExactStyles(e,t){const r=this._getElementCache(e),n=this._getComputedStyleMap(e,r);if(n){const e={};for(const r of t){const t=n.get(r);t?"number"==typeof(s=t).value&&"string"==typeof s.unit?"number"===t.unit?e[r]=t.value.toString():e[r]=t.value+t.unit:e[r]=t.toString():e[r]=""}return e}return this.getStyles(e,t);var s}setStyles(e,t,r=!1){Array.isArray(e)||(e=[e]);for(const n of e)for(const e in t){let s=t[e].trim();const a=r||mt.IMPORTANT_REG_EXP.test(s);s=s.replace(mt.IMPORTANT_REG_EXP,""),n.style.setProperty(e,s,a?"important":"")}}copyStyles(e,t,r,n=!1){const s=this.getStyles(e,r);this.setStyles(t,s,n)}resetStyles(e,t,r=!1){Array.isArray(e)||(e=[e]);let n="";for(const e in t){let s=t[e].trim();r&&!mt.IMPORTANT_REG_EXP.test(s)&&(s+=" !important"),n+=`${e}: ${s};`}for(const t of e)t.style.cssText=n}removeStyle(e,t){Array.isArray(e)||(e=[e]),this.removeStyles(e,[t])}removeStyles(e,t){Array.isArray(e)||(e=[e]);for(const r of e)for(const e of t)r.style.removeProperty(e)}_getBoundingClientRect(e,t){return t.boundingClientRect||(t.boundingClientRect=b(e.getBoundingClientRect())),t.boundingClientRect}getRelativeClientRect(e,t){const r=this._getBoundingClientRect(e,this._getElementCache(e)),n=this._getBoundingClientRect(t,this._getElementCache(t)),s=r.top-n.top,a=r.left-n.left,i=r.width,o=r.height;return{top:s,right:a+i,bottom:s+o,left:a,width:i,height:o}}_getBorderBox(e,t,r,n){const s="borderBox"+(t?"WithScroll":"")+(r?"WithScale":"");if(!n[s]){const a=this._getBoundingClientRect(e,n);let{top:i,left:o,width:c,height:l}=a;if(r){const t=this.getZoom(e);i*=t,o*=t,c*=t,l*=t}else{const t=this._getScaleFactor(e,n);c/=t.x,l/=t.y}if(t){const t=this.getDocumentScroll();if(i+=t.top,o+=t.left,this._document.body&&this._contains(this._document.body,e)){const e=this.getDocumentGap();i-=e.top,o-=e.left}}n[s]={top:i,right:o+c,bottom:i+l,left:o,width:c,height:l}}return n[s]}getBorderBox(e,t=!0,r=!0){return this._getBorderBox(e,t,r,this._getElementCache(e))}_getPaddingBox(e,t,r,n){const s="paddingBox"+(t?"WithScroll":"")+(r?"WithScale":"");if(!n[s]){let{top:a,left:i,width:o,height:c}=this._getBorderBox(e,t,r,n),l={x:1,y:1};r&&(l=this._getScaleFactor(e,n));const u=r?this._getZoom(e,n):1,g=this._getComputedStyle(e,n),d=(parseFloat(g["border-top-width"])||0)*l.y*u,h=(parseFloat(g["border-right-width"])||0)*l.x*u,m=(parseFloat(g["border-bottom-width"])||0)*l.y*u,_=(parseFloat(g["border-left-width"])||0)*l.x*u;let E=0,p=0;if("BackCompat"!==this._document.compatMode||e!==this._document.body||e!==this._document.scrollingElement){let{width:t,height:r}=this._getClientWidthAndHeight(e,n);t=t*l.x*u,r=r*l.y*u,E=o-_-t-h,p=c-d-r-m,E<1&&(E=0),p<1&&(p=0)}a+=d,i+=_,o=o-_-E-h,c=c-d-p-m,this._isRTL(e,n)&&(i+=E),n[s]={top:a,right:i+o,bottom:a+c,left:i,width:o,height:c,border:{top:d,right:h,bottom:m,left:_}}}return n[s]}getPaddingBox(e,t=!0,r=!0){return this._getPaddingBox(e,t,r,this._getElementCache(e))}_getContentBox(e,t,r,n){const s="contentBox"+(t?"WithScroll":"")+(r?"WithScale":"");if(!n[s]){let{top:a,left:i,width:o,height:c,border:l}=this._getPaddingBox(e,t,r,n),u={x:1,y:1};r&&(u=this._getScaleFactor(e,n));const g=r?this._getZoom(e,n):1,d=this._getComputedStyle(e,n),h=(parseFloat(d["padding-top"])||0)*u.y*g,m=(parseFloat(d["padding-right"])||0)*u.x*g,_=(parseFloat(d["padding-bottom"])||0)*u.y*g,E=(parseFloat(d["padding-left"])||0)*u.x*g;a+=h,i+=E,o=o-E-m,c=c-h-_,n[s]={top:a,right:i+o,bottom:a+c,left:i,width:o,height:c,border:l,padding:{top:h,right:m,bottom:_,left:E}}}return n[s]}getContentBox(e,t=!0,r=!0){return this._getContentBox(e,t,r,this._getElementCache(e))}_getClientWidthAndHeight(e,t){let r=e.clientWidth,n=e.clientHeight;if(0===r&&0===n&&"offsetWidth"in e){const s=this._getComputedStyle(e,t);"inline"===s.display&&(r=e.offsetWidth-parseInt(s["border-left-width"])-parseInt(s["border-right-width"]),n=e.offsetHeight-parseInt(s["border-top-width"])-parseInt(s["border-bottom-width"]))}return{width:r,height:n}}_getScrollDimensions(e,t,r){const n="scrollDimensions"+(t?"WithScale":"");if(!r[n]){let s=e.scrollWidth,a=e.scrollHeight;if(0===s&&(0===a||0===e.clientHeight)){const t=this._getClientWidthAndHeight(e,r);s=t.width,a=t.height}if(t){const t=this._getScaleFactor(e,r),n=this._getZoom(e,r);s=s*t.x*n,a=a*t.y*n}r[n]={width:s,height:a}}return r[n]}getScrollDimensions(e,t=!0){return this._getScrollDimensions(e,t,this._getElementCache(e))}_getScrollPosition(e,t,r,n){const s="scrollPosition"+(t?"WithScale":"")+(r?"WithZoom":"");if(!n[s]){let a={x:1,y:1};t&&(a=this._getScaleFactor(e,n));const i=r?this._getZoom(e,n):1,o=e===this._document.body&&"BackCompat"===this._document.compatMode,c=o?0:e.scrollTop*a.y*i,l=o?0:e.scrollLeft*a.x*i;n[s]={top:c,left:l}}return n[s]}getScrollPosition(e,t=!0,r=t){return this._getScrollPosition(e,t,r,this._getElementCache(e))}_isPositionFixed(e,t){if(void 0===t.isPositionFixed){t.isPositionFixed=!1;let r=e;for(;r;){if("fixed"===this.getStyle(r,"position")){t.isPositionFixed=!0;break}r=r.parentElement}}return t.isPositionFixed}isPositionFixed(e){return this._isPositionFixed(e,this._getElementCache(e))}_getContainingBlock(e,t,r){const n="absolute"===t,s=n?"containingBlockForAbsolutePosition":"containingBlockForFixedPosition";let i=r[s];if(void 0===i){i=null;const t=[document.documentElement,document.body],r=["layout","paint","strict","content"],s=["transform","perspective"];let o=e;for(;o&&!t.includes(o);){const e=this.getStyles(o,["position","transform","perspective","will-change","filter","contain","container-type","backdrop-filter"]);if(n&&"static"!==e.position||"none"!==e.transform||"none"!==e.perspective||"none"!==e.filter||r.includes(e.contain)||s.includes(e["will-change"])||"normal"!==e["container-type"]||"none"!==e["backdrop-filter"]&&""!==e["backdrop-filter"]||a.isFirefox()&&"filter"===e["will-change"]){i=this.getPaddingBox(o);break}o=o.parentElement}}return r[s]=i,i}getContainingBlock(e,t="absolute"){return this._getContainingBlock(e,t,this._getElementCache(e))}getScaleFactor(e){return this._getScaleFactor(e,this._getElementCache(e))}_getScaleFactor(e,t){if(void 0===t.scaleFactor){if(e instanceof SVGElement){if(a.isFirefox()||a.isThunderbird())return{x:1,y:1};let t=1;const r=e.getAttribute("transform")||"",n=/scale\((\d+(\.\d+)?)\)/.exec(r);return n&&(t=+n[1]),{x:t,y:t}}{const r=this._getBoundingClientRect(e,t),n=e.offsetWidth,s=e.offsetHeight;t.scaleFactor={x:1,y:1},r.width>0&&n>0&&Math.abs(r.width-n)>1&&(t.scaleFactor.x=r.width/n),r.height>0&&s>0&&Math.abs(r.height-s)>1&&(t.scaleFactor.y=r.height/s)}}return t.scaleFactor}_getZoom(e,t){if(a.isFirefox()||a.isThunderbird())return 1;if("number"!=typeof t.zoom){let r=1,n=e;for(;n&&n!==this._document.documentElement;){r*=+this.getStyle(n,"zoom"),n=n.parentNode instanceof ShadowRoot&&n.parentNode.host instanceof HTMLElement?n.parentNode.host:n.parentElement}t.zoom=r}return t.zoom}getZoom(e){return this._getZoom(e,this._getElementCache(e))}_getStackingContextWithZIndex(e){const t=this.getComputedStyle(e),r=parseInt(t.zIndex||"");if(isNaN(r))return null;if(t.position&&mt.NON_STATIC_POSITIONS.indexOf(t.position)>-1)return{zIndex:r};if(e.parentElement){const t=this.getComputedStyle(e.parentElement);if("flex"===t.display||"grid"===t.display)return{zIndex:r}}return null}getZIndex(e,t=this._document.documentElement){let r="auto",n=e;if(!n.ownerDocument)return"auto";const s=n.ownerDocument.defaultView.Element,a=n.ownerDocument.defaultView.ShadowRoot;for(;n&&n!==this._document&&n!==t&&n instanceof s;){const e=this._getStackingContextWithZIndex(n);e&&(r=e.zIndex),n=n.parentNode instanceof a?n.parentNode.host:n.parentElement}return r}_isRTL(e,t){return"boolean"!=typeof t.isRTL&&(t.isRTL="rtl"===this.getStyle(e,"direction")),t.isRTL}isRTL(e){return this._isRTL(e,this._getElementCache(e))}isStackingContext(e){const t=this.getComputedStyle(e);return!!(t.position&&mt.NON_STATIC_POSITIONS.indexOf(t.position)>-1)||("none"!==t.transform||"none"!==t.filter||"none"!==t.clipPath||"none"!==t.perspective||Number(t.opacity)<1)}_getTextClientRects(e){const t=this._document.createRange();return t.setStart(e.node,e.start),t.setEnd(e.node,e.end),Array.from(t.getClientRects())}getTextBoundingBoxes(e,t,r=!0){Array.isArray(e)||(e=[e]);let n=[],s=0,a=0;if(r){const e=this.getDocumentScroll();if(s+=e.top,a+=e.left,this._document.body&&this._contains(this._document.body,t)){const e=this.getDocumentGap();s-=e.top,a-=e.left}}for(const t of e)try{const e=this._getTextClientRects(t);for(const t of e){if(t.width<mt.MIN_TEXT_BOX_WIDTH)continue;const e=n[n.length-1],r=t.top+s,i=t.right+a,o=t.bottom+s,c=t.left+a,l=t.width,u=t.height;e&&e.right===c&&e.top===r&&e.bottom===o&&e.height===u?(e.right=i,e.width=e.width+l):n.push({top:r,right:i,bottom:o,left:c,width:l,height:u})}}catch(e){}return n}getRelativeTextBoundingBoxes(e,t,r=this.getScrollPosition(t)){Array.isArray(e)||(e=[e]);let n=[];const s=this.getPaddingBox(t,!1,!1),a=s.left-r.left,i=s.top-r.top;for(const t of e)try{const e=this._getTextClientRects(t);for(const t of e){if(t.width<mt.MIN_TEXT_BOX_WIDTH)continue;const e=n[n.length-1],r=t.top-i,s=t.right-a,o=t.bottom-i,c=t.left-a,l=t.width,u=t.height;e&&e.right===c&&e.top===r&&e.bottom===o&&e.height===u?(e.right=s,e.width=e.width+l):n.push({top:r,right:s,bottom:o,left:c,width:l,height:u})}}catch(e){console.error("LT range error",e)}const o=this.getScaleFactor(t);for(const e of n)e.top=Math.round(e.top/o.y),e.right=Math.round(e.right/o.x),e.bottom=Math.round(e.bottom/o.y),e.left=Math.round(e.left/o.x),e.width=e.right-e.left,e.height=e.bottom-e.top;return n}getRelativeTextBoundingBox(e,t){const r=this.getRelativeTextBoundingBoxes(e,t),n=Math.min(...r.map((e=>e.top))),s=Math.max(...r.map((e=>e.right))),a=Math.max(...r.map((e=>e.bottom))),i=Math.min(...r.map((e=>e.left)));return{top:n,right:s,bottom:a,left:i,width:s-i,height:a-n}}_hasRelativePosition(e,t){const r=this._getComputedStyle(e,t).position||"static";return mt.NON_STATIC_POSITIONS.indexOf(r)>-1}getDocumentGap(){if(!this._documentGap&&(this._documentGap={top:0,left:0},this._document.body&&this._hasRelativePosition(this._document.body,this._getElementCache(this._document.body)))){const e=this.getBorderBox(this._document.documentElement),t=this.getBorderBox(this._document.body);let r=this._document.documentElement.offsetTop,n=this._document.documentElement.offsetLeft;if(a.isFirefox()||a.isThunderbird()){let e=null;0===r&&(e=this.getComputedStyle(this._document.documentElement),r=parseInt(e["margin-top"])||0),0===n&&(e=e||this.getComputedStyle(this._document.documentElement),n=parseInt(e["margin-left"])||0)}const s=t.top-e.top+r,i=t.left-e.left+n,o=this.getComputedStyle(this._document.body),c=parseFloat(o["border-top-width"])||0,l=parseFloat(o["border-left-width"])||0;this._documentGap={top:s+c,left:i+l}}return this._documentGap}getDocumentVisibleBox(){if(!this._documentVisibleBox){const e=this.getDocumentScroll();let t=this._document.documentElement.clientHeight,r=this._document.documentElement.clientWidth;a.isThunderbird()&&(t=self.innerHeight,r=self.innerWidth),this._documentVisibleBox={top:e.top,right:e.left+r,bottom:e.top+t,left:e.left,width:r,height:t}}return this._documentVisibleBox}getDocumentScroll(){if(!this._documentScroll){const e=this._document.documentElement&&this._document.documentElement.scrollTop||this._document.body&&this._document.body.scrollTop||0,t=this._document.documentElement&&this._document.documentElement.scrollLeft||this._document.body&&this._document.body.scrollLeft||0;this._documentScroll={top:e,left:t}}return this._documentScroll}}mt.IMPORTANT_REG_EXP=/!important$/,mt.TRANSFORM_MATRIX_REG_EXP=/(?:matrix|scale)\(([\d\.]+),/,mt.NON_STATIC_POSITIONS=["relative","fixed","absolute","sticky"],mt.MIN_TEXT_BOX_WIDTH=.1;var _t=r(3131),Et=r.n(_t);function pt(){return Et()}
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class ft{}ft.eventNames={localeChanged:"lt-i18nManager.localeChanged"};const At=class{static init(e){this._instance=e}static addEventListener(e,t){this._instance.addEventListener(e,t)}static setLocale(e){this._instance.setLocale(e)}static getMessage(e,t){return this._instance.getMessage(e,t)}};
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
function St(e=25,t=null){return new Promise((r=>setTimeout((()=>r(t)),e)))}(()=>{const e=(e,t,r,n)=>{const s=e.ownerDocument;let a=s.elementFromPoint(r,n);if(!a)return!1;if(e===a||e.contains(a))return!0;if(!t.length)return!1;return t.find((e=>e.contains(a)))&&(a=s.elementsFromPoint(r,n).find((e=>!1===t.some((t=>t.contains(e)))))||null),Boolean(a&&(e===a||e.contains(a)))}})();function Tt(e,t,r={}){const n=new CustomEvent(t,{detail:r,cancelable:!0});return e.dispatchEvent(n)}(()=>{let e;const t=[]})(),(()=>{let e;const t=[]})();function Ct(e){if(e.ownerDocument&&e.ownerDocument.contains(e))return!0;let t=e;for(;t&&t.parentNode;){if(t.parentNode===document)return!0;t.parentNode instanceof DocumentFragment?t.parentNode.host:t.parentNode}return!1}new Set(["article","aside","blockquote","body","div","footer","h1","h2","h3","h4","h5","h6","header","main","nav","p","section","span"]);function Rt(e,t){const r=t||"content/styles/shadow.css",n=pt().runtime.getURL(r);if(!e.querySelector(`[href="${n}"]`)){const t=document.createElement("link");t.href=n,t.rel="stylesheet",e.append(t)}}function It(e,t,r,n=Date.now().toString()){const s=self,a=void 0!==s.screenLeft?s.screenLeft:s.screenX,i=void 0!==s.screenTop?s.screenTop:s.screenY,o=s.innerWidth?s.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,c=s.innerHeight?s.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,l=o/s.screen.availWidth,u=(o-t)/2/l+a,g=(c-r)/2/l+i;return s.open(e,n,`\n      scrollbars=yes,\n\t  resizable=yes,\n      width=${t/l},\n      height=${r/l},\n      top=${g},\n      left=${u}\n      `)}(function(){let e,t=null;const r=t=>{t.origin.match(/^chrome|moz|safari/)&&e(t.data)}})(),function(){let e,t=null;const r=t=>{e(t.data)}}();let Pt,Nt;!function(){const e=/ /g,t=/^#(?:[0-9a-f]{3}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{8})$/i,r=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,n=/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])?$/i,s=/^rgba?\(/i,a=/^rgba?\((\d+),(\d+),(\d+)(?:,(\d*(?:\.\d+)?))?\)/i,i=/^hsla?\(/i,o=/^hsla?\(\d+,\d+%,(\d+)%(?:,(\d*(?:\.\d+)?))?\)/i;function c(e,t,r){const n=Math.max(e,t,r)/255,s=Math.min(e,t,r)/255;return Math.round((n+s)/2*100)}Pt=function(c){if("string"!=typeof c)return 3===c.length?1:c[3];if(c=c.replace(e,""),t.test(c)){const e=r.exec(c)||n.exec(c);if(e&&e[4])return parseInt(2===e[4].length?e[4]:e[4]+e[4],16)/255}else if(s.test(c)){const e=a.exec(c);if(e&&e[4])return+e[4]}else if(i.test(c)){const e=o.exec(c);if(e&&e[2])return+e[2]}return 1},Nt=function(l){if("string"!=typeof l)return c(l[0],l[1],l[2]);if(l=l.replace(e,""),t.test(l)){const e=r.exec(l)||n.exec(l);if(e){return c(parseInt(2===e[1].length?e[1]:e[1]+e[1],16),parseInt(2===e[2].length?e[2]:e[2]+e[2],16),parseInt(2===e[3].length?e[3]:e[3]+e[3],16))}}else if(s.test(l)){const e=a.exec(l);if(e){return c(+e[1],+e[2],+e[3])}}else if(i.test(l)){const e=o.exec(l);if(e)return+e[1]}return 100}}();Array.from({length:16},((e,t)=>t.toString(16)));const yt=/^(https?:\/\/)?localhost(:[0-9]{1,5})?(\/.*)?$/i,Ot=/^(https?:\/\/)?[a-z0-9]+([-.]{1}[a-z0-9]+)*\.[a-z]{2,15}(:[0-9]{1,5})?(\/.*)?$/i,bt=/^(?:https?:\/\/)?(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])(?:\.(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])){3}(?::[0-9]{1,5})?$/;function Lt(e){return yt.test(e)||Ot.test(e)||bt.test(e)}function wt(e){return e.filter((e=>Lt(e)))}function vt(e){return wt(e).map((e=>{try{return x(e)}catch{return null}})).filter((e=>!!e))}
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class Dt extends i{constructor(){super(...arguments),this._isProductionEnvironmentCached=null}isProductionEnvironment(){if(null===this._isProductionEnvironmentCached){if(a.isSafari())return!0;a.isFirefox()||a.isThunderbird()?this._isProductionEnvironmentCached=!pt().runtime.id.match("languagetool.dev"):this._isProductionEnvironmentCached="update_url"in pt().runtime.getManifest()}return this._isProductionEnvironmentCached}isRuntimeConnected(){try{return pt().runtime.getManifest(),!0}catch(e){return!1}}getVersion(){if(this.isRuntimeConnected()){const e=pt().runtime.getManifest();return e&&e.version?e.version:"unknown"}return"unknown"}getTrackingId(){return a.isSafari()?"13":a.isThunderbird()?"22":"12"}shouldTrack(){return"1"!==navigator.doNotTrack&&!a.isFirefox()}getType(){return"extension"}getBeforeUnloadEventName(){return"pagehide"}getURL(e){return pt().runtime.getURL(e)}getUILanguageCode(){return pt().i18n.getUILanguage?pt().i18n.getUILanguage():navigator.language}openWindow(e){pt().runtime.sendMessage({command:"OPEN_URL",url:e})}injectExecutor(){return new Promise(((e,t)=>{if(a.isThunderbird())return e();const r=setTimeout((()=>{t()}),2e3),n=function(){const e=document.createElement("script");return e.setAttribute("data-cookieconsent","ignore"),e}();n.src=pt().runtime.getURL("/content/executor.js"),n.async=!0,n.setAttribute("fetchpriority","low"),n.onload=function(){n.remove(),clearTimeout(r),e()},n.onerror=function(){n.remove(),clearTimeout(r),t()},(document.head||document.documentElement).appendChild(n)}))}destroyExecutor(){Tt(document,"lt-execute-destroy")}executeScript(e,t){const r=new self.Object;r.code=t,Tt(e,"lt-execute-code",r)}linkInputAreaProperties(e){Tt(e,"lt-execute-link-properties")}ping(){return new Promise(((e,t)=>{const r=self.setTimeout((()=>t("timeout")),5e3);pt().runtime.sendMessage({command:"BACKGROUND_PING"}).then((n=>{self.clearTimeout(r),"success"===n?e():t("unknown")})).catch((()=>{self.clearTimeout(r),t("error")}))}))}canLoadContentScripts(e){return"css"===e||2===pt().runtime.getManifest().manifest_version}loadContentScripts(e,t){return this.isRuntimeConnected()&&this.canLoadContentScripts(t)?(pt().runtime.getManifest().content_scripts.forEach((r=>{if("js"===t&&r.js){const t=r.js.map((e=>{const t=this.getURL(e);return fetch(t).then((e=>e.text()))}));return Promise.all(t).then((t=>{const r=t.join("\n");if("safari"in e)try{e.eval("window.safari = window.safari || window.parent.safari;")}catch(e){}e.eval(r)}))}if("css"===t&&r.css)return this.loadStylesheets(e,r.css)})),Promise.resolve()):Promise.reject()}loadStylesheets(e,t){const r=t.map((e=>{const t=this.getURL(e);return fetch(t).then((e=>e.text()))}));return Promise.all(r).then((t=>{t.forEach((t=>{const r=e.document.createElement("style");r.textContent=t,(e.document.head||e.document.documentElement).appendChild(r)}))}))}injectShadowStyles(e){Rt(e)}initializeLTAssistant(e,t={}){return Promise.resolve()}getPreferredLanguages(){return pt().runtime.sendMessage({command:"GET_PREFERRED_LANGUAGES"})}startDictionarySync(){return pt().runtime.sendMessage({command:"START_DICTIONARY_SYNC"})}updateDictionary(){return pt().runtime.sendMessage({command:"UPDATE_DICTIONARY"})}addWordToDictionary(e){const t={command:"ADD_WORD_TO_DICTIONARY",word:e};return pt().runtime.sendMessage(t)}addWordsToDictionary(e){const t={command:"BATCH_ADD_WORDS_TO_DICTIONARY",words:e};return pt().runtime.sendMessage(t)}removeWordFromDictionary(e){const t={command:"REMOVE_WORD_FROM_DICTIONARY",word:e};return pt().runtime.sendMessage(t)}clearDictionary(){return pt().runtime.sendMessage({command:"CLEAR_DICTIONARY"})}loadSynonyms(e,t,r){const n={command:"LOAD_SYNONYMS",wordContext:e,language:t,motherTongue:r};return pt().runtime.sendMessage(n)}abortSynonymsRequest(){return pt().runtime.sendMessage({command:"ABORT_SYNONYMS_REQUEST"})}loadPhrases(e,t,r,n,s){const a={command:"LOAD_PHRASES",uuid:e,phrase:t,language:r,inhouseOnly:n,user:s};return pt().runtime.sendMessage(a)}reportPhrase(e,t){const r={command:"REPORT_PHRASE",uuid:e,report:t};return pt().runtime.sendMessage(r)}abortPhraseRequests(e){const t={command:"ABORT_PHRASE_REQUESTS",type:e};return pt().runtime.sendMessage(t)}initializeUserActivity(e){const t={command:"INITIALIZE_USER_ACTIVITY",data:e};return pt().runtime.sendMessage(t)}sendUserActivityPings(e){const t={command:"SEND_USER_ACTIVITY_PINGS",uuids:e};return pt().runtime.sendMessage(t)}updateUserActivityTextStatistics(e,t){const r={command:"UPDATE_USER_ACTIVITY_TEXT_STATISTICS",uuid:e,stats:t};return pt().runtime.sendMessage(r)}updateUserActivityAppliedSuggestions(e,t,r){const n={command:"UPDATE_USER_ACTIVITY_APPLIED_SUGGESTIONS",isPremium:r,type:t,uuid:e};return pt().runtime.sendMessage(n)}updateUserActivityAppliedRewritings(e){const t={command:"UPDATE_USER_ACTIVITY_APPLIED_REWRITINGS",uuid:e};return pt().runtime.sendMessage(t)}updateUserActivityMeta(e,t){const r={command:"UPDATE_USER_ACTIVITY_META",uuid:e,meta:t};return pt().runtime.sendMessage(r)}sendUserActivity(e){const t={command:"SEND_USER_ACTIVITY",uuid:e};return pt().runtime.sendMessage(t)}destroyUserActivity(e){const t={command:"DESTROY_USER_ACTIVITY",uuid:e};return pt().runtime.sendMessage(t)}loadSplitSentence(e,t,r,n,s){const a={command:"LOAD_SPLIT_SENTENCE",uuid:e,phrase:t,language:r,inhouseOnly:n,user:s};return pt().runtime.sendMessage(a)}trackEvent(e,t){const r={command:"TRACK_EVENT",action:e,label:t};return pt().runtime.sendMessage(r)}trackTextLength(e){const t={command:"TRACK_TEXT_LENGTH",textLength:e};return pt().runtime.sendMessage(t)}pageLoaded(e,t,r,n,s){const a={command:"PAGE_LOADED",enabled:e,supported:t,beta:r,unsupportedMessage:n,isDarkMode:s};return pt().runtime.sendMessage(a)}ltAssistantStatusChanged(e,t){const r={command:"LTASSISTANT_STATUS_CHANGED",tabId:"number"==typeof e?e:void 0,enabled:("object"==typeof e?e:t).enabled};return pt().runtime.sendMessage(r)}check(e,t,r,n,s,a){const i={command:"CHECK_TEXT",text:t,changedParagraphs:r,language:e.language,forceLanguage:e.forceLanguage,hasUserChangedLanguage:a,metaData:n,options:s};return pt().runtime.sendMessage(i)}isOptionsPageSupported(){return!0}openOptionsPage(e,t){const r={command:"OPEN_OPTIONS",target:e,ref:t};return pt().runtime.sendMessage(r)}isFeedbackFormSupported(){return!0}openFeedbackForm(e,t="",r=""){const n={command:"OPEN_FEEDBACK_FORM",url:e,title:t,html:r};return pt().runtime.sendMessage(n)}openPremiumPage(e,t=0,r=0,n=0,s="",a){const i={command:"OPEN_PREMIUM_PAGE",campaign:e,hiddenGrammarMatches:t,hiddenStyleMatches:r,hiddenPunctuationMatches:n,historicMatches:s,textLanguage:a||void 0};return pt().runtime.sendMessage(i)}checkForPaidSubscription(){return pt().runtime.sendMessage({command:"CHECK_FOR_PAID_SUBSCRIPTION"})}canUseShadowDom(){return!navigator.webdriver}toolboxNetworkInitiateRequest(e){const t="10000000-1000-4000-8000-100000000000".replace(/[018]/g,(e=>(Number(e)^crypto.getRandomValues(new Uint8Array(1))[0]&15>>Number(e)/4).toString(16))),r=this.toolboxNetworkGetRequestData(t,e);return{abort:()=>{this.toolboxNetworkAbortRequest(t)},getData:()=>r}}toolboxNetworkGetRequestData(e,t){const r={command:"TOOLBOX_NETWORK_GET_REQUEST_DATA",options:t,uuid:e};return pt().runtime.sendMessage(r)}toolboxNetworkAbortRequest(e){const t={command:"TOOLBOX_NETWORK_ABORT_REQUEST",uuid:e};return pt().runtime.sendMessage(t)}}
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class xt extends ft{addEventListener(e,t){}setLocale(e){}getMessage(e,t){return pt().i18n.getMessage?pt().i18n.getMessage(e,t):e}}
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class Ut{static getServerBaseUrl(e,t=!1,r=!0){const n=r&&(t?this._useFallbackServerForParagraphLevelRequests:this._useFallbackServerForTextLevelRequests)&&!e.apiServerUrl;return e.apiServerUrl&&!this._isLanguageToolServer(e.apiServerUrl)?e.apiServerUrl:e.isPremium||e.user||e.apiServerUrl===ge?n?de:ge:n?ue:le}static _getServerFullUrl(e,t=!1,r=!1){const n=this.getServerBaseUrl(e,t),s=n.endsWith("/")?"":"/",a=new URL(n+s+"check");return a.searchParams.set("c","1"),t&&!1===e.useParagraphLevelCaching||a.searchParams.set("instanceId",e.instanceId),r&&a.searchParams.set("languageChanged","true"),e.version&&a.searchParams.set("v",e.version),a.toString()}static _abortCheckRequest(e){this._textLevelAbortControllers.has(e)&&(this._textLevelAbortControllers.get(e).abort(),this._textLevelAbortControllers.delete(e))}static _abortParagraphLevelCheckRequest(e){this._paragraphLevelAbortControllers.has(e)&&(this._paragraphLevelAbortControllers.get(e).abort(),this._paragraphLevelAbortControllers.delete(e))}static _abortLanguageDetectionRequest(e){this._languageDetectionAbortControllers.has(e)&&(this._languageDetectionAbortControllers.get(e).abort(),this._languageDetectionAbortControllers.delete(e))}static _prepareText(e){return e.replace(this.ZWNJ_REGEXP,this.ZWS)}static _joinInChunks(e,t=Le){const r=[];let n=0,s=[];return e.forEach((e=>{n>t&&(n=0,s=[]),s.push(e),n+=e.text.length,r.includes(s)||r.push(s)})),r}static _getRequestData(e,t,r){const n=new URLSearchParams,s={text:e};r.recipientInfo&&(r.recipientInfo.address||r.recipientInfo.fullName)&&(s.metaData={EmailToAddress:r.recipientInfo.address,FullName:r.recipientInfo.fullName}),n.append("data",JSON.stringify(s));const a=Boolean(r.isPremium||!r.apiServerUrl||r.apiServerUrl&&r.apiServerUrl.startsWith(ge)||r.apiServerUrl&&!this._isLanguageToolServer(r.apiServerUrl));if(a&&r.user&&"password"in r.user?(n.append("username",r.user.email),n.append("password",r.user.password)):a&&r.user&&"token"in r.user&&(n.append("username",r.user.email),n.append("tokenV2",r.user.token)),n.append("textSessionId",r.instanceId),r.isPremium||n.append("enableHiddenRules","true"),r.motherTongue&&st.includes(r.motherTongue)&&n.append("motherTongue",r.motherTongue),"normal"!==r.checkLevel&&n.append("level",r.checkLevel.replace("hidden-","")),t)n.append("language",t.code);else{n.append("language","auto"),n.append("noopLanguages",r.preferredLanguages.join(","));const e=this._getPreferredVariants(r.languageVariants.en,r.languageVariants.de,r.languageVariants.pt,r.languageVariants.ca);e.length>0&&n.append("preferredVariants",e.toString())}if(r.testGroups){const e=[];for(const[t,n]of Object.entries(r.testGroups))n&&e.push(t);e.length&&n.append("abtest",e.join(","))}if(n.append("preferredLanguages",r.preferredLanguages.join(",")),r.forcePreferredLanguages&&n.append("forcePreferredLanguages","true"),r.writingGoalId){const e=this.HIGH_LEVEL_GOALS.find((e=>e.id===r.writingGoalId));e&&n.append("toneTags",e.tags.join(","))}const i=["WHITESPACE_RULE"].concat(r.disabledRules.filter((e=>et.includes(e))));return n.append("disabledRules",i.join(",")),r.userAgent&&n.append("useragent",r.userAgent),n}static _getPreferredVariants(e,t,r,n){const s=[];return e&&s.push(e),t&&s.push(t),r&&s.push(r),n&&s.push(n),s}static _getTextLevelRequestData(e,t,r){const n=this._getRequestData(e,t,r);return n.append("mode","textLevelOnly"),n}static _getParagraphLevelCheckRequestData(e,t,r,n){const s=this._getRequestData(e,t,r);return s.append("mode","allButTextLevelOnly"),s.append("allowIncompleteResults",String(n)),s}static async _sendRequest(e,t,r=te){const n=fetch(e,t).catch((t=>{throw"AbortError"===t.name?{reason:"AbortError",status:0,response:t.message||""}:{reason:"ConnectionError",status:0,url:e.replace(/\?.*/,""),response:t.message||""}})).then(this._checkForException).then((e=>e.json())),s=new Promise(((t,n)=>{setTimeout((()=>{n({reason:"TimeoutError",status:0,url:e.replace(/\?.*/,""),response:""})}),r)}));return Promise.race([n,s])}static _isConnectionOrServerIssue(e){return Te.includes(e.status)||["ConnectionError","TimeoutError"].includes(e.reason)}static _getGraphemesCount(e,t,r=0){for(let n=r;n<e.length;n++){if(t<=0)return n-r;t-=e[n].length}return e.length-r}static _getCodepointsCount(e,t,r=0){let n=0;for(let s=r;s<Math.min(e.length,r+t);s++)n+=e[s].length;return n}static _correctMatches(e,t,r){if(t!==r){const n=v(t),s=v(r);for(const t of e){const e=Ut._getGraphemesCount(n,t.offset),r=Ut._getGraphemesCount(n,t.length,e);t.offset=Ut._getCodepointsCount(s,e),t.length=Ut._getCodepointsCount(s,r,e)}}return e}static _getLeftText(e,t,r,n=15){let s=Math.max(t-n,0);if(r){const r=e.lastIndexOf("\n",t);r>=s&&(s=r+1)}let a=e.substring(s,t).replace(this.NON_ALPHANUMERIC_AT_BEGINNING_REGEXP,"");return 0===s||r&&"\n"===e[s-1]||(a="..."+a),a}static _getRightText(e,t,r,n=15){let s=Math.min(t+n,e.length);if(r){const r=e.indexOf("\n",t);-1!==r&&r<=s&&(s=r)}let a=e.substring(t,s).replace(this.NON_ALPHANUMERIC_AT_END_REGEXP,"");return s===e.length||r&&"\n"===e[s]||(a+="..."),a}static _transformMatches(e,t,r,n=!1){return e.map((e=>{const s=e.rule.id.startsWith("DB_"),a=this.SPELLING_RULES_ID.some((t=>e.rule.id.includes(t))),i=this.STYLE_ISSUE_TYPES.some((t=>e.rule.issueType===t)),o="typographical"===e.rule.issueType&&"CASING"!==e.rule.category.id||"PUNCTUATION"===e.rule.category.id||"TYPOGRAPHY"===e.rule.category.id||e.rule.category.id.includes("KOMMA"),c=Boolean(e.rule.tags&&e.rule.tags.includes("picky")),l=t.substr(e.offset,e.length),u=`${Ut._getLeftText(t,e.offset,n)}|${l}|${Ut._getRightText(t,e.offset+e.length,n)}`,g=Ut._getLeftText(t,e.offset,!0,60),d=Ut._getRightText(t,e.offset+e.length,!0,60),h=`${P(g)}<lt-em>${P(l)}</lt-em>${P(d)}`;let m="";e.shortMessage&&e.shortMessage.length<60&&e.shortMessage!==e.message&&(m=e.shortMessage.replace(this.PUNCTUATION_AT_END,""));const _=e.replacements.map((e=>({value:e.value,prefix:e.prefix,suffix:e.suffix,type:e.type,shortDescription:e.shortDescription})));return{isParagraphLevelCheck:n,rule:e.rule,isCustomError:s,isSpellingError:a,isStyleError:i,isPunctuationError:o,isPicky:c,contextForSureMatch:e.contextForSureMatch,language:{code:r.code,name:r.name},description:e.message,shortDescription:m,goodExample:e.goodExample,badExample:e.badExample,start:e.offset,end:e.offset+e.length,length:e.length,originalPhrase:l,contextPhrase:u,longContextPhrase:h,fixes:_}}))}static _adjustErrors(e,t,r){const n=r.recipientInfo?r.recipientInfo.fullName.split(" ").filter((e=>e)):[];return e.filter((e=>{e.fixes=e.fixes.filter((t=>t.value!=="("+e.originalPhrase+")"&&t.value!==e.originalPhrase&&"(suggestion limit reached)"!==t.value&&"(se ha alcanzado el límite de sugerencias)"!==t.value&&"(Vorschlagslimit erreicht)"!==t.value)),e.language.code.startsWith("en")&&p(e.originalPhrase)&&!/[a-z]/i.test(e.contextPhrase)&&e.fixes.forEach((t=>{t.value.toLowerCase()!==e.originalPhrase.toLowerCase()&&(t.value=t.value.toUpperCase())})),"PT_CLICHE_REPLACE"!==e.rule.id&&"PT_WORDINESS_REPLACE"!==e.rule.id||e.fixes.forEach((t=>{(t.value.startsWith("REFORMULAR")||t.value.startsWith("APAGAR")||t.value.startsWith("ESPECIFICAR"))&&(e.description=e.description.replace(/\sÉ preferível dizer.+(REFORMULAR|APAGAR|ESPECIFICAR).+$/,""),t.value="")}));if(this.EMAIL_SIGNATURE_SEPARATOR_REGEXP.test(e.originalPhrase))return!1;if(this.ZWS_REGEXP.test(e.originalPhrase))return!1;if(e.rule.id.endsWith("WORD_REPEAT_BEGINNING_RULE")&&this.ONLY_NUMBERS_REGEXP.test(e.originalPhrase))return!1;if("LEERZEICHEN_HINTER_DOPPELPUNKT"===e.rule.id&&this.COLON_WHITESPACE_REGEXP.test(e.originalPhrase))return!1;const s=t.substring(e.start-25,e.start),a=t.substr(e.end,25);if(r.ignoreCapitalizationErrorsAtLineStart&&"UPPERCASE_SENTENCE_START"===e.rule.id&&this.PREVENT_MID_SENTENCE_CAPITALIZATION.test(s))return!1;if(r.ignoreCapitalizationErrorsAtLineStart&&"PUNCTUATION_PARAGRAPH_END"===e.rule.id&&this.PREVENT_MID_SENTENCE_PUNCTUATION.test(a))return!1;if("DE_CASE"===e.rule.id&&this.BULLET_POINT_REGEXP.test(s))return!1;if("DE_CASE"===e.rule.id&&this.NUMBER_WITH_PARENTHESIS_AT_END_REGEXP.test(s))return!1;if("DE_CASE"===e.rule.id&&this.PIPE_AT_END_REGEXP.test(s))return!1;if("DE_CASE"===e.rule.id&&this.MARKDOWN_HEADLINE_REGEXP.test(s))return!1;if("DE_CASE"===e.rule.id&&this.EMOJI_SENTENCE_START_REGEXP.test(s))return!1;if("LEERZEICHEN_HINTER_DOPPELPUNKT"===e.rule.id&&this.MARKDOWN_INLINE_FORMAT_AT_BEGINNING_REGEXP.test(a))return!1;if("LEERZEICHEN_HINTER_DOPPELPUNKT"===e.rule.id&&this.WIKI_MARKUP_AT_END_REGEXP.test(s))return!1;if(e.rule.id.endsWith("UNPAIRED_BRACKETS")&&("!"===e.originalPhrase||"?"===e.originalPhrase)&&(s.endsWith("!")||s.endsWith("?")))return!1;if(e.rule.id.endsWith("UNPAIRED_BRACKETS")&&this.ONE_LETTER_AT_END_REGEXP.test(s))return!1;if(e.rule.id.endsWith("UNPAIRED_BRACKETS")&&this.NUMBER_WITH_DOT_AT_END_REGEXP.test(s))return!1;if("SENTENCE_WHITESPACE"===e.rule.id&&s.endsWith("{!"))return!1;if("SENTENCE_WHITESPACE"===e.rule.id&&this.SINGLE_UPPERCASE_LETTER_REGEXP.test(e.originalPhrase)&&this.ABBREVIATION_AT_END_REGEXP.test(s))return!1;if("SENTENCE_WHITESPACE"===e.rule.id&&"net"===e.originalPhrase.toLowerCase())return!1;if("COMMA_PARENTHESIS_WHITESPACE"===e.rule.id&&this.NET_AT_BEGINNING_REGEXP.test(a))return!1;if("COMMA_PARENTHESIS_WHITESPACE"===e.rule.id&&e.originalPhrase.endsWith(")")&&s.endsWith(this.ZWS))return!1;if("COMMA_PARENTHESIS_WHITESPACE"===e.rule.id&&e.originalPhrase.endsWith(".")&&this.FILE_TYPE_AT_BEGINNING_REGEXP.test(a))return!1;if("COMMA_PARENTHESIS_WHITESPACE"===e.rule.id&&s.endsWith("(")&&(",)"===e.originalPhrase||".)"===e.originalPhrase))return!1;if("COMMA_PARENTHESIS_WHITESPACE"===e.rule.id&&s.endsWith("\n")&&[")","}","]","."].includes(e.originalPhrase))return!1;if("COMMA_PARENTHESIS_WHITESPACE"===e.rule.id&&a.startsWith("/"))return!1;if("COMMA_PARENTHESIS_WHITESPACE"===e.rule.id&&e.originalPhrase.includes(this.ZWS))return!1;if("WORT1_BINDESTRICH_SPACE_WORT2"===e.rule.id&&e.originalPhrase.endsWith(this.ZWS))return!1;if("MULTIPLICATION_SIGN"===e.rule.id&&(this.AT_LEAST_TWO_LETTERS_AT_END_REGEXP.test(s)||!a||this.PUNCTUATION_AT_BEGINNING_REGEXP.test(a)))return!1;if("ZBEDNA_SPACJA_PRZED"===e.rule.id&&e.originalPhrase.includes(this.ZWS))return!1;if("UNLIKELY_OPENING_PUNCTUATION"===e.rule.id&&this.PUNCTUATION_SPACE_AT_END_REGEXP.test(s))return!1;if("WORD_CONTAINS_UNDERSCORE"===e.rule.id&&(!this.LOWERCASE_REGEXP.test(e.originalPhrase)||e.originalPhrase.includes("-")||e.originalPhrase.includes("__")||this.SLASH_AT_END_REGEXP.test(s)||this.SLASH_AT_BEGINNING_REGEXP.test(a)))return!1;if("WORD_CONTAINS_UNDERSCORE"===e.rule.id&&s.endsWith("[")&&a.startsWith("]"))return!1;if("WORD_CONTAINS_UNDERSCORE"===e.rule.id&&this.QUOTE_AT_END_REGEXP.test(s)&&this.QUOTE_AT_BEGINNING_REGEXP.test(a))return!1;if("WORD_CONTAINS_UNDERSCORE"===e.rule.id&&(s.endsWith("=")||s.endsWith("&")||s.endsWith("?")))return!1;if(["APOS_INCORRECT","LOOSE_ACCENTS"].includes(e.rule.id)&&"`"===e.originalPhrase)return!1;if(["_2_AANH_B","FALSCHES_ANFUEHRUNGSZEICHEN_2"].includes(e.rule.id)&&"``"===e.originalPhrase)return!1;if("DASH_RULE"===e.rule.id&&a.startsWith(" [")&&(!s||s.endsWith("\n")))return!1;if(e.isSpellingError&&e.originalPhrase.length>6&&e.fixes.length>4&&e.language.code.startsWith("de")&&(e.fixes.length=4),e.isSpellingError||"WORD_CONTAINS_UNDERSCORE"===e.rule.id){const t=e.originalPhrase.charAt(0),i=e.originalPhrase.toLowerCase();if(k(e,r.dictionary))return!1;if((a.startsWith("_")||s.endsWith("_"))&&!e.language.code.startsWith("de"))return!1;if(e.originalPhrase.startsWith("$")&&a.startsWith("}")&&s.endsWith("{"))return!1;if(e.originalPhrase.startsWith("$")&&e.originalPhrase.endsWith("$"))return!1;if(this.HTML_ENTITIES.includes(e.originalPhrase)&&s.endsWith("&")||this.HTML_ENTITIES_WITH_AND.includes(e.originalPhrase)||this.HTML_ENTITIES_WITH_AND.includes("&"+e.originalPhrase))return!1;if(this.COMMON_TLDS.some(((e,t)=>i.endsWith("."+e)||this.COMMON_TLD_WITH_DOT_REGEXPS[t].test(a))))return!1;if(this.DOT_WITH_PREFIX_REGEXP.test(s)&&this.COMMON_TLDS.includes(i))return!1;if(this.COMMON_FILE_TYPES.some(((e,t)=>i.endsWith("."+e)||this.COMMON_FILE_TYPE_WITH_DOT_REGEXPS[t].test(a))))return!1;if(this.DOT_WITH_PREFIX_REGEXP.test(s)&&this.COMMON_FILE_TYPES.includes(i))return!1;const o="@"===t||this.MENTION_SYMBOL_AT_BEGINNING_REGEXP.test(s),c="#"===t||this.HASH_SYMBOL_AT_BEGINNING_REGEXP.test(s);if(o||c)return!1;if(n.some((t=>t===e.originalPhrase)))return!1;if(this.WAVY_DASH_REGEXP.test(e.originalPhrase))return!1;for(const t of n)if(t.toLowerCase()===e.originalPhrase.toLowerCase()&&!e.fixes.some((e=>e.value===t))){e.fixes.unshift({value:t});break}}return!0}))}static _processResponse(e,t,r,n,s,a=!1){e.matches=this._correctMatches(e.matches,r,n);let i=this._transformMatches(e.matches,n,e.language,a);i=this._adjustErrors(i,n,s);let o=[],c=[],l=[];const u=!s.apiServerUrl||this._isLanguageToolServer(s.apiServerUrl);return t=this._correctMatches(t.filter((({start:e,end:t})=>t-e>-1)).map((({start:e,end:t,detectedLanguages:r})=>({offset:e,length:t-e,detectedLanguages:r}))),r,n).map((({offset:e,length:t,detectedLanguages:r})=>({start:e,end:e+t,length:t,detectedLanguages:r}))),!s.isPremium&&u&&e.language&&e.language.code.startsWith("nl")&&(i=i.filter((e=>!this.NL_PREMIUM_RULES.includes(e.rule.id)||(e.rule.id="HIDDEN_RULE",e.fixes=[],o.push(e),!1)))),!s.isPremium&&u&&e.language&&e.language.code.startsWith("pl")&&(i=i.filter((e=>!this.PL_PREMIUM_RULES.includes(e.rule.id)||(e.rule.id="HIDDEN_RULE",e.fixes=[],o.push(e),!1)))),s.isPremium&&i.forEach((e=>{this.NL_PREMIUM_RULES.includes(e.rule.id)&&(e.rule.isPremium=!0),this.PL_PREMIUM_RULES.includes(e.rule.id)&&(e.rule.isPremium=!0)})),s.debug&&i.forEach((e=>{e.description=(e.rule.isPremium?"prem:":"")+e.rule.id+"["+(e.rule.subId||"")+"] "+e.description})),e.hiddenMatches&&(o=o.concat(this._transformMatches(e.hiddenMatches,n,e.language,a))),"hidden-picky"===s.checkLevel&&(i=i.filter((e=>!e.isPicky||(l.push(e),!1))),e.hiddenMatches&&(o=o.filter((e=>!e.isPicky||(c.push(e),!1))))),{errors:i,premiumErrors:o,pickyErrors:l,premiumPickyErrors:c,sentenceRanges:t}}static _getNonAlphaNumericalOffsets(e,t){const r=new RegExp(`^(?:\\p{L}|\\p{N}${t?"|"+t.start:""})$`,"gu"),n=new RegExp(`^(?:\\p{L}|\\p{N}${t?"|"+t.end:""})$`,"gu"),s=e.split("").reverse().join(""),a=Math.floor(e.length/2);let i,o,c=!1,l=!1,u=0,g=0;for(let t=0;t<a;t++){const a=e.charAt(t),d=s.charAt(t);if(!0===i||null!==a.match(r)&&!a.match(/\s/)?i=!0:(c=null!==a.match(this.QUOTE_AT_BEGINNING_REGEXP),u+=1,i=!1),!0===o||null!==d.match(n)&&!d.match(/\s/)?o=!0:(l=null!==d.match(this.QUOTE_AT_END_REGEXP),g+=1,o=!1),i&&o)break}return c&&!l&&(u-=1),l&&!c&&(g-=1),[u,g]}static _trimSentenceRanges(e,t){const r=[];for(const n of e){const{start:e,end:s}=n,a=t.substring(e,s);if(!a.trim())continue;const[i,o]=this._getNonAlphaNumericalOffsets(a,{start:"[¿¡(@]",end:"[?!.)…:;‽]"}),c=e+i,l=c+a.length-i-o,u=l-c;r.push({start:c,end:l,length:u,detectedLanguages:n.detectedLanguages})}return r}static _correctErrorOffsets(e,t){const r=[];let n=0;for(const s of e){const e=s.text.length;for(const a of t)if(a.start>=n&&a.end<=n+e){const e=Object.assign({},a);e.start=e.start-n+s.offset,e.end=e.start+e.length,r.push(e)}n+=e+2}return r}static async checkTextLevel(e,t,r,n=!1){if(!(e=this._prepareText(e)).trim()||/^( *\n)* *$/g.test(e))return{language:t,errors:[],premiumErrors:[],pickyErrors:[],premiumPickyErrors:[]};this._abortCheckRequest(r.instanceId),this._textLevelAbortControllers.set(r.instanceId,new AbortController),this._useFallbackServerForTextLevelRequests&&Date.now()-this._mainServerUnavailabilityTimeStamp>=Ce&&(this._useFallbackServerForTextLevelRequests=!1);const s=e.normalize(),a=this._getServerFullUrl(r,!1,n),i={method:"post",mode:"cors",credentials:"omit",body:this._getTextLevelRequestData(s,t,r),signal:this._textLevelAbortControllers.get(r.instanceId).signal};return this._sendRequest(a,i).then((t=>{const{errors:n,premiumErrors:a,pickyErrors:i,premiumPickyErrors:o}=this._processResponse(t,[],s,e,r);return{language:{code:t.language.code,name:t.language.name,detectedLanguage:t.language.detectedLanguage},errors:n,premiumErrors:a,pickyErrors:i,premiumPickyErrors:o}})).catch((n=>{if(this._isConnectionOrServerIssue(n)){this._abortCheckRequest(r.instanceId);if(!r.apiServerUrl&&!this._useFallbackServerForTextLevelRequests)return this._useFallbackServerForTextLevelRequests=!0,this._mainServerUnavailabilityTimeStamp=Date.now(),this.checkTextLevel(e,t,r)}throw n}))}static _buildSentenceRanges(e,t){if(!t.extendedSentenceRanges&&!t.sentenceRanges)return[];let r=t.extendedSentenceRanges;r||(r=(t.sentenceRanges||[]).map((e=>({from:e[0],to:e[1],detectedLanguages:[{language:t.language.code.split("-")[0],rate:1}]}))));const n=r.map((e=>({start:e.from,end:e.to,length:e.to-e.from,detectedLanguages:e.detectedLanguages.map((e=>({language:e.language,confidence:e.rate})))})));return this._trimSentenceRanges(n,e)}static async checkParagraphLevel(e,t,r,n=!1,s){e.forEach((e=>{e.text=this._prepareText(e.text)}));if(!e.some((e=>!!e.text.trim())))return{language:t,errors:[],premiumErrors:[],pickyErrors:[],premiumPickyErrors:[],isIncompleteResult:!1};this._abortParagraphLevelCheckRequest(r.instanceId),this._paragraphLevelAbortControllers.set(r.instanceId,new AbortController),this._useFallbackServerForParagraphLevelRequests&&Date.now()-this._mainServerUnavailabilityTimeStamp>=Ce&&(this._useFallbackServerForParagraphLevelRequests=!1);const a=this._getServerFullUrl(r,!0),i=this._joinInChunks(e),o=[];for(const e of i){const i=e.map((e=>e.text)).join("\n\n"),c=i.normalize(),l={method:"post",mode:"cors",credentials:"omit",body:this._getParagraphLevelCheckRequestData(c,t,r,n),signal:this._paragraphLevelAbortControllers.get(r.instanceId).signal},u={input:{paragraphs:e,editorCompleteText:s||"",preferredVariants:this._getPreferredVariants(r.languageVariants.en,r.languageVariants.de,r.languageVariants.pt,r.languageVariants.ca)}},g=(r.adapter?r.adapter?.grammarCheck(u):this._sendRequest(a,l)).then((t=>{const{language:n,warnings:s}=t;let a=t.ignoreRanges||[];r.debug&&a.length&&(t.matches=this._filterErrorsInIgnoredRanges(t.matches,a),t.hiddenMatches&&(t.hiddenMatches=this._filterErrorsInIgnoredRanges(t.hiddenMatches,a)),this._addIgnoredRangeMatches(c,t.matches,a));const{errors:o,premiumErrors:l,pickyErrors:u,premiumPickyErrors:g,...d}=this._processResponse(t,this._buildSentenceRanges(c,t),c,i,r,!0);let h=d.sentenceRanges;const m=this._correctErrorOffsets(e,o),_=this._correctErrorOffsets(e,l),E=this._correctErrorOffsets(e,u),p=this._correctErrorOffsets(e,g);return h=this._correctErrorOffsets(e,h),{language:{code:n.code,name:n.name},errors:m,premiumErrors:_,pickyErrors:E,premiumPickyErrors:p,isIncompleteResult:!!s&&s.incompleteResults,sentenceRanges:h}}));o.push(g)}return Promise.all(o).then((e=>({language:e[0].language,errors:Array.prototype.concat.apply([],e.map((e=>e.errors))),premiumErrors:Array.prototype.concat.apply([],e.map((e=>e.premiumErrors))),premiumPickyErrors:Array.prototype.concat.apply([],e.map((e=>e.premiumPickyErrors))),pickyErrors:Array.prototype.concat.apply([],e.map((e=>e.pickyErrors))),isIncompleteResult:e.some((e=>e.isIncompleteResult)),sentenceRanges:Array.prototype.concat.apply([],e.filter((e=>Boolean(e.sentenceRanges))).map((e=>e.sentenceRanges)))}))).catch((a=>{if(this._isConnectionOrServerIssue(a)){this._abortParagraphLevelCheckRequest(r.instanceId);if((!r.apiServerUrl||this._isLanguageToolServer(r.apiServerUrl))&&!this._useFallbackServerForParagraphLevelRequests)return this._useFallbackServerForParagraphLevelRequests=!0,this._mainServerUnavailabilityTimeStamp=Date.now(),this.checkParagraphLevel(e,t,r,n,s)}throw a}))}static _filterErrorsInIgnoredRanges(e,t){return e.filter((e=>{const r=e.offset,n=e.offset+e.length;return!t.some((e=>r>=e.from&&r<=e.to||n>=e.from&&n<=e.to))}))}static _addIgnoredRangeMatches(e,t,r){r.forEach((r=>{let n=r.to-r.from;const s=e.substring(r.from,r.to).match(/\s+$/);s&&(n-=s[0].length);const a={offset:r.from,length:n,rule:{id:"IGNORED_RANGE",category:{id:"IGNORED_RANGE",name:"Ignored Range"},issueType:"ignoredRange",description:"",isPremium:!1},contextForSureMatch:0,message:"This text is in a different language than the rest of the text.",shortMessage:"Different language: "+r.language.code,replacements:[]};t.push(a)}))}static async detectLanguage(e,t,r){if(e=this._prepareText(e),t||!e.trim()||/^( *\n)* *$/g.test(e))return{language:t,errors:[],premiumErrors:[],pickyErrors:[],premiumPickyErrors:[]};this._abortLanguageDetectionRequest(r.instanceId),this._languageDetectionAbortControllers.set(r.instanceId,new AbortController),this._useFallbackServerForLanguageDetection&&Date.now()-this._mainServerUnavailabilityTimeStamp>=Ce&&(this._useFallbackServerForLanguageDetection=!1);const n=e.substr(0,1e3).normalize(),s=this._getServerFullUrl(r,!1),a={method:"post",mode:"cors",credentials:"omit",body:this._getTextLevelRequestData(n,t,r),signal:this._languageDetectionAbortControllers.get(r.instanceId).signal};return this._sendRequest(s,a).then((e=>({language:{code:e.language.code,name:e.language.name},errors:[],premiumErrors:[],premiumPickyErrors:[],pickyErrors:[]}))).catch((n=>{if(this._isConnectionOrServerIssue(n)){this._abortLanguageDetectionRequest(r.instanceId);if((!r.apiServerUrl||this._isLanguageToolServer(r.apiServerUrl))&&!this._useFallbackServerForLanguageDetection)return this._useFallbackServerForLanguageDetection=!0,this._mainServerUnavailabilityTimeStamp=Date.now(),this.detectLanguage(e,t,r)}throw n}))}static _isLanguageToolServer(e){return!!e&&(e.includes("api.languagetool.org")||e.includes("languagetool.org/api")||e.includes("api.languagetoolplus.com"))}static checkForPaidSubscription(e,t,r,n=ge){return new Promise(((s,a)=>{n+=n.endsWith("/")?"check":"/check";const i=new URLSearchParams;i.append("language","en-us"),i.append("data",JSON.stringify({text:"The languagetool testrule 8634756."})),e&&t?(i.append("username",e),i.append("password",t)):e&&r&&(i.append("username",e),i.append("tokenV2",r));const o={method:"post",mode:"cors",credentials:"omit",body:i};this._sendRequest(n,o).then((e=>{const t=e.matches.some((e=>"PREMIUM_FAKE_RULE"===e.rule.id));s(t)})).catch(a)}))}static addWordToDictionary(e,t){const r=this.getServerBaseUrl(t),n=r.endsWith("/")?"":"/",s=new URL(r+n+"words/add");if(t.user&&"token"in t.user)s.searchParams.set("username",t.user.email),s.searchParams.set("tokenV2",t.user.token);else{if(!t.user||!("password"in t.user))return Promise.reject(new Error("Not logged-in for adding words to dictionary"));s.searchParams.set("username",t.user.email),s.searchParams.set("password",t.user.password)}return s.searchParams.set("word",e.trim()),fetch(s.toString(),{method:"POST"}).then((e=>e.ok?Promise.resolve():Promise.reject(new Error(`Status: ${e.status}`))))}}Ut.NL_PREMIUM_RULES=["FAAG_VAAG","TOO_LONG_SENTENCE","_2_LEESTEKENS","WEEKEND","CASU_QUO","MOMENTEEL","SLECHTS","LEENWOORDEN","KOMMA_HOOR","RELEVANT","HINTS","CHECKEN","ALLEEN_BE","MACHTE","ECHTER","COMMUNICEREN","DESIGN","SANDAAL_ZANDAAL","N","MIDDELS","INTEGREREN","PRIMAIR","OVERIGENS","BETREFFENDE","AGENDA","ERGO","TEN_BEHOEVE","KOMMA_AANH","TM","IE","TER_ZAKE","SIGNIFICANT","GELIEVE","BEHOREN","NAAR_AANLEIDING_VAN","VAN_PLAN_ZIJN","HEDEN","TEN_DODE","VREEMD_VRZ_HIJ","DES","IMPACT","IMMER","BOVENSTAAND","XXXYJE","DUTCH_WRONG_WORD_IN_CONTEXT","LANCEREN","MET_BEHULP_VAN","PRIORITEIT","UWENTWEGE","CATEGORIE","CRITERIUM","GEMOTIVEERD"],Ut.PL_PREMIUM_RULES=["BOWIEM_ZAS","ZE_Z_SPOL","SPACJA_ZNAK_ROWNOSCI","BRAK_PRZECINKA_GDY","PYTANIE_CO","BRAK_PRZECINKA_JESLI","PRZECINEK_ANI","SKROTOWCE_BEZ_DYWIZU","NIEZGODNOSC_PRZYPADKU_PO_LICZEBNIKU","PODMIOT_ORZECZENIE","ROWNIE_JAK","JAK_I","PRZECINEK_POROWNANIE","WOLACZ_BEZ_PRZECINKA","ODNOSNIE_DO","GENERALNIE","BOWIEM_ZAS_PRZECINEK","WYDAWAC_SIE_BYC","POSIADAC_MIEC","PL_GUILLEMET","ITP_ITD","SPACJA_PROCENT","PO","W_TEMACIE","PL_DWA_WYRAZY","W_NAWIAZANIU_DO","WE_W","POKI_CO","VS","DZIEN_DZISIEJSZY","WIELOKROTNE_WYSTPIENIE_TEGO_SAMEGO_WYRAENIA_PRZYIMKOWEGO","I_LUB","PELNIC_ROLE","OKRES_CZASU","UZNAC_JAKO","EFEKT_KONCOWY","DLATEGO_PONIEWAZ","NA_DZIEN_DZISIEJSZY","DODATKOWO_CO_WIECEJ","OWY_W","DZIEN_JUTRZEJSZY","ADRES_ZAMIESZKANIA","W_CHWILI_OBECNEJ","BYC_ZNAJDOWAC_SIE_W_POSIADANIU","DO_TERAZ","PROTOKOL_Z_CZEGO","PO_NAJMNIEJSZEJ_LINII","POTRAFIACY","zarowno_jak_rowniez","GRAC_FAIR_PLAY","DRUGI_NAJWIEKSZY","COFAC_SIE_DO_TYLU","DZIEN_WCZORAJSZY","NA_PRZESTRZENI","IDENTYCZNY_JAK","ZA_WYJATKIEM","MAPA_DROGOWA","W_PRZECIGU_TYGODNIA_W_CIGU","NAPOTKAC_NA","PRZERWA_KAWOWA","WYSOKA_FREKWENCJA","UBRAC_ZALOZYC","PRZY_UDZIALE","W_SLAD_ZA","WYRAZIC_POPARCIE","W_TYM_WZGLEDZIE","PO_PIERWSZE_PRIMO","DOMYSLEC_SIE","WARTY","IDENTYCZNY_DO","W_DRODZE_WYJATKU","PRZEDKLADAC_WNIOSEK","POD_RZAD","PRZYJAZNY_DLA_UZYTKOWNIKA","NA_WSKUTEK","SWIECIC_SUKCESY","W_WEGRZECH","KONDYCJA_FINANSOWA","RULE_NIEMNIEJ","FORMULA_KREMU","PODDAWAC_W_WATPLIWOSC","OPATRZEC_SIE","ODGRYWAC_ZNACZENIE","INFORMACJE_WRAZLIWE","DO_DZIS_DZIEN","CO_I_RAZ","OKRAGLY_ROK","SZERSZE_INFORMACJE","WYSOKA_FORMA","CZEKAC_ZA","BYNAJMNIEJ","WYWIERAC_PIETNO","DOPATRZEC_SIE","ZLA_RENOMA","W_PELNYM_TEGO","W_KAZDYM_BADZ","KOSZTOWAC_TANIEJ","DYGITALNY"],Ut.SPELLING_RULES_ID=["SPELLER_RULE","MORFOLOGIK_RULE","HUNSPELL","SPELLING_RULE","ORTHOGRAPHY"],Ut.STYLE_ISSUE_TYPES=["style","locale-violation","register"],Ut.EMAIL_SIGNATURE_SEPARATOR_REGEXP=/^[‐|\-]{2,}|[‐|\-]{2,}$/,Ut.ONLY_NUMBERS_REGEXP=/^[0-9]+$/,Ut.COLON_WHITESPACE_REGEXP=/^[;:]\s/,Ut.ONE_LETTER_AT_END_REGEXP=/(\s|^|\()[a-z]\.?\s?$/i,Ut.NUMBER_WITH_DOT_AT_END_REGEXP=/\d\.?\s?$/,Ut.NUMBER_WITH_PARENTHESIS_AT_END_REGEXP=/\d\.?\)\s$/,Ut.PUNCTUATION_AT_END=/(\.|\!)$/,Ut.BULLET_POINT_REGEXP=/(\u25b6\ufe0e|\u25BA|\*|-|–|\u2606|\u2605|\u25cf|\u2022|\u25e6|\u27A4|\u2714)\s+$/,Ut.LOWERCASE_REGEXP=/[a-z]/,Ut.DOT_WITH_PREFIX_REGEXP=/\w\.$/,Ut.SLASH_AT_END_REGEXP=/(\/|\\)$/,Ut.AT_LEAST_TWO_LETTERS_AT_END_REGEXP=/[a-z]{2}$/i,Ut.SLASH_AT_BEGINNING_REGEXP=/^(\/|\\)/,Ut.QUOTE_AT_END_REGEXP=/[\"“”„]$/,Ut.QUOTE_AT_BEGINNING_REGEXP=/^[\"“”„]/,Ut.PUNCTUATION_AT_BEGINNING_REGEXP=/^\s?[\.\!\?,:…]/,Ut.PUNCTUATION_SPACE_AT_END_REGEXP=/[\.…\?\!]\s+/,Ut.MARKDOWN_HEADLINE_REGEXP=/^#{1,6}\s/m,Ut.MARKDOWN_INLINE_FORMAT_AT_BEGINNING_REGEXP=/^[\*\~\_\^\+\%\@]/m,Ut.WIKI_MARKUP_AT_END_REGEXP=/\[\[[a-z]+$/,Ut.PIPE_AT_END_REGEXP=/\|\s+$/,Ut.MENTION_SYMBOL_AT_BEGINNING_REGEXP=/@[a-z\.\-]*$/i,Ut.HASH_SYMBOL_AT_BEGINNING_REGEXP=/#[a-z\.\-]*$/i,Ut.EMOJI_SENTENCE_START_REGEXP=/(\.|!|\?|^)\s?(\u00a9|\u00ae|[\u2000-\u3300]|\ud83c[\ud000-\udfff]|\ud83d[\ud000-\udfff]|\ud83e[\ud000-\udfff])\s+/,Ut.ABBREVIATION_AT_END_REGEXP=/(\s|\(|^)[A-Z]\.$/,Ut.NET_AT_BEGINNING_REGEXP=/^net\b/i,Ut.SINGLE_UPPERCASE_LETTER_REGEXP=/^[A-Z]$/,Ut.NON_ALPHANUMERIC_AT_BEGINNING_REGEXP=/^[^a-z0-9äöüßáàâéèêíìîóòôúùû\.\?\!,\:\;¿¡]{1,3}/i,Ut.NON_ALPHANUMERIC_AT_END_REGEXP=/[^a-z0-9äöüßáàâéèêíìîóòôúùû\.\?\!,\:\;¿¡]{1,3}$/i,Ut.HTML_ENTITIES=["amp","nbsp","gt","lt","bull","euro","copy","laquo","raquo","hellip","middot"],Ut.HTML_ENTITIES_WITH_AND=Ut.HTML_ENTITIES.map((e=>`&${e}`)),Ut.WAVY_DASH_REGEXP=/^\u3030+$/,Ut.ZWS_REGEXP=/^\uFEFF+$/,Ut.ZWNJ_REGEXP=/\u200B|\u200C/g,Ut.ZWS="\ufeff",Ut.PREVENT_MID_SENTENCE_CAPITALIZATION=/[\wáàâóòìíéèùúâôîêûäöüß,\)][\u0020\u00A0\uFEFF]*\n\n\n?[\u0020\u00A0\uFEFF"„»«“‘]*$/,Ut.PREVENT_MID_SENTENCE_PUNCTUATION=/^[\u0020\u00A0\uFEFF]*\n\n\n?[a-záàâóòìíéèùúâôîêûäöüß,\)]/,Ut.COMMON_TLDS=["com","co","org","net","de","info","biz","es","fr","be","in","gov","nl","ca","com.br","br","at","us","au","ru","pl","ly","it","cat","edu","jp","ko","cn","se","no","mil","ch","dk","com.mx","mx","eu","co.uk","uk","ir","cz","ua","kr","gr","tw","nz","co.nz","za","ro","vn","io","tr","me","fi","tv","xyz","pt","ie","app"],Ut.COMMON_TLD_WITH_DOT_REGEXPS=Ut.COMMON_TLDS.map((e=>new RegExp(`^\\.${e.replace(".","\\.")}\\b`,"i"))),Ut.COMMON_FILE_TYPES=["jpeg","jpg","gif","png","bmp","indd","stl","svg","ai","sketch","ico","ics","env","amf","ps","psd","tiff","tif","mp3","wav","midi","mid","aif","mpa","ogg","wma","wpl","cda","7z","arj","deb","pkg","plist","rar","rpm","tar.gz","tar","zip","bin","dmg","iso","toast","vcd","csv","dat","db","log","mdb","sav","sql","xml","apk","bat","bin","cgi","com","exe","gadget","jar","py","js","jsx","json","wsf","ts","tsx","fnt","fon","otf","ttf","woff","woff2","rb","java","php","html","asp","aspx","cer","cfm","cgi","pl","css","scss","htm","jsp","part","rss","xhtml","key","odp","pps","ppt","pptx","class","cpp","cs","h","sh","swift","vb","ods","odt","xlr","xls","xlsx","xlt","xltx","bak","cab","cfg","cpl","cur","dll","dmp","msi","ini","tmp","3g2","3gp","avi","flv","h264","m4v","mkv","mov","mp4","mpg","mpeg","rm","swf","vob","wmv","doc","docx","dot","dotx","pdf","rtf","srx","text","tex","wks","wps","wpd","txt","yaml","yml","csl","md","adm"],Ut.COMMON_FILE_TYPE_WITH_DOT_REGEXPS=Ut.COMMON_FILE_TYPES.map((e=>new RegExp(`^[\\wáàâóòìíéèùúâôîêûäöüß\\-\\.\\(\\)]*?\\.${e}\\b`,"i"))),Ut.FILE_TYPE_AT_BEGINNING_REGEXP=new RegExp(`(${Ut.COMMON_FILE_TYPES.join("|")})\b`,"i"),Ut.HIGH_LEVEL_GOALS=[{id:"professional",tags:["clarity","confident","formal","general","positive","professional"]},{id:"scientific",tags:["academic","clarity","formal","general","objective","povrem","scientific"]},{id:"persuasive",tags:["clarity","confident","general","persuasive","positive"]},{id:"personal",tags:["clarity","general","informal","positive","povadd"]},{id:"creative",tags:["clarity","general"]}],Ut._textLevelAbortControllers=new Map,Ut._paragraphLevelAbortControllers=new Map,Ut._languageDetectionAbortControllers=new Map,Ut._useFallbackServerForTextLevelRequests=!1,Ut._useFallbackServerForParagraphLevelRequests=!1,Ut._useFallbackServerForLanguageDetection=!1,Ut._mainServerUnavailabilityTimeStamp=0,Ut._checkForException=e=>e.ok?e:e.text().catch((()=>"")).then((t=>{const r=t.toLowerCase();if(r.includes("too many error"))throw{reason:"TooManyErrors",status:e.status,response:t};if(413===e.status||r.includes("text exceeds the limit"))throw{reason:"TextTooLong",status:e.status,response:t};if(t.toLowerCase().includes("checking took longer than"))throw{reason:"TimeoutError",status:e.status,url:e.url?e.url.replace(/\?.*/,"?..."):"unknown",response:t};if(429===e.status)throw{reason:"TooManyRequests",status:e.status,response:t};if(403===e.status){if(r.includes("client request size limit")||r.includes("client request limit")||r.includes("ip request limit")||r.includes("ip request size limit"))throw{reason:"TooManyRequests",status:e.status,response:t};if(r.includes("authexception"))throw{reason:"InvalidCredentials",status:e.status,response:t};throw{reason:"AccessDenied",status:e.status,response:t}}if(r.includes("checking took longer than"))throw{reason:"TimeoutError",status:e.status,url:e.url?e.url.replace(/\?.*/,"?..."):"unknown",response:t};throw{reason:"UnknownError",status:e.status,response:t}}));
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class Mt{constructor(){this._eventHandlers=new Map}subscribe(e,t){this._eventHandlers.has(e)||this._eventHandlers.set(e,[]),this._eventHandlers.get(e).push(t)}unsubscribe(e,t){const r=this._eventHandlers.get(e)?.indexOf(t)??-1;r>-1&&(this._eventHandlers.get(e).splice(r,1),this._eventHandlers.get(e).length||this._eventHandlers.delete(e))}fire(e,t){const r=this._eventHandlers.get(e);r&&r.forEach((e=>{try{e(t)}catch(e){console.error(e)}}))}destroy(){this._eventHandlers.clear()}}
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class kt{static get LANGUAGES(){return this._languages||(this._languages=[{code:"ar",name:At.getMessage("ar")},{code:"ast-es",name:At.getMessage("ast")},{code:"be-by",name:At.getMessage("be")},{code:"br-fr",name:At.getMessage("br")},{code:"ca-es",name:At.getMessage("ca")},{code:"ca-es-valencia",name:At.getMessage("ca_ES_valencia")},{code:"da-dk",name:At.getMessage("da_DK")},{code:"de-at",name:At.getMessage("de_AT")},{code:"de-ch",name:At.getMessage("de_CH")},{code:"de-de",name:At.getMessage("de_DE")},{code:"el-gr",name:At.getMessage("el")},{code:"en-au",name:At.getMessage("en_AU")},{code:"en-ca",name:At.getMessage("en_CA")},{code:"en-gb",name:At.getMessage("en_GB")},{code:"en-nz",name:At.getMessage("en_NZ")},{code:"en-us",name:At.getMessage("en_US")},{code:"en-za",name:At.getMessage("en_ZA")},{code:"eo",name:At.getMessage("eo")},{code:"es",name:At.getMessage("es")},{code:"fa",name:At.getMessage("fa")},{code:"ga-ie",name:At.getMessage("ga")},{code:"fr",name:At.getMessage("fr")},{code:"gl-es",name:At.getMessage("gl")},{code:"it",name:At.getMessage("it")},{code:"ja-jp",name:At.getMessage("ja")},{code:"km-kh",name:At.getMessage("km")},{code:"nl",name:At.getMessage("nl")},{code:"no",name:At.getMessage("no")},{code:"pl-pl",name:At.getMessage("pl")},{code:"pt-ao",name:At.getMessage("pt_AO")},{code:"pt-br",name:At.getMessage("pt_BR")},{code:"pt-mz",name:At.getMessage("pt_MZ")},{code:"pt-pt",name:At.getMessage("pt_PT")},{code:"ro-ro",name:At.getMessage("ro")},{code:"ru-ru",name:At.getMessage("ru")},{code:"sk-sk",name:At.getMessage("sk")},{code:"sl-si",name:At.getMessage("sl")},{code:"sv",name:At.getMessage("sv")},{code:"ta-in",name:At.getMessage("ta")},{code:"tl-ph",name:At.getMessage("tl")},{code:"uk-ua",name:At.getMessage("uk")},{code:"zh-cn",name:At.getMessage("zh")}],this._languages.sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:0})),this._isSubscribed||(At.addEventListener(ft.eventNames.localeChanged,(()=>this._languages=null)),this._isSubscribed=!0)),this._languages}static isLanguageVariant(e){return e.code.includes("-")}static getPrimaryLanguageCode(e){return e.split("-")[0]}static formatLanguageCode(e){const t=e.split("-");return 1===t.length?t[0]:2===t.length?t[0]+"-"+t[1].toUpperCase():t[0]+"-"+t[1].toUpperCase()+"-"+t[2]}static getUserLanguageCode(){for(const e of navigator.languages){if(e.includes("-")&&e.startsWith(navigator.language))return e}return navigator.language}static getUserLanguageCodes(){const e=Array.from(navigator.languages,(e=>this.getPrimaryLanguageCode(e).toLowerCase()));try{e.push(this.getPrimaryLanguageCode(o.getUILanguageCode()).toLowerCase())}catch(e){}return y(e)}static getPreferredLanguageVariant(e){const t={"en-in":"en-us","en-ie":"en-gb"},r=navigator.languages||[];for(let n of r){n=n.toLowerCase(),n=t[n]||n;for(const t of e){const e=t.toLowerCase();if(n.length>2&&n===e)return t}}return null}static getLanguagesForGeoIPCountry(){return new Promise((function(e,t){let r=!1;const n=self.setTimeout((()=>{r=!0,t(new Error("geoip timeout"))}),15e3);fetch("https://languagetool.org/webextension/init",{method:"GET",mode:"cors"}).then((e=>e.json())).then((t=>{if(!r){const r=(t.geoIpCountry||"").toUpperCase();e({geoIpLanguages:t.geoIpLanguages||[],geoIpCountry:r}),clearTimeout(n)}})).catch((e=>{console.error(e),r||(t(e),clearTimeout(n))}))}))}static getSynonymsRequestLanguage(e){let t=this.getPrimaryLanguageCode(e);return"de-ch"===e.toLowerCase()?t="de-CH":"pt-br"===e.toLowerCase()&&(t="pt-BR"),Ke.includes(t)?t:null}}kt._languages=null,kt._isSubscribed=!1,kt.ALL_LANGUAGES=[{code:"af",name:"Afrikaans"},{code:"ak",name:"Akan"},{code:"am",name:"አማርኛ"},{code:"an",name:"aragonés"},{code:"ar",name:"عربي"},{code:"as",name:"অসমীয়া"},{code:"ast",name:"Asturianu"},{code:"be",name:"Беларуская"},{code:"bg",name:"Български"},{code:"bm",name:"Bamanankan"},{code:"bn",name:"বাংলা"},{code:"br",name:"Brezhoneg"},{code:"bs",name:"босански"},{code:"ca",name:"Català"},{code:"cs",name:"čeština"},{code:"cy",name:"Cymraeg"},{code:"da",name:"Dansk"},{code:"de",name:"Deutsch"},{code:"el",name:"Ελληνικά"},{code:"en",name:"English"},{code:"eo",name:"Esperanto"},{code:"es",name:"Español"},{code:"et",name:"Eesti keel"},{code:"eu",name:"Euskara"},{code:"fa",name:"فارسی"},{code:"fi",name:"suomi"},{code:"fj",name:"Vosa vaka-Viti"},{code:"fr",name:"Français"},{code:"ga",name:"Gaeilge"},{code:"gd",name:"Gàidhlig"},{code:"gl",name:"Galego"},{code:"gn",name:"Avañe'ẽ"},{code:"gu",name:"ગુજરાતી"},{code:"ha",name:"هَرْشَن هَوْسَ‎"},{code:"he",name:"עברית"},{code:"hi",name:"हिन्दी"},{code:"hr",name:"hrvatski"},{code:"hu",name:"magyar"},{code:"hy",name:"Հայերեն"},{code:"ia",name:"Interlingua"},{code:"id",name:"Bahasa Indonesia"},{code:"ig",name:"Ásụ̀sụ̀ Ìgbò"},{code:"is",name:"íslenska"},{code:"it",name:"Italiano"},{code:"ja",name:"日本語"},{code:"kk",name:"Қазақ"},{code:"km",name:"ខ្មែរ"},{code:"kn",name:"ಕನ್ನಡ"},{code:"ko",name:"한국어"},{code:"ku",name:"Kurdî"},{code:"ks",name:"كشمیری"},{code:"la",name:"Latina"},{code:"lg",name:"Luganda"},{code:"lo",name:"ພາສາລາວ"},{code:"lt",name:"Lietuvių"},{code:"lv",name:"Latviešu"},{code:"mg",name:"malagasy"},{code:"mi",name:"Māori"},{code:"ml",name:"മലയാളം"},{code:"mk",name:"Македонски"},{code:"mn",name:"Монгол"},{code:"mr",name:"मराठी"},{code:"ms",name:"Melayu"},{code:"my",name:"မြန်မာဘာသာ"},{code:"nb",name:"Norsk bokmål"},{code:"ne",name:"नेपाली"},{code:"nn",name:"Norsk nynorsk"},{code:"no",name:"Norsk"},{code:"nl",name:"Nederlands"},{code:"nr",name:"isiNdebele"},{code:"oc",name:"Occitano"},{code:"or",name:"ଓଡ଼ିଆ"},{code:"pa",name:"ਪੰਜਾਬੀ"},{code:"pl",name:"Polski"},{code:"ps",name:"پښتو"},{code:"pt",name:"Português"},{code:"rm",name:"rumantsch"},{code:"ro",name:"românesc"},{code:"ru",name:"Русский"},{code:"rw",name:"Ikinyarwanda"},{code:"sa",name:"संस्कृत"},{code:"si",name:"සිංහල"},{code:"sk",name:"slovenčina"},{code:"sl",name:"Slovenščina"},{code:"so",name:"Soomaali"},{code:"sr",name:"Српски"},{code:"ss",name:"siSwati"},{code:"st",name:"Sesotho"},{code:"sv",name:"Svenska"},{code:"ta",name:"தமிழ்"},{code:"te",name:"తెలుగు"},{code:"th",name:"ภาษาไทย"},{code:"tl",name:"Tagalog"},{code:"fil",name:"Filipino"},{code:"tr",name:"Türkçe"},{code:"ts",name:"Xitsonga"},{code:"tt",name:"Tatarça"},{code:"uk",name:"Українська"},{code:"ur",name:"اُردو"},{code:"uz",name:"Oʻzbek tili"},{code:"ve",name:"Tshivenḓa"},{code:"vi",name:"Tiếng Việt"},{code:"yo",name:"عِدعِ يوْرُبا"},{code:"zh",name:"中文"},{code:"zu",name:"isiZulu"}],kt.POPULAR_LANGUAGES=["de","en","es","fr","nl","pl","pt","ru","uk","zh","it","hi"];
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class Gt{static get DEFAULT_SETTINGS(){return null===this.DEFAULT_SETTINGS_CACHED&&(this.DEFAULT_SETTINGS_CACHED={apiServerUrl:le,autoCheck:!0,knownEmail:"",username:"",password:"",token:"",userId:null,dpaLevel:0,motherTongue:"",geoIpLanguages:[],geoIpCountry:"",preferredLanguages:[],forcePreferredLanguages:!1,enVariant:kt.getPreferredLanguageVariant(["en-US","en-GB","en-AU","en-CA","en-NZ","en-ZA"])||"en-US",deVariant:kt.getPreferredLanguageVariant(["de-DE","de-AT","de-CH"])||"de-DE",ptVariant:kt.getPreferredLanguageVariant(["pt-PT","pt-BR","pt-MZ","pt-AO"])||"pt-BR",caVariant:"ca-ES",dictionary:[],hasSynonymsEnabled:!1,hasPickyModeEnabledGlobally:!1,openCardHotkey:"",isDictionarySynced:!1,ignoredRules:[],disabledDomains:[],disabledEditorGroups:[],ignoreCheckOnDomains:[],disableSentenceSuggestionOnDomains:[],autoCheckOnDomains:[],remainingRephrasingsAmount:null,remainingRephrasingsDate:null,hasRephrasingEnabled:!0,hasContextMenuOptionEnabled:!0,hasLollipopEnabled:!1}),this.DEFAULT_SETTINGS_CACHED}static _combineObjects(e,t){const r=b(e);for(const e in r)t.hasOwnProperty(e)&&(r[e]=t[e]);return r}static _dec2hex(e){return("0"+e.toString(16)).substr(-2)}static _generateUniqueId(){const e=new Uint8Array(8);return crypto.getRandomValues(e),Array.from(e,Gt._dec2hex).join("")}static _isListContainsDomain(e,t){return M(e,t)}static getDefaultSettings(){return b(Gt.DEFAULT_SETTINGS)}static getDefaultPrivacySettings(){return O(Gt.DEFAULT_PRIVACY_SETTINGS)}constructor(){this._eventBus=new Mt,this._onReadyCallbacks=[]}addEventListener(e,t){this._eventBus.subscribe(e,t)}removeEventListener(e,t){this._eventBus.unsubscribe(e,t)}disableDomain(e){const t=U(e),r=this.getSettings(),n="object"==typeof r.disabledDomains?r.disabledDomains:[];return n.push(t),this.updateSettings({disabledDomains:n})}enableDomain(e){const t=U(e),r=this.getSettings();let n="object"==typeof r.disabledDomains?r.disabledDomains:[];return n=n.filter((e=>{const r=U(e);return r!==t&&!t.endsWith("."+r)})),this.updateSettings({disabledDomains:n})}addToDomainSettings(e,t){const r=U(e),n=this.getSettings()[t]||[];return n.push(r),this.updateSettings({[t]:y(n)})}removeFromDomainSettings(e,t){const r=U(e);let n=this.getSettings()[t]||[];return n=n.filter((e=>{const t=U(e);return t!==r&&!r.endsWith("."+t)})),this.updateSettings({[t]:n})}disableEditorGroup(e,t){const r=U(e),n=this.getSettings(),s="object"==typeof n.disabledEditorGroups?n.disabledEditorGroups:[];return s.push({domain:r,editorGroupId:t}),this.updateSettings({disabledEditorGroups:s})}enableEditorGroup(e,t){const r=U(e),n=this.getSettings();let s="object"==typeof n.disabledEditorGroups?n.disabledEditorGroups:[];const a=s.filter((e=>!(e.domain===r&&e.editorGroupId===t)));return a.length!==s.length?this.updateSettings({disabledEditorGroups:a}):Promise.resolve()}enableDomainAndEditorGroup(e,t){return this.getCheckSettings(e,t).isEditorGroupDisabled&&this.enableEditorGroup(e,t),this.enableDomain(e)}grantUnlimitedRephrasings(){return this.updateSettings({remainingRephrasingsAmount:null,remainingRephrasingsDate:null})}restrictRephrasings(){const{remainingRephrasingsAmount:e,remainingRephrasingsDate:t}=this.getSettings();return this.updateSettings({remainingRephrasingsAmount:e??at,remainingRephrasingsDate:t||(new Date).toISOString()})}enablePaidSubscription(){return this.updateUIState({hasPaidSubscription:!0})}disablePaidSubscription(){return this.updateUIState({hasPaidSubscription:!1})}getIgnoredRuleIds(){return this.getManagedSettings().disableIgnoredRules?[]:this.getSettings().ignoredRules.map((e=>e.id))}hasIgnoredRule(e){return this.getIgnoredRuleIds().includes(e)}addIgnoredRule(e){const{ignoredRules:t}=this.getSettings();this.hasIgnoredRule(e.id)||this.updateSettings({ignoredRules:[...t,e]})}async removeIgnoredRule(e){if(this.hasIgnoredRule(e)){const t=this.getSettings().ignoredRules.filter((t=>t.id!==e));await this.updateSettings({ignoredRules:t})}}destroy(){this._eventBus.destroy(),this._onReadyCallbacks=[]}}Gt.eventNames={settingsChanged:"lt-storageController.settingsChanged",userCredentialsChanged:"lt-storageController.userCredentialsChanged",configurationChanged:"lt-storageController.configurationChanged",privacySettingsChanged:"lt-storageController.privacySettingsChanged",uiStateChanged:"lt-storageController.uiStateChanged"},Gt.DEFAULT_SETTINGS_CACHED=null,Gt.DEFAULT_MANAGED_SETTINGS={apiServerUrl:"",loginUrl:"",disablePrivacyConfirmation:!1,disablePersonalDictionary:!1,disableIgnoredRules:!1,disableOpenInEditor:!1,allowedURLs:[]},Gt.DEFAULT_REMOTE_CONFIGURATION={unsupportedDomains:[]},Gt.DEFAULT_PRIVACY_SETTINGS={allowRemoteCheck:!1,confirmedGPT3:!1,hasStatisticsCollectionEnabled:!0,hasMLDataCollectionEnabled:!0},Gt.DEFAULT_STATISTICS={usageCount:0,sessionCount:0,appliedSuggestions:0,appliedSynonyms:0,hiddenErrors:[],firstVisit:null,lastActivity:null,ratingValue:null,premiumClicks:0,campaign:null,lastPing:null},Gt.DEFAULT_UI_STATE={hasSeenPrivacyConfirmationDialog:!1,hasPaidSubscription:!1,hasRated:!1,hasUsedValidator:!1,hasSeenOnboarding:!1,isNewUser:!1,hasSeenNewOverleafTeaser:!1,hasSeenNewGoogleDocsTeaser:!1,hasSeenNewGoogleSlidesTeaser:!1,hasSeenDesktopAppTeaser:!1,hasSeenGoogleDocsMenuBarHint:!1,lastChangelogNov2023Seen:null,changelogNov2023CountdownEnd:null,changelogNov2023Coupon:null,showRuleId:!1,dialogPosition:"default",countMode:"characters",hasSeenTurnOnMessagePopup:!1,isDarkModeEnabled:!1},Gt.DEFAULT_TEST_FLAGS={testGroups:{}};class Ft{static init(e){this._instanceCtor=e}static create(){return this._instanceCtor()}}
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class Bt extends Gt{static _getStringSize(...e){let t=0;for(const r of e)for(let e=0;e<r.length;e++){const n=r.charCodeAt(e);t+=n<128?1:n<2048?2:n<65536?3:n<1<<21?4:n<1<<26?5:n<1<<31?6:Number.NaN}return t}static _getStorage(){const e=pt();return e.storage.sync&&!a.isFirefox()?e.storage.sync:e.storage.local}static _getManagedStorage(){return pt().storage.managed}constructor(){super(),this._onStoredDataChanged=(e,t)=>{const r=["username","token"].filter((t=>e.hasOwnProperty(t)&&e[t].oldValue!==e[t].newValue)),n=[],s=[];for(const e of Bt.SETTINGS_CHUNKED_PROPERTIES)n.push(!1),s.push(new RegExp(`^${e}(_\\d+)?$`));let a=!1,i=!1,o=!1,c=!1;for(const r in e)if("managed"!==t){for(let e=0;e<Bt.SETTINGS_CHUNKED_PROPERTIES.length;e++)if(s[e].test(r)){n[e]=!0;break}if(this._settings&&Gt.DEFAULT_SETTINGS.hasOwnProperty(r)&&!Bt.SETTINGS_CHUNKED_PROPERTIES.includes(r)){const t=!("oldValue"in e[r])&&Gt.DEFAULT_SETTINGS[r]===e[r].newValue,n=e[r].oldValue!==e[r].newValue;this._settings[r]=e[r].newValue,a=!1===t&&n}this._configuration&&Gt.DEFAULT_REMOTE_CONFIGURATION.hasOwnProperty(r)&&(this._configuration[r]=e[r].newValue,i=!0),this._privacySettings&&Gt.DEFAULT_PRIVACY_SETTINGS.hasOwnProperty(r)&&(this._privacySettings[r]=e[r].newValue,o=!0),this._statistics&&Gt.DEFAULT_STATISTICS.hasOwnProperty(r)&&(this._statistics[r]=e[r].newValue),this._uiState&&Gt.DEFAULT_UI_STATE.hasOwnProperty(r)&&(this._uiState[r]=e[r].newValue,c=!0),this._testFlags&&Gt.DEFAULT_TEST_FLAGS.hasOwnProperty(r)&&(this._testFlags[r]=e[r].newValue),"uniqueId"===r&&(this._uniqueId=e[r].newValue)}else this._managedSettings&&Gt.DEFAULT_MANAGED_SETTINGS.hasOwnProperty(r)&&(this._managedSettings[r]=e[r].newValue);a&&(this._ensureIgnoredRuleTurnOffDate(),this._eventBus.fire(Gt.eventNames.settingsChanged,e)),r.length&&this._eventBus.fire(Gt.eventNames.userCredentialsChanged,r.reduce(((t,r)=>({...t,[r]:e[r]})),{})),n.some((e=>e))&&this._storage.get().then((e=>{if(!this._settings)return;const t={};for(let r=0;r<Bt.SETTINGS_CHUNKED_PROPERTIES.length;r++)if(n[r]){const n=Bt.SETTINGS_CHUNKED_PROPERTIES[r],s=this._joinChunks(e,n);t[n]={oldValue:this._settings[n],newValue:s},this._settings[n]=s}this._ensureIgnoredRuleTurnOffDate(),this._eventBus.fire(Gt.eventNames.settingsChanged,t)})),i&&this._eventBus.fire(Gt.eventNames.configurationChanged,e),o&&this._eventBus.fire(Gt.eventNames.privacySettingsChanged,e),c&&this._eventBus.fire(Gt.eventNames.uiStateChanged,e)},this._storage=Bt._getStorage(),this._managedStorage=Bt._getManagedStorage(),this._isInitialized=!1,this._loadData(),pt().storage.onChanged.addListener(this._onStoredDataChanged)}_splitInChunks(e,t,r=this._storage.QUOTA_BYTES_PER_ITEM){let n=e[t];if(!n)return;let s=0,a=[],i=Bt._getStringSize(t,"[]");for(;n.length;){const o=n.shift(),c=JSON.stringify(o),l=Bt._getStringSize(`,${c}`);if(i+l<=r)a.push(o),i+=l;else{e[0===s?t:`${t}_${s}`]=a,s++,a=[o],i=Bt._getStringSize(`${t}_${s}`,`[${c}]`)}if(0===n.length){e[0===s?t:`${t}_${s}`]=a}}e[`${t}_${s+1}`]=[]}_joinChunks(e,t,r=this._storage.MAX_ITEMS){let n=e[t]||[];for(let s=1;s<r;s++){const r=e[`${t}_${s}`];if(void 0===r||0===r.length)break;n=n.concat(r)}return n}_loadData(){const e=this._storage.get().then((e=>{const t=Gt._combineObjects(Gt.DEFAULT_SETTINGS,e);for(const r of Bt.SETTINGS_CHUNKED_PROPERTIES)t[r]=this._joinChunks(e,r);for(const e of t.ignoredRules){if(void 0===e.description){const t=Gt.DEFAULT_SETTINGS.ignoredRules.find((t=>t.id===e.id&&t.language===e.language));e.description=t?t.description:""}if(void 0===e.turnOffDate){const t=Gt.DEFAULT_SETTINGS.ignoredRules.some((t=>t.id===e.id&&t.language===e.language));e.turnOffDate=t?null:new Date(2019,9,1)}else null!==e.turnOffDate&&(e.turnOffDate=new Date(e.turnOffDate))}t.disabledDomains=t.disabledDomains.map((e=>x(e,""))).filter((e=>e)),t.ignoreCheckOnDomains=t.ignoreCheckOnDomains.map((e=>x(e,""))).filter((e=>e)),t.autoCheckOnDomains=t.autoCheckOnDomains.map((e=>x(e,""))).filter((e=>e)),this._settings=t,this._configuration=Gt._combineObjects(Gt.DEFAULT_REMOTE_CONFIGURATION,e),this._privacySettings=Gt._combineObjects(Gt.DEFAULT_PRIVACY_SETTINGS,e),this._statistics=Gt._combineObjects(Gt.DEFAULT_STATISTICS,e),this._uiState=Gt._combineObjects(Gt.DEFAULT_UI_STATE,e),this._testFlags=Gt._combineObjects(Gt.DEFAULT_TEST_FLAGS,e),e.uniqueId?this._uniqueId=e.uniqueId:(this._uniqueId=Gt._generateUniqueId(),this._storage.set({uniqueId:this._uniqueId})),this._statistics.firstVisit||this.updateStatistics({firstVisit:Math.round(Date.now()/1e3)})})),t=this._managedStorage.get().then((e=>{this._managedSettings=Gt._combineObjects(Gt.DEFAULT_MANAGED_SETTINGS,e)})).catch((()=>{this._managedSettings=Gt._combineObjects(Gt.DEFAULT_MANAGED_SETTINGS,{})}));Promise.all([e,t]).then((()=>{this._isInitialized=!0,this._onReadyCallbacks.forEach((e=>e(this))),this._onReadyCallbacks=[]}))}_ensureIgnoredRuleTurnOffDate(){if(this._settings)for(const e of this._settings.ignoredRules)e.turnOffDate&&"string"==typeof e.turnOffDate&&(e.turnOffDate=new Date(e.turnOffDate))}isReady(){return this._isInitialized}onReady(e){this._isInitialized?e(this):this._onReadyCallbacks.push(e)}getUniqueId(){return this._uniqueId}getSettings(){return b(this._settings)}updateSettings(e){for(const t in e)if(!Gt.DEFAULT_SETTINGS.hasOwnProperty(t))throw new Error(`Unknown setting ${t}`);if(Object.assign(this._settings||{},b(e)),void 0!==e.ignoredRules)for(const t of e.ignoredRules)t.turnOffDate&&"string"!=typeof t.turnOffDate&&(t.turnOffDate=t.turnOffDate.toISOString());if(!a.isFirefox()&&!a.isThunderbird()&&!a.isSafari()){e=b(e);for(let t=0;t<Bt.SETTINGS_CHUNKED_PROPERTIES.length;t++){const r=Bt.SETTINGS_CHUNKED_PROPERTIES[t];void 0!==e[r]&&this._splitInChunks(e,r)}}return this._storage.set(e)}getCheckSettings(e,t){if(!this._settings)return{isDomainDisabled:!1,isEditorGroupDisabled:!1,isAutoCheckEnabled:!0};if(e===pt().runtime.id)return{isDomainDisabled:!1,isEditorGroupDisabled:!1,isAutoCheckEnabled:!0};const r=(this._settings.disabledEditorGroups||[]).some((r=>U(r.domain)===U(e)&&r.editorGroupId===t)),n=Gt._isListContainsDomain(this._settings.disabledDomains,e),s=(a=this._managedSettings?.allowedURLs||[]).length>0&&a.every((e=>Lt(e)));var a;if(this._settings.autoCheck&&!s){return{isDomainDisabled:n,isEditorGroupDisabled:r,isAutoCheckEnabled:!Gt._isListContainsDomain(this._settings.ignoreCheckOnDomains,e)}}return{isDomainDisabled:n,isEditorGroupDisabled:r,isAutoCheckEnabled:Gt._isListContainsDomain([...this._settings.autoCheckOnDomains,...vt(this._managedSettings?.allowedURLs||[])],e)}}hasLanguageToolAccount(){return Boolean(this._settings&&this._settings.username&&!this.hasCustomServer())}hasCustomServer(){return this._managedSettings&&this._managedSettings.apiServerUrl?this._managedSettings.apiServerUrl!==Gt.DEFAULT_SETTINGS.apiServerUrl:Boolean(this._settings&&this._settings.apiServerUrl&&this._settings.apiServerUrl.trim()&&this._settings.apiServerUrl!==le&&this._settings.apiServerUrl!==ge)}getCustomServerUrl(){if(this.hasCustomServer())return this._managedSettings.apiServerUrl||this._settings.apiServerUrl}getManagedSettings(){return O(this._managedSettings)}getConfiguration(){return O(this._configuration)}updateRemoteConfiguration(e){for(const t in e)if(!Gt.DEFAULT_REMOTE_CONFIGURATION.hasOwnProperty(t))throw new Error(`Unknown configuration ${t}`);return this._configuration&&this._isInitialized&&!this._hasAnythingChanged(this._configuration,e)?Promise.resolve():(Object.assign(this._configuration||{},O(e)),this._storage.set(e))}isDomainSupported(e){return!this._configuration||!this._configuration.unsupportedDomains.includes("*")&&!Gt._isListContainsDomain(this._configuration.unsupportedDomains,e)}isDomainExcludedByGroupPolicy(e){const t=wt(this._managedSettings?.allowedURLs||[]);return!!t.length&&!1===M(t,e)}getPrivacySettings(){return O(this._privacySettings)}updatePrivacySettings(e){for(const t in e)if(!Gt.DEFAULT_PRIVACY_SETTINGS.hasOwnProperty(t))throw new Error(`Unknown privacy setting ${t}`);return this._privacySettings&&this._isInitialized&&!this._hasAnythingChanged(this._privacySettings,e)?Promise.resolve():(Object.assign(this._privacySettings||{},e),this._storage.set(e))}getStatistics(){return b(this._statistics)}updateStatistics(e){for(const t in e)if(!Gt.DEFAULT_STATISTICS.hasOwnProperty(t))throw new Error(`Unknown privacy setting ${t}`);return this._statistics&&this._isInitialized&&!this._hasAnythingChanged(this._statistics,e)?Promise.resolve():(Object.assign(this._statistics||{},e),this._storage.set(e))}getUIState(){return b(this._uiState)}updateUIState(e){for(const t in e)if(!Gt.DEFAULT_UI_STATE.hasOwnProperty(t))throw new Error(`Unknown UI state ${t}`);return this._uiState&&this._isInitialized&&!this._hasAnythingChanged(this._uiState,e)?Promise.resolve():(Object.assign(this._uiState||{},e),this._storage.set(e))}_hasAnythingChanged(e,t){let r=!1;for(let n in t)if(t.hasOwnProperty(n)&&(t[n]!==e[n]||"object"==typeof t[n])){r=!0;break}return r}checkForPaidSubscription(){return new Promise(((e,t)=>{this.onReady((()=>{const{username:r,password:n,token:s}=this.getSettings();let a;this.hasCustomServer()&&(a=this.getCustomServerUrl()),Ut.checkForPaidSubscription(r,n,s,a).then((t=>{t?(this.enablePaidSubscription(),this.grantUnlimitedRephrasings()):(this.disablePaidSubscription(),this.restrictRephrasings()),e(t)})).catch(t)}))}))}getTestFlags(){return O(this._testFlags)}updateTestFlags(e){for(const t in e)if(!Gt.DEFAULT_TEST_FLAGS.hasOwnProperty(t))throw new Error(`Unknown test flag ${t}`);return Object.assign(this._testFlags||{},e),this._storage.set(e)}getActiveCoupon(){const{changelogNov2023CountdownEnd:e,changelogNov2023Coupon:t,hasPaidSubscription:r}=this.getUIState();if(r)return null;if(e&&t&&Date.now()<e){const r=20,{geoIpCountry:n}=this.getSettings(),s=this._getDefaultCoupon(n);return 20===s?.percent?{code:"2023-NOV-CHANGELOG-SOUTH-EUROPE",expires:e,percent:33}:s&&s.percent>r?{...s,expires:e}:{code:t,expires:e,percent:r}}return null}_getDefaultCoupon(e){for(const t in qe)if(qe.hasOwnProperty(t)&&qe[t].countries.includes(e))return{code:t,percent:qe[t].percent};return null}isRelevantForChangelogCoupon(){if(this.hasCustomServer())return{status:!1,reason:1};const{hasPaidSubscription:e}=this.getUIState();if(e)return{status:!1,reason:3};let{firstVisit:t}=this.getStatistics();if(!t)return{status:!1,reason:4};t*=1e3;return Date.now()-t<6048e5?{status:!1,reason:5}:{status:!0}}startChangelogCoupon(){if(!this.canStartChangelogCoupon())return;const e=Date.now();var t,r;this.updateUIState({changelogNov2023Coupon:"2023-NOV-CHANGELOG",changelogNov2023CountdownEnd:e+1656e5+(t=0,r=72e5,t=Math.ceil(t),r=Math.floor(r),Math.floor(Math.random()*(r-t+1))+t)})}isChangelogCouponRunning(){if(!this.isRelevantForChangelogCoupon().status)return!1;const{changelogNov2023CountdownEnd:e}=this.getUIState();return Boolean(e&&e>Date.now())}canStartChangelogCoupon(){if(!this.isRelevantForChangelogCoupon().status)return!1;const e=Date.now(),{changelogNov2023CountdownEnd:t}=this.getUIState();return!t||e-t>ze}destroy(){this._isInitialized=!1,super.destroy();try{pt().storage.onChanged.removeListener(this._onStoredDataChanged)}catch(e){}}}Bt.SETTINGS_CHUNKED_PROPERTIES=["dictionary","ignoredRules","disabledDomains","disabledEditorGroups","ignoreCheckOnDomains","autoCheckOnDomains"];class Ht{static getOrCreateShadow(e){let t=document.querySelector("lt-container");if(t||(t=document.createElement("lt-container"),document.documentElement.appendChild(t)),!t.shadowRoot)try{t.attachShadow({mode:"open"})}catch(e){}let r=t.shadowRoot.querySelector("slot");return r||(r=document.createElement("slot"),t.shadowRoot.append(r)),Rt(t.shadowRoot),{root:t.shadowRoot,slot:r}}static isComposer(e){return function(e){return location.href.startsWith("about:blank?compose")&&"BODY"===e.tagName&&"on"===document.designMode}(e)}static registerComposeScripts(){const e=pt(),t=e.composeScripts;if(t){const r=[],n=[],s=e.runtime.getURL("");e.runtime.getManifest().content_scripts.forEach((e=>{e.js&&e.js.forEach((e=>{r.push({file:e.replace(s,"")})})),e.css&&e.css.forEach((e=>{n.push({file:e.replace(s,"")})}))})),t.register({css:n,js:r})}}static setNativeSpellCheck(e){const t=pt().spellcheck;t&&t.setValue(e)}}Ht.COMPOSE_URL="about:blank?compose",Ht.COMPOSE_URL_REGEXP=/^about:blank\?compose/;const Wt=class{static init(e){this._instance=e,e.initialize()}static initialize(){this._instance.initialize()}static trackPageView(e,t){this._instance.trackPageView(e,t)}static trackDisabledRule(e,t,r,n){return this._instance.trackDisabledRule(e,t,r,n)}static trackDictionaryEvent(e,t,r){return this._instance.trackDictionaryEvent(e,t,r)}static trackEvent(e,t,r,n,s){this._instance.trackEvent(e,t,r,n,s)}static trackInstall(){this._instance.trackInstall()}static trackActivity(){this._instance.trackActivity()}static trackActiveAfterOneWeek(){return this._instance.trackActiveAfterOneWeek()}static trackUserActivity(){this._instance.trackUserActivity()}static trackError(e,t,r){this._instance.trackError(e,t,r)}static trackStat(e,t){this._instance.trackStat(e,t)}static trackTextLength(e){this._instance.trackTextLength(e)}};
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class Vt{static init(){this._isInitialized||(this._storageController=Ft.create(),this._startSync(),this._isInitialized=!0)}static _startSync(){this._storageController.onReady((()=>{if(!this._isSyncCapable())return;const{isDictionarySynced:e}=this._storageController.getSettings();e?this.downloadAll():this.checkForInitialSync()}))}static _isSyncCapable(){if(!this._storageController.isReady())return!1;if("extension"!==o.getType())return!1;if(this._storageController.hasCustomServer())return!1;const{username:e,password:t,token:r}=this._storageController.getSettings();return e&&(t||r)}static disableSync(){return this._storageController.updateSettings({isDictionarySynced:!1})}static checkForInitialSync(){this._storageController.onReady((()=>{const{isDictionarySynced:e,dictionary:t}=this._storageController.getSettings();if(e)return;if(!this._isSyncCapable())return;Wt.trackEvent("Action","dict_sync:started");const r=t.slice(0),n=t.length;this.addBatch(r).then((()=>this.downloadList())).then((e=>{const t=e.filter((e=>r.includes(e))).length,s=t/n;s<.9&&n-t>=10?Wt.trackEvent("Action","dict_sync:failed_comparison",String(s)):this._storageController.updateSettings({isDictionarySynced:!0,dictionary:e}).then((()=>{Wt.trackEvent("Action","dict_sync:succeeded")})).catch((()=>{Wt.trackEvent("Action","dict_sync:failed_storage")}))})).catch((()=>{Wt.trackEvent("Action","dict_sync:failed_sync")}))}))}static addBatch(e){if(this._syncing)return Promise.reject();if(!this._isSyncCapable())return Promise.reject();if(e.length>this.MAX_WORDS)return Wt.trackEvent("Action","too_many_words_for_dictionary_batch_add",String(e.length)),Promise.reject();this._syncing=!0;const t=this._chunkBatches(e);let r=0;return new Promise(((e,n)=>{const s=()=>{const a=t.shift();if(!a?.length&&!t.length)return this._syncing=!1,void e();const i=this._filterValidWords(a);i.length?this.addWord(i).then((()=>St(1400))).then(s).catch((e=>++r>4?(this._syncing=!1,void n(e)):s())):s()};s()}))}static _filterValidWords(e){return(Array.isArray(e)?e:[e]).filter((e=>Boolean(e?.trim()&&!e.trim().match(/\s/)&&!e.match(this.EMOJI_REGEXP))))}static _chunkBatches(e){const t=[],r=e.slice(0,this.MAX_WORDS);let n;for(;(n=r.splice(0,this.BATCH_SIZE))&&n.length>0;)t.push(n);return t}static removeBatch(e){return this._deleting?Promise.reject():this._isSyncCapable()?(Wt.trackEvent("Action","dict_batch_delete:started",String(e.length)),e=e.slice(0,this.MAX_WORDS),this._deleting=!0,new Promise(((t,r)=>{const n=()=>{if(void 0===e.shift()&&!e.length)return this._deleting=!1,Wt.trackEvent("Action","dict_batch_delete:succeeded"),void t();const s=this._filterValidWords(e);s.length?this.removeWord(s).then((()=>St(1500))).then(n).catch((e=>{this._deleting=!1,Wt.trackEvent("Action","dict_batch_delete:failed",e&&e.message),r(e)})):n()};n()}))):Promise.reject()}static downloadAll(){this._deleting||this._storageController.onReady((()=>{if(!this._isSyncCapable())return;const{isDictionarySynced:e}=this._storageController.getSettings();e&&this.downloadList().then((e=>{this._storageController.updateSettings({dictionary:e})})).catch((()=>null))}))}static _getBaseUrl(){const e=new URL("/enterprise/v1/dictionary/words",ge);return e.searchParams.append("type","personal"),e}static _getHeaders(){const{username:e,token:t}=this._storageController.getSettings(),r=new Headers;if(!e||!t)return[r,new Error("User must be authenticated for interacting with the dictionary")];{const n=btoa(`${e}:${t}`);r.append("Authorization",`Basic ${n}`),r.append("Content-Type","application/json")}return[r,null]}static addWord(e,t=!1){const r=this._getBaseUrl(),[n,s]=this._getHeaders(),a=(Array.isArray(e)?e:[e]).map((e=>e.trim()));return s?Promise.reject(s):fetch(r.toString(),{method:"POST",body:JSON.stringify({words:a}),headers:n}).then((e=>e.ok?Promise.resolve():Promise.reject(new Error(`Status: ${e.status}`)))).catch((r=>t?(Wt.trackEvent("Action","dict_sync_add:failed",a.slice(0,3).concat(["…"]).join(",")),Promise.reject(r)):St(5e3).then((()=>this.addWord(e,!0)))))}static removeWord(e,t=!1){const r=this._getBaseUrl(),[n,s]=this._getHeaders(),a=(Array.isArray(e)?e:[e]).map((e=>e.trim()));return s?Promise.reject(s):fetch(r.toString(),{method:"DELETE",body:JSON.stringify({words:a}),headers:n}).then((e=>e.ok?Promise.resolve():Promise.reject(new Error(`Status: ${e.status}`)))).catch((r=>t?(Wt.trackEvent("Action","dict_sync_remove:failed",a.slice(0,3).concat(["…"]).join(",")),Promise.reject(r)):St(5e3).then((()=>this.removeWord(e,!0)))))}static downloadList(){let e=this._getBaseUrl();const[t,r]=this._getHeaders();return r?Promise.reject(r):(e.searchParams.append("limit",String(2e3)),fetch(e.toString(),{method:"GET",headers:t}).then((e=>e.ok?e.json():Promise.reject(new Error(`[${e.status}] Download request failed`)))).then((e=>Array.isArray(e?.words)?Promise.resolve(e.words.filter((e=>"string"==typeof e))):Promise.reject(new Error("Empty response while loading dictionary")))).catch((e=>(Wt.trackEvent("Action","dict_download:failed",e&&e.message),Promise.reject(e)))))}}Vt.MAX_WORDS=5e3,Vt.BATCH_SIZE=250,Vt._isInitialized=!1,Vt._syncing=!1,Vt._deleting=!1,Vt.EMOJI_REGEXP=/\u00a9|\u00ae|[\u2000-\u3300]|\ud83c[\ud000-\udfff]|\ud83d[\ud000-\udfff]|\ud83e[\ud000-\udfff]/;const Yt={accept:"application/json","content-type":"application/json"};let jt="claudia";function Xt(e){return"object"==typeof e&&null!==e&&"string"==typeof e.text&&("number"==typeof(t=e.score)||"object"==typeof t&&null!==t&&!1===Object.values(t).some((e=>"number"!=typeof e)))&&"string"==typeof e.label&&"string"==typeof e.origin&&"string"==typeof e.uuid;var t}async function $t(){const t=function(){const t=(typeof e).indexOf("o")>-1;return jt=t?tt:jt,("__"+jt+"::"+~~(+new Date/1e3)).substring(2,64)}();return await async function(e){const t=(new TextEncoder).encode(e),r=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(r)).map((e=>e.toString(16).padStart(2,"0"))).join("")}(t)}class Zt{static async load(e,t,r,n,s){const a=this._rewriteCache.get(t.trim()),i=this._history.get(t)??null;if(a)return Promise.resolve({rephrases:a,previousSentence:i});const o=(await this._request("rewrite","/rewriting/rewrite",e,t,r,n,s)).filter((e=>Xt(e))).map((({text:e,score:t,label:r,origin:n,uuid:s})=>({text:e,score:t,label:r,origin:n,uuid:s}))).filter((({text:e},t,r)=>r.findIndex((({text:t})=>e===t))===t));return o.length>0&&this._rewriteCache.set(t.trim(),o),{rephrases:o,previousSentence:i}}static async report(e,t){this.abort("report"),"string"==typeof t.chosenSentence&&this._history.set(t.chosenSentence,t.originalSentence);const r=new AbortController,n=JSON.stringify({...t,uuid:e}),s=this._abortControllers.get("report")||[];s.push(r),this._abortControllers.set("report",s);try{return await fetch(`${fe}/rewriting/report`,{method:"post",signal:r.signal,mode:"cors",headers:Yt,body:JSON.stringify({data:n})}),!0}catch{return!1}}static abort(e){const t=void 0===e?["report","rewrite"]:[e];for(const e of t){const t=this._abortControllers.get(e)||[];this._abortCurrentRequests(t),this._abortControllers.set(e,[])}}static async _request(e,t,r,n,s,a,i){this.abort(e);const o=JSON.stringify({text:n,offset:0,length:0,count:"rewrite"===e?5:1,userID:r,language:s.slice(0,2),inhouseOnly:a,email:i?.email,token:i?.token,p:i?.isPremium}),c=new AbortController,l=this._abortControllers.get(e)||[];Yt["X-LT-checksum"]=await $t(),i?.isPremium&&(Yt["X-LT-p"]="1"),l.push(c),this._abortControllers.set(e,l);const u=await fetch(ce+t,{method:"post",signal:c.signal,mode:"cors",headers:Yt,body:o});if(!1===u.ok){const e=(()=>{switch(u.status){case 413:return"PayloadTooLarge";case 524:return"ServerTimeout";default:return`ServerFailure (${u.status})`}})();throw new Error(e)}const g=await u.json(),{rewrites:d=[]}=g||{};return d}static async requestSplitSentence(e,t,r,n,s){const a=this._splitSentenceCache.get(t.trim());if(a)return Promise.resolve(a);const[i]=await this._request("sentence-splitting","/rewriting/rewrite/sentence_splitting",e,t,r,n,s);return Xt(i)?(this._splitSentenceCache.set(t.trim(),i),i):null}static _abortCurrentRequests(e){for(const t of e)t.abort()}}Zt._rewriteCache=new Map,Zt._splitSentenceCache=new Map,Zt._history=new Map,Zt._abortControllers=new Map([["rewrite",[]],["report",[]],["sentence-splitting",[]]]);
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class Kt{static load(e,t,r){return-1===Ke.indexOf(t)?Promise.reject(new Error("Sorry, synonyms are not supported in this language.")):this._request(e,t,r)}static async abort(){this._abortCurrentRequest()}static _request(e,t,r){const n=this._getFromCache(e.word,e.beforeText,e.afterText,t,r);if(n)return Promise.resolve(n);this._abortCurrentRequest(),clearTimeout(this._timeout),this._abortController=new AbortController,this._timeout=self.setTimeout((()=>this._abortCurrentRequest),this.HTTP_TIMEOUT);return("en"===t?this._requestFromNewServer(this._abortController,e,t,r):this._requestFromOldServer(this._abortController,e,t,r)).finally((()=>{this._abortController=null,clearTimeout(this._timeout)}))}static _requestFromOldServer(e,t,r,n){const s=t.word,a=this._prepareWord(t.word),i=new URL(`https://synonyms.languagetool.org/synonyms/${r}/${a}`);i.searchParams.set("before",t.beforeText),i.searchParams.set("after",t.afterText),n&&i.searchParams.set("motherTongue",n);const o={method:"get",mode:"cors",signal:e.signal};return fetch(i.toString(),o).then((e=>e.json())).then((e=>{if(!e||!e.synsets)throw new Error("Error loading synonyms.");const i=this._buildSynonymSets(a,s,e),o={dataSource:e.dataSource,synonymSets:i,genders:e.genders};return this._setInCache(t.word,t.beforeText,t.afterText,r,n,o),o}))}static _requestFromNewServer(e,t,r,n){let s=t.word;const a=t.afterText.match(this.PUNCTUATION_AT_START_REGEXP);a&&(s+=a[1]);const i=t.beforeText.match(this.PUNCTUATION_AT_END_REGEXP);return i&&(s=i[1]+s),fetch(Se,{method:"POST",signal:e.signal,headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({message:{text:t.sentence,phrases:[s],mode:0,indices:[t.beforeText?t.beforeText.split(" ").length:0]},response_queue:"string",meta:{traceID:"string",userID:"string",product:"string",clientStatus:"string"}})}).then((e=>e.json())).then((e=>{if(!(e&&"OK"===e.message&&e.data&&e.data.suggestions&&Array.isArray(e.data.suggestions[s])))throw new Error("Unexpected response");let o=[];if(e.data.suggestions[s].forEach((e=>{i&&a?e.startsWith(i[1])&&e.endsWith(a[1])&&o.push(e.replace(this.PUNCTUATION_AT_END_REGEXP,"").replace(this.PUNCTUATION_AT_START_REGEXP,"")):a?e.endsWith(a[1])&&!e.includes(a[1]+" ")&&o.push(e.replace(this.PUNCTUATION_AT_END_REGEXP,"")):i?e.startsWith(i[1])&&!e.includes(" "+i[1])&&o.push(e.replace(this.PUNCTUATION_AT_START_REGEXP,"")):o.push(e.replace(this.PUNCTUATION_AT_END_REGEXP,""))})),!o.length)return Promise.reject(new Error("No synonyms found"));o=y(o),o.length=Math.min(o.length,12);const c={synonymSets:[{title:"",type:"",synonyms:o.map((e=>({word:e,hints:[]})))}],genders:[]};return this._setInCache(t.word,t.beforeText,t.afterText,r,n,c),c})).catch((s=>"AbortError"!==s?.name?this._requestFromOldServer(e,t,r,n):Promise.reject(s)))}static _prepareWord(e){return e=e.trim(),p(e)?e.charAt(0)+e.substr(1).toLowerCase():e}static _containsSynonymObj(e,t){return e.some((e=>e.word===t.word))}static _buildSynonymSets(e,t,r){const n=[],s=p(t)&&t.length>3;return r.synsets.forEach((r=>{if(!r.terms.length)return;let a="",i="";r.terms[0].term.match(this.IS_ONLY_HINT_REGEXP)?(a=`${t} ${r.terms[0].term}`,i=r.terms[0].term.replace(/[\(\)]/g,""),r.terms.shift()):a=r.terms[0].term;const o=[];if(r.terms.forEach((t=>{let r=Array.from(t.term.match(this.HINT_REGEXP)||[]);if(r=r.map((e=>e.replace(this.TERM_REGEXP,"").trim())),r=r.filter((e=>!e.match(/similar/))),r.indexOf("(antonym)")>-1)return;let n=t.term.replace(this.HINT_REGEXP,"").trim();n.match(/[\!\?\,\:\;]/)||n.toLowerCase()!==e.toLowerCase()&&(s&&(n=n.toUpperCase()),n.trim()&&o.push({word:n,hints:r}))})),!o.length)return;const c=n.find((e=>e.type===i&&e.title===a&&e.synonyms.find((e=>this._containsSynonymObj(o,e)))));if(c)o.forEach((e=>{this._containsSynonymObj(c.synonyms,e)||c.synonyms.push(e)}));else{if(i){if(n.filter((e=>e.type===i)).length>=3)return}n.push({title:a,type:i,synonyms:o})}})),n}static _abortCurrentRequest(){this._abortController&&(this._abortController.abort(),this._abortController=null)}static _getFromCache(e,t,r,n,s){const a=this._cache.find((a=>a.word===e&&a.beforeText===t&&a.afterText===r&&a.language===n&&a.motherTongue===s));if(a)return a.result}static _setInCache(e,t,r,n,s,a){this._cache.unshift({word:e,beforeText:t,afterText:r,language:n,motherTongue:s,result:a}),this._cache.length=Math.min(this._cache.length,100)}}Kt.HTTP_TIMEOUT=5e3,Kt._abortController=null,Kt._cache=[],Kt.IS_ONLY_HINT_REGEXP=/^\s*\([^\)]+\)\s*$/,Kt.TERM_REGEXP=/\sterm/,Kt.HINT_REGEXP=/(\s|^)\((.+?)\)/g,Kt.PUNCTUATION_AT_START_REGEXP=/^([.…,:;?!"”“„\)]+)/,Kt.PUNCTUATION_AT_END_REGEXP=/([.…,:;?!"”“„\(]+)$/,Kt.emptySynonymResult={synonymSets:[],dataSource:{licenseUrl:"",sourceName:"",sourceUrl:""},genders:null};const qt=()=>({spelling:0,grammar:0,style:0,punctuation:0,typography:0});let zt=(()=>{const e={};return{set:(t,r)=>(e[t]=r,Promise.resolve()),get:t=>Promise.resolve(e[t]),getAll:()=>Promise.resolve(e),delete:t=>(delete e[t],Promise.resolve())}})();async function Jt(e){if(!await zt.get(e))throw new Error("Failed to destroy activity; no User Activity found for UUID");const t=await Qt(e);return await zt.delete(e),t}async function Qt(e){const t=await zt.get(e);if(!t)return"unknown_uuid";try{const r={source:t.source,data:{rewritings:t.rewritings,...t.statistics,...t.suggestions,...t.meta}};if(!function({data:e}){const t=["checkLevel","writingGoalId","language"];return Object.entries(e).filter((([e])=>!1===t.includes(e))).some((([,e])=>Boolean(e)))&&g(e.language)}(r))return"no_update";await async function(e){let t=await zt.get(e);t&&(t={...t,suggestions:qt(),statistics:{words:0,sentences:0,texts:0,hiddenMatches:0,premiumMatches:0,pickyErrors:0},rewritings:0},await zt.set(e,t))}(e);const n={method:"POST",referrerPolicy:"no-referrer",credentials:"omit",mode:"cors",headers:{Authorization:`Basic ${btoa([t.email,t.token].join(":"))}`,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(r)};return"standalone"===t.source&&(n.keepalive=!0),await B(Ae,n,3e4),"success"}catch{return"error"}}
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class er{constructor(){this.TRACKING_BASE_URL="https://analytics.languagetoolplus.com/matomo/piwik.php",this.TRACKING_BASE_PAGE_URL="https://fake/",this.ACTIVITY_TRACK_INTERVAL=864e5,this.PING_TRACK_INTERVAL=6048e5,this.MAX_TIME=6e4,this.THROTTLE_REQUESTS=10,this._isInitialized=!1,this._loggedErrors=null,this._errorCount=0}initialize(){if(this._isInitialized)return;this.TRACKING_SITE_ID=o.getTrackingId(),this.VERSION=o.getVersion(),this._storageController=Ft.create();const e=o.getURL("/");self.addEventListener("error",(t=>{const r=t.message,n=t.filename,s=t.lineno,a=t.error;if(!n||!n.startsWith(e))return;if("string"!=typeof r)return;if(r.includes("ResizeObserver"))return;const i=a&&function(e){if(!e.stack)return;let t=[];if(e.stack.split(/\n/).forEach((e=>{const r=e.match(/([\w_<>]+)\s+\(.+?([\w_\-]+\.(js|html))/);r&&t.push(`${r[2]}:${r[1]}`)})),!t.length){const r=e.stack.match(/([\w_\-]+\.(js|html))/);r&&t.push(r[1])}return t.join(",").substr(0,140)}(a);i?this.trackError("js",r,i):this.trackError("js",r,`${n}:${s}`)})),this._isInitialized=!0,this.trackActiveAfterOneWeek()}getCustomDimensions(e){const t=this._storageController.getSettings(),r=this._storageController.getUIState(),n=this._storageController.getTestFlags(),s={dimension2:this.VERSION,dimension3:String(r.hasPaidSubscription),dimension4:String(Boolean(t.username&&(t.password||t.token))),dimension5:t.preferredLanguages.join(","),dimension6:String(t.hasPickyModeEnabledGlobally),dimension7:String(n.testGroups.qb),dimension13:r.showRuleId?"{}":JSON.stringify(n.testGroups)};return e?.writingGoal&&(s.dimension8=e.writingGoal),e?.errorType&&(s.dimension9=e.errorType),s}_getTrackingUrlForPageView(e,t){return e=(e=e.replace(/^(chrome|moz|safari|edge)-extension:\/\/.+?\//i,"")).replace(/^[a-z0-9]{8}\//i,"/"),e=`${this.TRACKING_BASE_PAGE_URL}${e}`,new Promise(((r,n)=>{this._storageController.onReady((()=>{const{firstVisit:n,sessionCount:s}=this._storageController.getStatistics(),a=this._storageController.getUniqueId(),i=new URL(this.TRACKING_BASE_URL),o=[self.screen?.width??0,self.screen?.height??0],c={idsite:this.TRACKING_SITE_ID,rec:"1",url:e,rand:String(Date.now()),apiv:"1",res:o.join("x"),_id:String(a),_idts:String(n),_idvc:String(s),...this.getCustomDimensions(t)};for(const[e,t]of Object.entries(c))i.searchParams.append(e,t);r(i.toString())}))}))}_getTrackingUrlForEvent(e,t,r="",n,s){return n=n||this.TRACKING_BASE_PAGE_URL,new Promise(((a,i)=>{this._storageController.onReady((()=>{const{firstVisit:i,sessionCount:o}=this._storageController.getStatistics(),c=this._storageController.getUniqueId(),l=new URL(this.TRACKING_BASE_URL),u=[self.screen?.width??0,self.screen?.height??0],g={idsite:this.TRACKING_SITE_ID,rec:"1",url:n||"",action_name:t,rand:String(Date.now()),apiv:"1",res:u.join("x"),_id:c,_idts:String(i),_idvc:String(o),e_c:e,e_a:t,e_n:r??"",...this.getCustomDimensions(s)};for(const[e,t]of Object.entries(g))l.searchParams.append(e,t);a(l.toString())}))}))}_sendRequest(e){!o.shouldTrack()||this._storageController.hasCustomServer()||navigator.webdriver||B(e,{mode:"no-cors",referrerPolicy:"no-referrer",keepalive:"standalone"===o.getType()},1e4).catch((()=>null))}trackPageView(e,t){e=e||D(),this._getTrackingUrlForPageView(e,t).then((t=>{o.isProductionEnvironment()?this._sendRequest(t):console.log("LT Page view tracking disabled in dev mode",{pageUrl:e,trackingUrl:t})})).catch((e=>{console.log("LT could not track because:",e&&e.message)}))}trackDisabledRule(e,t,r,n){if(!e.match(/^de|en|nl|es|fr|ca|pt/i))return;const s=n?Je.PREMIUM:Je.BASIC,a=e+":"+t,i=r,c=new URL(this.TRACKING_BASE_URL);c.searchParams.append("idsite","18"),c.searchParams.append("rec","1"),c.searchParams.append("url",this.TRACKING_BASE_PAGE_URL),c.searchParams.append("action_name",s),c.searchParams.append("rand",String(Date.now())),c.searchParams.append("apiv","1"),c.searchParams.append("_id",this._storageController.getUniqueId()),c.searchParams.append("e_c",s),c.searchParams.append("e_a",a),c.searchParams.append("e_n",r),o.isProductionEnvironment()?this._sendRequest(c.toString()):console.log("LT Event tracking disabled in dev mode",{actionCategory:s,action:a,actionName:i,trackingUrl:c})}trackDictionaryEvent(e,t,r){if(!e.match(/^de|en|nl|es|fr|it|pt|ru|ca|pl/i))return;const n=r?"TemporaryIgnored":"PersistentlyIgnored",s=`${e}:add_word`,a=t,i=new URL(this.TRACKING_BASE_URL);i.searchParams.append("idsite","19"),i.searchParams.append("rec","1"),i.searchParams.append("url",this.TRACKING_BASE_PAGE_URL),i.searchParams.append("action_name",n),i.searchParams.append("rand",String(Date.now())),i.searchParams.append("apiv","1"),i.searchParams.append("_id",this._storageController.getUniqueId()),i.searchParams.append("e_c",n),i.searchParams.append("e_a",s),i.searchParams.append("e_n",t),o.isProductionEnvironment()?this._sendRequest(i.toString()):console.log("LT Event tracking disabled in dev mode",{actionCategory:n,action:s,actionName:a,trackingUrl:i})}trackEvent(e,t,r,n,s){this._getTrackingUrlForEvent(e,t,r,n,s).then((n=>{o.isProductionEnvironment()?this._sendRequest(n):console.log("LT Event tracking disabled in dev mode",{actionCategory:e,action:t,actionName:r,trackingUrl:n})})).catch((e=>{console.log("LT could not track because:",e&&e.message)}))}trackInstall(){this.trackEvent("Action","install",kt.getPrimaryLanguageCode(navigator.language)),this._storageController.updateUIState({isNewUser:!0})}trackActivity(){this._storageController.onReady((()=>{const e=Date.now(),{sessionCount:t,lastActivity:r,lastPing:n}=this._storageController.getStatistics();(!r||e-r>this.ACTIVITY_TRACK_INTERVAL)&&this._storageController.updateStatistics({sessionCount:t+1,lastActivity:e}).then((()=>{this.trackUserActivity()})),(!n||e-n>this.PING_TRACK_INTERVAL)&&this._storageController.updateStatistics({lastPing:e}).then((()=>{this.trackEvent("Stat","ping")}))}))}trackActiveAfterOneWeek(){this._storageController.onReady((()=>{const e=Date.now(),{firstVisit:t}=this._storageController.getStatistics(),{isNewUser:r}=this._storageController.getUIState();if(r&&t){const r=6048e5,n=e-1e3*t;n>r&&n<8*r&&this._storageController.updateUIState({isNewUser:!1}).then((()=>{this.trackEvent("Action","active_after_one_week",kt.getPrimaryLanguageCode(navigator.language))})).catch((()=>null))}}))}trackUserActivity(){this._storageController.onReady((()=>{const{username:e}=this._storageController.getSettings();if(!e||this._storageController.hasCustomServer())return;const t=new FormData;t.append("email",e),t.append("useragent",a.getUserAgentIdentifier()),B(pe,{method:"POST",mode:"cors",credentials:"omit",body:t},1e4).catch((()=>null))}))}trackError(e,t,r=""){try{if(a.isUnsupportedBrowser())return;if(this._errorCount++,this._errorCount>We)return;if("string"!=typeof t)return;if(this._loggedErrors)if(this._loggedErrors.length<this.THROTTLE_REQUESTS)this._loggedErrors.push(Date.now());else{const e=Date.now();if(!(e-this._loggedErrors[0]>=this.MAX_TIME))return;this._loggedErrors.push(e),this._loggedErrors.splice(0,1)}else this._loggedErrors=[Date.now()];let n="JS-Error";"message"===e?n="Message-Error":"http"===e?n="HTTP-Error":"other"===e&&(n="Other-Error");let s=D();s=s.replace(/^moz-extension:\/\/[a-z0-9\-]+\//,"moz-extension://xxxx-xxxx-xxxx-xxxx/"),s.match(/(chrome|moz|safari)\-extension:/)||(s=void 0),this.trackEvent(n,t,r||s,s)}catch(e){console.error("Error while logging error from language tool",e)}}trackStat(e,t){0===Math.floor(10*Math.random())&&this.trackEvent("Stat",e,t)}trackTextLength(e){if(0===e)return;let t="";t=e<=100?"1-100":e<=1e3?"101-1000":e<=2500?"1001-2500":e<=5e3?"2501-5000":e<=7500?"5001-7500":e<=1e4?"7501-10000":e<=15e3?"10001-15000":e<=2e4?"15001-20000":e<=4e4?"20001-40000":e<=6e4?"40001-60000":e<=8e4?"60001-80000":e<=1e5?"80001-100000":">100000",this.trackStat("text_length",t)}}
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
var tr;class rr{static _initThunderbird(){a.isThunderbird()&&Ht.registerComposeScripts()}static _installUpdate(){pt().tabs.query({}).then((e=>{e.forEach((e=>{if(!e.id)return;pt().tabs.sendMessage(e.id,{command:"DESTROY"}).catch(console.error.bind(console))}))})),Wt.trackEvent("Action","pre_update"),self.setTimeout((()=>{pt().runtime.reload()}),2e3)}static _assignToTestGroups(){o.isProductionEnvironment()&&a.isEdge()&&this._storageController.updateTestFlags({testGroups:{deggec:Math.random()<.5}})}static async _queryForDarkMode(){if(await this._hasDarkTheme())return!0;const e=await this._getActiveTabs(),[{id:t}={}]=e;if("number"!=typeof t)return null;const r=await pt().tabs.sendMessage(t,{command:"CHECK_IS_DARK_MODE"}).catch((()=>null));if(!r)return null;const{isDarkMode:n=null}=function(e){return"CHECK_IS_DARK_MODE"===e.initialCommand}(r)?r:{};return n}static async _hasDarkTheme(){if(a.isFirefox()||a.isThunderbird()&&pt().theme){const e=await pt().theme.getCurrent();if(e?.colors?.toolbar){return Nt(e.colors.toolbar)<=35}}return null}static _updateIcon(e=!1){a.isSafari()||this._storageController.onReady((async()=>{const t=await this._queryForDarkMode();null!==t?this.setIcon(t,e):this._storageController.updateUIState({isDarkModeEnabled:void 0})}))}static async setIcon(e,t=!1){if(a.isSafari())return;const{isDarkModeEnabled:r}=this._storageController.getUIState();(r!==e||t)&&(e?this._browserAction.setIcon({path:{16:"/assets/images/icons/icon16_white.png",32:"/assets/images/icons/icon32_white.png",48:"/assets/images/icons/icon48_white.png",64:"/assets/images/icons/icon64_white.png",128:"/assets/images/icons/icon128_white.png"}}):this._browserAction.setIcon({path:{16:"/assets/images/icons/icon16.png",32:"/assets/images/icons/icon32.png",48:"/assets/images/icons/icon48.png",64:"/assets/images/icons/icon64.png",128:"/assets/images/icons/icon128.png"}}),await this._storageController.updateUIState({isDarkModeEnabled:e}))}static _setContextMenu(){this._contextMenu&&this._storageController.onReady((()=>{const{hasContextMenuOptionEnabled:e}=this._storageController.getSettings(),{disableOpenInEditor:t}=this._storageController.getManagedSettings();this._contextMenu.onClicked.removeListener(this._onContextMenuItemClicked),this._contextMenu.removeAll().then((()=>{if(!e||t)return;let r=At.getMessage("contextMenuValidate");this._storageController.hasLanguageToolAccount()&&(r=At.getMessage("contextMenuValidateInEditor")),this._contextMenu.create({title:r,id:this.CONTEXT_MENU_ID,contexts:["selection"]}),this._contextMenu.onClicked.addListener(this._onContextMenuItemClicked)}))}))}static async _initiateToolboxNetworkRequest({options:e,uuid:t}){let r;const{method:n,url:a,query:i={},data:o,responseType:c}=e,l=new URLSearchParams(i).toString(),u=a+(l?`?${l}`:""),g=new AbortController,d={method:n,headers:{accept:"application/json"},signal:g.signal,credentials:"omit"},h=()=>{clearTimeout(r),g.abort(),this._toolboxRequests.delete(t)};let m;"POST"===n&&o&&(d.body=JSON.stringify(o)),this._toolboxRequests.set(t,h);try{r=self.setTimeout((()=>h()),1e4);const e=await fetch(u,d);if(!e.ok)throw new Error(e.statusText);let t;if("text"===c)t=await e.text();else if("blob"===c){const r=await e.blob(),n=await function(e){return new Promise(((t,r)=>{const n=new FileReader;n.onloadend=()=>{s(n.result)?t(n.result):r(new Error("[Toolbox] Got invalid result from reading blob."))},n.onerror=()=>r(new Error("[Toolbox] Failed to read the blob.")),n.readAsDataURL(e)}))}(r);t={type:r.type,data:n}}else t=await e.json();m={status:"success",data:t}}catch(e){m={status:"error",data:`${Object(e).message||"Request failed"} (${n} ${u})`}}finally{clearTimeout(r),this._toolboxRequests.delete(t)}return m}static _abortToolboxNetworkRequest({uuid:e}){let t;(t=this._toolboxRequests.get(e))&&t()}static _updateBadge(e,t){this._browserAction.setBadgeTextColor&&this._browserAction.setBadgeTextColor({tabId:e,color:"#FFFFFF"}),t.enabled&&t.supported?this._browserAction.setBadgeText({tabId:e,text:""}).catch(console.error.bind(console)):(this._browserAction.setBadgeBackgroundColor&&this._browserAction.setBadgeBackgroundColor({tabId:e,color:"#F53987"}).catch(console.error.bind(console)),this._browserAction.setBadgeText({tabId:e,text:a.isOpera()?"":"OFF"}).catch(console.error.bind(console)))}static _updateUninstallURL(e="unknown"){const t=this._storageController.getSettings(),r=this._storageController.getPrivacySettings(),n=this._storageController.getStatistics(),s=this._storageController.getTestFlags(),a=pt().runtime.getManifest(),i=a&&a.version||"unknown";e=e.replace("www.","").slice(0,25);const c=new URL(ae);c.searchParams.set("autoCheck",String(t.autoCheck)),c.searchParams.set("host",e),c.searchParams.set("v",i),c.searchParams.set("privacyConfirmed",String(r.allowRemoteCheck)),c.searchParams.set("globalPickyMode",String(t.hasPickyModeEnabledGlobally)),c.searchParams.set("usages",String(n.usageCount)),c.searchParams.set("sessions",String(n.sessionCount));const l=this._storageController.getUniqueId();l&&c.searchParams.set("matomo",l);for(const e in s)s.hasOwnProperty(e)&&c.searchParams.set(e,s[e]);o.isProductionEnvironment()||c.searchParams.set("dev",""),pt().runtime.setUninstallURL(c.toString().slice(0,255))}static _setMotherTongue(){this._storageController.onReady((()=>{const{motherTongue:e,geoIpLanguages:t}=this._storageController.getSettings();if(e)return;const r=t.some((e=>!!e.match(/^de/i)))&&navigator.languages[0]&&navigator.languages[0].match(/^de/i),n=Array.from(navigator.languages).some((e=>!e.match(/^(de|en)/i)));r&&!n&&(Wt.trackEvent("Action","set_mother_tongue","de"),this._storageController.updateSettings({motherTongue:"de"}));const s=t.some((e=>!!e.match(/^fr/i)))&&navigator.languages[0]&&navigator.languages[0].match(/^fr/i),a=Array.from(navigator.languages).some((e=>!e.match(/^(fr|en)/i)));s&&!a&&(Wt.trackEvent("Action","set_mother_tongue","fr"),this._storageController.updateSettings({motherTongue:"fr"}))}))}static _launchEditor(e,t){let r;e&&(r=Math.round(99999*Math.random())+":"+Date.now(),this._validatorsData.set(r,{id:r,text:e,html:t,timestamp:Date.now()}));let n=o.getURL(`/validator/validator.html?id=${r}`);const{username:s,token:i}=this._storageController.getSettings();if(a.isSafari()){const r=this._storageController.getSettings().userId||void 0;pt().runtime.sendMessage({userId:r,message:{username:s,token:i,text:e,html:t},command:"LAUNCH_DESKTOP_EDITOR"})}else s&&i&&navigator.onLine&&(n=function(e,t,r){const n=new URL("https://languagetool.org/webextension/login");return n.searchParams.set("email",e),n.searchParams.set("addon_token",t),r&&n.searchParams.set("temp_text_id",r),n.toString()}(s,i,r)),pt().tabs.create({url:n}).then((e=>{e&&e.windowId&&pt().windows.update(e.windowId,{focused:!0})}))}static _checkForChangelogPage(){if(a.isThunderbird())return;const e=this._storageController.isRelevantForChangelogCoupon();if(!e.status)return void Wt.trackEvent("Action","changelog:dont_open_page",String(e.reason));const{lastChangelogNov2023Seen:t}=this._storageController.getUIState();t?Wt.trackEvent("Action","changelog:dont_open_page","already_seen"):a.isSafari()?setTimeout((()=>this._openChangelogPage()),15e3):this._openChangelogPage()}static _openChangelogPage(){const e=pt().runtime.getURL("/changelog/changelog.html");this._changelogOpened||(this._changelogOpened=!0,pt().windows.getAll({windowTypes:["normal"]}).then((t=>{Wt.trackEvent("Action","changelog:open",t.length?"existing-window":"empty-window");const r=(t||[]).find((e=>e.focused&&"normal"===e.type));if(a.isSafari()){const t="https://languagetool.org/favicon.ico";pt().tabs.create({active:!1,url:t}).then((()=>St(500))).then((()=>pt().tabs.query({}))).then((r=>{const n=r.find((e=>e.url===t));n&&n.id&&pt().tabs.update(n.id,{url:e})}))}else r?pt().tabs.create({windowId:r.id,active:!1,url:e}):pt().tabs.create({active:!1,url:e})}),(()=>{Wt.trackError("other","changelog:get_window_error")})))}static _applyManagedSettings(){const{disablePrivacyConfirmation:e}=this._storageController.getManagedSettings(),{allowRemoteCheck:t}=this._storageController.getPrivacySettings();!0!==e||t||(this._storageController.updatePrivacySettings({allowRemoteCheck:!0}),Wt.trackEvent("Action","accept_privacy_note","managed"))}static _loadConfiguration(){this._storageController.onReady((()=>{if(this._storageController.hasCustomServer())return;const e=pt().runtime.getManifest(),t=e&&e.version||"unknown",r=new URL(_e);r.searchParams.set("v",t),B(r.toString(),{credentials:"omit"},1e4).then((e=>e.json())).then((e=>{if(e.disabledSites&&Array.isArray(e.disabledSites)){const t={unsupportedDomains:e.disabledSites};this._storageController.updateRemoteConfiguration(t)}}))}))}static _checkForPaidSubscription(){this._storageController.checkForPaidSubscription().catch(console.error)}static _syncUserData(){const e=Date.now();this._lastUserDataSync&&this._lastUserDataSync+q>e||(this._lastUserDataSync=e,this._storageController.onReady((async e=>{if(!e.hasLanguageToolAccount())return;const{username:t,token:r}=e.getSettings();try{const n=new URLSearchParams({email:t,addon_token:r}),s=await B(`${ie}?${n.toString()}`,{mode:"cors",credentials:"omit"},1e4),{data:a={},error:i}=await s.json().catch((()=>({error:"Request failed"})));if("string"==typeof i&&i.length>0)return void Wt.trackError("http","user_data_sync_error",i);const o={..."number"==typeof a.id?{userId:a.id}:void 0,..."number"==typeof a.dpa_level?{dpaLevel:a.dpa_level}:void 0},c={..."boolean"==typeof a.statistics_collection?{hasStatisticsCollectionEnabled:a.statistics_collection}:void 0,..."boolean"==typeof a.ml_data_collection?{hasMLDataCollectionEnabled:a.ml_data_collection}:void 0};if(e.updateSettings(o),e.updatePrivacySettings(c),!0===a.prefer_oxford_spelling)e.removeIgnoredRule("OXFORD_SPELLING_Z_NOT_S");else{const t={id:"OXFORD_SPELLING_Z_NOT_S",language:"en",turnOffDate:new Date};e.addIgnoredRule(t)}}catch{Wt.trackError("other","user_data_sync_failed")}})))}static _migrate(){this._setPreferredLanguages(),this._setRemainingRephrasings(),this._replacePasswordWithAddOnToken(),this._removeOldIgnoredRules()}static _removeOldIgnoredRules(){const{ignoredRules:e}=this._storageController.getSettings(),t=new Date("2023-06-01"),r=e.filter((e=>!!["OXFORD_SPELLING_Z_NOT_S","COMMA_PERIOD_CONFUSION","FRENCH_WHITESPACE","TOO_LONG_SENTENCE","UPPERCASE_SENTENCE_START","ES_UNPAIRED_BRACKETS","UNPAIRED_BRACKETS","EN_UNPAIRED_BRACKETS","ES_QUESTION_MARK","SENTENCE_WHITESPACE","SINGLE_CHARACTER","DASH_RULE","QB_EN_INSERT_PERIOD_ERROR_IDS_000032","AI_DE_GGEC_MISSING_PUNCTUATION_PERIOD"].includes(e.id)||(!["de","es","fr","pt","nl","en"].includes(e.language)||(!!Qe.includes(e.id)||!!e.turnOffDate&&e.turnOffDate.getTime()>t.getTime()))));this._storageController.updateSettings({ignoredRules:r})}static _setPreferredLanguages(){this._storageController.updateSettings({preferredLanguages:this._getInitialPreferredLanguages()})}static _setRemainingRephrasings(){const e=this._storageController.getSettings(),{hasPaidSubscription:t}=this._storageController.getUIState(),r={};"remainingRephrasingsAmount"in e||(r.remainingRephrasingsAmount=t?null:at),"remainingRephrasingsDate"in e||(r.remainingRephrasingsDate=t?null:(new Date).toISOString()),this._storageController.updateSettings(r)}static async _replacePasswordWithAddOnToken(){const{username:e,token:t,password:r}=this._storageController.getSettings();if(!e||!r||t.length>0)return;let n=500;try{const t=btoa(`${e}:${r}`),s=this._storageController.getCustomServerUrl()||ge,a=new URL("/v2/users/me",s),i=await fetch(a.toString(),{method:"GET",headers:{Authorization:`Basic ${t}`}}),{addon_token:o,id:c}=await i.json().catch((()=>({})));if(!o||!c)throw n=i.status,new Error;await this._storageController.updateSettings({password:"",token:o,userId:c}),Wt.trackEvent("Action","token_migration_succeeded")}catch{Wt.trackError("http","token_migration_failed",String(n))}}static _onUserCredentialsChanged(e){(Boolean(e.username?.newValue)||Boolean(e.token?.newValue))&&Vt.checkForInitialSync()}static _onPageLoadedMessage(e,t){if(0!==e.frameId||!e.tab)return;const r=e.tab.id,n={enabled:t.enabled,supported:t.supported,unsupportedMessage:t.unsupportedMessage,language:null,beta:t.beta};this._extensionStates.set(r,n),pt().tabs.detectLanguage&&!a.isOpera()&&pt().tabs.detectLanguage(r).then((e=>{e&&"und"!==e&&(n.language=kt.getPrimaryLanguageCode(e))})).catch((e=>{console.error("Error detecting language",e)}));const s=e.tab.url||"about:blank";this._updateUninstallURL(x(s)),this._updateBadge(r,n),this._hasDarkTheme().then((e=>{null===e?this.setIcon(t.isDarkMode):this.setIcon(e)})).catch((()=>null))}static async _onCheckForPaidSubscriptionMessage(){try{return{initialCommand:"CHECK_FOR_PAID_SUBSCRIPTION",isSuccessful:!0,hasPaidSubscription:await this._storageController.checkForPaidSubscription()}}catch(e){return{initialCommand:"CHECK_FOR_PAID_SUBSCRIPTION",isSuccessful:!1,error:{reason:e.reason,status:e.status,response:e.response,url:e.url,stack:e.stack}}}}static _onLTAssistantStatusChangedMessage(e,t){const r=t.tabId||e.tab.id;if(!this._extensionStates.has(r))return;const n=this._extensionStates.get(r);"boolean"==typeof t.enabled&&(n.enabled=t.enabled),this._updateBadge(r,n)}static _onTrackTextLengthMessage(e,t){Wt.trackTextLength(t.textLength)}static _onTrackEventMessage(e,t){Wt.trackEvent("Action",t.action,t.label)}static _onOpenFeedbackFormMessage(e,t){this._lastScreenshot=null;("function"!=typeof pt().tabs.captureVisibleTab?Promise.reject():"number"==typeof e.tab?.windowId?pt().tabs.captureVisibleTab(e.tab.windowId):pt().tabs.captureVisibleTab()).then((e=>{this._lastScreenshot=function(e){const t=atob(e.split(",")[1]),r=e.split(",")[0].split(":")[1].split(";")[0],n=new ArrayBuffer(t.length),s=new Uint8Array(n);for(let e=0;e<t.length;e++)s[e]=t.charCodeAt(e);return new Blob([n],{type:r})}(e)})).catch((()=>null)).then((()=>{const e=new URL("/feedbackForm/feedbackForm.html","http://example.com");return e.searchParams.append("url",t.url.substr(0,200)),t.html&&e.searchParams.append("html",t.html.substr(0,600)),t.title&&e.searchParams.append("title",t.title),this._lastScreenshot&&e.searchParams.append("screenshot",String(this._lastScreenshot?1:0)),pt().windows.create({url:o.getURL(e.pathname+e.search),type:"popup",width:380,height:520})})).then((e=>{e&&e.id&&pt().windows.update(e.id,{left:Math.round((a.isChromium()&&e.left||0)+((self.screen?.availWidth||760)-380)/2),top:Math.round((a.isChromium()&&e.top||0)+((self.screen?.availHeight||1040)-520)/2)})}))}static _onSendFeedbackMessage(e,t){const r=new FormData;r.append("sender",t.sender),r.append("text",t.text),this._lastScreenshot&&t.includeScreenshot&&(r.append("screenshot",this._lastScreenshot,`screenshot_${Date.now()}.jpg`),this._lastScreenshot=null),fetch(me,{method:"POST",mode:"cors",credentials:"omit",body:r}).catch((()=>{Wt.trackError("http","error_send_feedback")}))}static _onOpenOptionsMessage(e,t){let r="/options/options.html";t.ref&&(r+=`?ref=${encodeURIComponent(t.ref)}`),t.target&&(r+=`#${t.target}`),pt().tabs.create({url:o.getURL(r)}).then((e=>{e&&e.windowId&&pt().windows.update(e.windowId,{focused:!0}).catch(console.error)}))}static _onOpenPrivacyConfirmationMessage(e,t){pt().tabs.create({url:se}).then((e=>{e&&e.windowId&&pt().windows.update(e.windowId,{focused:!0}).catch(console.error)}))}static _onCloseCurrentTabMessage(e,t){pt().tabs.query({currentWindow:!0,active:!0}).then((e=>{e.length&&pt().tabs.remove(e[0].id).catch((()=>null))}))}static _getInitialPreferredLanguages(){const{geoIpLanguages:e,motherTongue:t,preferredLanguages:r}=this._storageController.getSettings();if(Array.isArray(r)&&r.length)return r;const n=kt.getPrimaryLanguageCode(kt.getUserLanguageCode()),s=navigator.languages.map((e=>kt.getPrimaryLanguageCode(e)));return y([t,n].concat(e,s,["en"]).filter(Boolean)).map((e=>"nb"===e?"no":"fil"===e?"tl":e))}static _getPreferredLanguages(e){const{preferredLanguages:t,forcePreferredLanguages:r,motherTongue:n}=this._storageController.getSettings();if(n&&t.push(n),r)return y(t);if(e.tab){const r=this._extensionStates.get(e.tab.id);r&&r.language&&t.push(r.language)}return t.push("en"),y(t)}static _onCheckTextMessage(e,t){if(Wt.trackActivity(),0===this._checkThrottlingCount&&setTimeout((()=>{this._checkThrottlingCount=0}),5e3),this._checkThrottlingCount++,this._checkThrottlingCount>t.options.throttlingLimit){const e={initialCommand:"CHECK_TEXT",isSuccessful:!1,instanceId:t.metaData.instanceId,error:{status:0,reason:"TooManyRequests"}};return Promise.resolve(e)}const{username:r,password:n,token:s,forcePreferredLanguages:i,motherTongue:c,enVariant:l,deVariant:u,ptVariant:g,caVariant:d,dictionary:h}=this._storageController.getSettings();let m=this._getPreferredLanguages(e);if(t.metaData.elementLanguage&&!i){const e=kt.getPrimaryLanguageCode(t.metaData.elementLanguage.toLowerCase());kt.LANGUAGES.some((t=>kt.getPrimaryLanguageCode(t.code)===e))?m=[e]:m.push(e)}const _=this._storageController.getStatistics().usageCount+1;this._storageController.updateStatistics({usageCount:_});const E=x(t.metaData.pageUrl);this._updateUninstallURL(E);const p=[],{hasPaidSubscription:f,showRuleId:A}=this._storageController.getUIState();let S=null;r&&s?S={email:r,token:s}:r&&n&&(S={email:r,password:n});const T=this._storageController.getCustomServerUrl();"extension"!==o.getType()||T||f||(S=null);const C={instanceId:t.metaData.instanceId,user:S,isPremium:f,apiServerUrl:T,languageVariants:{en:l,de:u,pt:g,ca:d},dictionary:h,disabledRules:this._storageController.getIgnoredRuleIds(),preferredLanguages:m,forcePreferredLanguages:i,motherTongue:c,checkLevel:t.metaData.checkLevel,recipientInfo:t.metaData.recipientInfo,writingGoalId:null,ignoreCapitalizationErrorsAtLineStart:t.options.ignoreCapitalizationErrorsAtLineStart,useParagraphLevelCaching:t.options.useParagraphLevelCaching,debug:A,userAgent:a.getUserAgentIdentifier(),version:o.getVersion(),testGroups:t.options.testGroups};return t.options.checkTextLevel?p.push(Ut.checkTextLevel(t.text,t.forceLanguage?t.language:null,C,t.hasUserChangedLanguage)):p.push(Ut.detectLanguage(t.text,t.forceLanguage?t.language:null,C)),p.push(Ut.checkParagraphLevel(t.changedParagraphs,t.language,C,!t.forceLanguage,t.text)),Promise.all(p).then((([e,r])=>{let n=e.language||t.language;const s=!(!n||n.name!==this.UNSUPPORTED_LANGUAGE_NAME);s&&(n=null);return{initialCommand:"CHECK_TEXT",isSuccessful:!0,instanceId:t.metaData.instanceId,text:t.text,changedParagraphs:t.changedParagraphs,language:n,isUnsupportedLanguage:s,isIncompleteResult:r.isIncompleteResult,textLevelErrors:e.errors,textLevelPremiumErrors:e.premiumErrors,textLevelPremiumPickyErrors:e.premiumPickyErrors,textLevelPickyErrors:e.pickyErrors,paragraphLevelErrors:r.errors,paragraphLevelPremiumErrors:r.premiumErrors,paragraphLevelPremiumPickyErrors:r.premiumPickyErrors,paragraphLevelPickyErrors:r.pickyErrors,paragraphLevelSentenceRanges:r.sentenceRanges}})).catch((e=>{if(e&&"AbortError"===e.reason)return;t.options.textTooLongMessage&&"TextTooLong"===e.reason&&(e.message=t.options.textTooLongMessage);return{initialCommand:"CHECK_TEXT",isSuccessful:!1,instanceId:t.metaData.instanceId,error:{reason:e.reason,status:e.status,response:e.response,url:e.url,stack:e.stack}}}))}static _onLaunchEditorMessage(e,t){this._launchEditor(t.text)}static _onGetValidatorDataMessage(e,t){const r=this._validatorsData.get(t.id);this._validatorsData.delete(t.id);const n={initialCommand:"GET_VALIDATOR_DATA",isSuccessful:!0,text:r?r.text:"",html:r?r.html:void 0};return Promise.resolve(n)}static _onStartDictionarySyncMessage(e,t){Vt.checkForInitialSync()}static _onAddWordToDictionaryMessage(e,t){Vt.addWord(t.word).catch((()=>null))}static _onBatchAddWordToDictionaryMessage(e,t){Vt.addBatch(t.words).catch((()=>null))}static _onRemoveWordFromDictionaryMessage(e,t){Vt.removeWord(t.word).catch((()=>null))}static _onClearDictionaryMessage(e,t){Vt.removeBatch(this._storageController.getSettings().dictionary).catch((()=>null))}static _onUpdateDictionaryMessage(e,t){Vt.downloadAll()}static _onOpenURLMessage(e,t){const{tabs:r}=pt();Wt.trackEvent("Action","open_tab",t.url),"self"===t.target?r.update({url:t.url}):r.create({url:t.url}).then((e=>{e&&e.windowId&&pt().windows.update(e.windowId,{focused:!0})}))}static _onGetPreferredLanguagesMessage(e,t){const r=this._getPreferredLanguages(e),n=this._storageController.getSettings(),s=r.map((e=>n[`${e}Variant`]||e));return Promise.resolve(s)}static _onLoadSynonymsMessage(e,t){return Kt.load(t.wordContext,t.language,t.motherTongue)}static _onAbortSynonymsRequestMessage(){return Kt.abort()}static _onLoadPhrasesMessage(e,{uuid:t,phrase:r,language:n,inhouseOnly:s,user:a}){return Zt.load(t,r,n,s,a).then((e=>e),(e=>{switch(!0){case"AbortError"===e.name:throw new Error(ct);case"ServerTimeout"===e.message:throw new Error(ut);default:throw new Error(gt)}}))}static _onReportRephraseMessage(e,{uuid:t,report:r}){return Zt.report(t,r)}static _onAbortPhraseRequestsMessage(e,{type:t}){return Zt.abort(t)}static _onLoadSplitSentenceMessage(e,{uuid:t,phrase:r,language:n,inhouseOnly:s,user:a}){return Zt.requestSplitSentence(t,r,n,s,a).then((e=>e),(e=>{switch(!0){case"AbortError"===e.name:throw new Error(ct);case"PayloadTooLarge"===e.message:throw new Error(lt);case"ServerTimeout"===e.message:throw new Error(ut);default:throw new Error(gt)}}))}static _openPremiumPage(e,t){if(a.isSafari()&&!t.campaign.startsWith("addon2-changelog")){const e=this._storageController.getSettings().userId||void 0,r="safari";return Wt.trackEvent("Action","go_to_apple_upgrade",t.campaign),void pt().runtime.sendMessage({message:{...t,userId:e,target:r},command:"LAUNCH_APPLE_UPGRADE"})}let r=function(e,t=0,r=0,n=0,s="",a){const i=new URL("https://languagetool.org/premium");return i.searchParams.set("utm_campaign",e),a&&i.searchParams.set("textLang",a),s&&i.searchParams.set("historicMatches",s),t&&i.searchParams.set("grammarMatches",String(t)),n&&i.searchParams.set("punctuationMatches",String(n)),r&&i.searchParams.set("styleMatches",String(r)),navigator.webdriver&&i.searchParams.set("disable_test","1"),i.toString()}(t.campaign,t.hiddenGrammarMatches,t.hiddenStyleMatches,t.hiddenPunctuationMatches,t.historicMatches,t.textLanguage);a.isThunderbird()&&pt().windows.openDefaultBrowser?pt().windows.openDefaultBrowser(r):pt().tabs.create({url:r}).then((e=>{e&&e.windowId&&pt().windows.update(e.windowId,{focused:!0})}))}static _loginUserMessage(e,t){a.isSafari()&&pt().runtime.sendMessage({command:"LOGIN"})}static _logoutUserMessage(e,t){a.isSafari()&&pt().runtime.sendMessage({command:"LOGOUT"})}static _onLoginUserMessage(e,t){this._storageController.updateSettings({username:t.username,password:"",userId:t.userId,token:t.token,knownEmail:t.username,apiServerUrl:le}).then((()=>{this._storageController.checkForPaidSubscription()})),o.isProductionEnvironment()||o.startDictionarySync()}static _onLogoutUserMessage(e,t){this._storageController.updateSettings({username:"",password:"",userId:null,token:"",isDictionarySynced:!1}).then((()=>{this._storageController.checkForPaidSubscription()}))}static _onManifestV3Ping(e,t){return Promise.resolve("success")}static _onInitializeUserActivity(e,t){return async function(e){return zt.set(e.uuid,{email:e.email,token:e.token,source:e.source,suggestions:qt(),statistics:{words:0,sentences:0,texts:0,hiddenMatches:0,premiumMatches:0,pickyErrors:0},meta:{language:e.language,writingGoalId:e.writingGoalId,checkLevel:e.checkLevel},rewritings:0,lastPing:Date.now()})}(t.data)}static _onHandleUserActivityPings(e,t){return async function(e){e.forEach((async e=>{const t=await zt.get(e);t&&(t.lastPing=Date.now(),await zt.set(e,t))}))}(t.uuids)}static _onUpdateUserActivityTextStatistics(e,t){return async function(e,t){const r=await zt.get(e);if(!r)return;const n=Object.entries(t).reduce(((e,[t,r])=>(e[t]+=r,e)),r.statistics);await zt.set(e,{...r,statistics:n,lastPing:Date.now()})}(t.uuid,t.stats)}static _onUpdateUserActivityAppliedSuggestions(e,t){return async function(e,t,r){if(function(e){return"custom"===e}(t))return;const n=await zt.get(e);if(!n)return;const s=n.statistics.premiumMatches+Number(r);await zt.set(e,{...n,suggestions:{...n.suggestions,[t]:n.suggestions[t]+1},statistics:{...n.statistics,premiumMatches:s},lastPing:Date.now()})}(t.uuid,t.type,t.isPremium)}static _onUpdateUserActivityAppliedRewritings(e,t){return async function(e){const t=await zt.get(e);t&&await zt.set(e,{...t,rewritings:t.rewritings+1,lastPing:Date.now()})}(t.uuid)}static _onUpdateUserActivityMeta(e,t){return async function(e,t){const r=await zt.get(e);r&&await zt.set(e,{...r,meta:t,lastPing:Date.now()})}(t.uuid,t.meta)}static _onSendUserActivity(e,t){return Qt(t.uuid)}static _onDestroyUserActivity(e,t){return Jt(t.uuid)}static async _getActiveTabs(){try{return await pt().tabs.query({status:"complete",windowType:"normal"})}catch(e){return[]}}static _getCustomUserActivityStorage(){const e=pt().storage.local,t=async()=>(await e.get("userActivityStates")).userActivityStates||{};return{getAll:t,get:async e=>(await t())[e],set:async(r,n)=>{const s=await t();s[r]=n,await e.set({userActivityStates:s})},delete:async r=>{const n=await t();delete n[r],await e.set({userActivityStates:n})}}}}tr=rr,rr.UNSUPPORTED_LANGUAGE_NAME="NoopLanguage",rr.CONTEXT_MENU_ID="languagetool-menu",rr._lastUserDataSync=null,rr._extensionStates=new Map,rr._validatorsData=new Map,rr._checkThrottlingCount=0,rr._currentAction=null,rr._lastScreenshot=null,rr._changelogOpened=!1,rr._toolboxRequests=new Map,rr._onDataLoaded=()=>{Wt.trackActivity(),tr._updateUninstallURL(),tr._applyManagedSettings()},rr._onInstalled=e=>{tr._currentAction="install";const{reason:t,previousVersion:r}=e;tr._updateIcon(),pt().alarms.create("UPDATE_ICON",{periodInMinutes:X/1e3/60}),tr._checkForPaidSubscription(),pt().alarms.create("CHECK_FOR_PAID_SUBSCRIPTION",{periodInMinutes:$/1e3/60}),tr._loadConfiguration(),pt().alarms.create("LOAD_CONFIGURATION",{periodInMinutes:Z/1e3/60}),tr._syncUserData(),pt().alarms.create("SYNC_USER_DATA",{periodInMinutes:q/1e3/60}),pt().alarms.create("SYNC_DICTIONARY",{periodInMinutes:J/1e3/60}),pt().alarms.create("SEND_AND_DESTROY_COMPLETED_USER_ACTIVITIES",{periodInMinutes:Ge/1e3/60}),tr._storageController.onReady((()=>{if(tr._applyManagedSettings(),"install"===t){if(!tr._storageController.getPrivacySettings().allowRemoteCheck&&!tr._storageController.getUIState().hasSeenPrivacyConfirmationDialog){tr._storageController.updateUIState({hasSeenPrivacyConfirmationDialog:!0});let e=`${se}?new`;o.isProductionEnvironment()||(e+="&dev"),pt().tabs.create({url:e}).then((e=>{e&&e.windowId&&pt().windows.update(e.windowId,{focused:!0})})),tr._assignToTestGroups(),tr._updateUninstallURL(),kt.getLanguagesForGeoIPCountry().then((e=>{const t={geoIpLanguages:e.geoIpLanguages,geoIpCountry:e.geoIpCountry||""};"GB"===e.geoIpCountry||"IE"===e.geoIpCountry?t.enVariant="en-GB":"US"===e.geoIpCountry?t.enVariant="en-US":"CA"===e.geoIpCountry?t.enVariant="en-CA":"NZ"===e.geoIpCountry?t.enVariant="en-NZ":"AU"===e.geoIpCountry?t.enVariant="en-AU":"ZA"===e.geoIpCountry?t.enVariant="en-ZA":"DE"===e.geoIpCountry?t.deVariant="de-DE":"AT"===e.geoIpCountry?t.deVariant="de-AT":"CH"===e.geoIpCountry?t.deVariant="de-CH":"BR"===e.geoIpCountry?t.ptVariant="pt-BR":["PT","IT","DE","ES","NL","BE","CH","AT","FR","LU","GB","IE","PL","CZ"].includes(e.geoIpCountry)&&(t.ptVariant="pt-PT");const r="CA"===e.geoIpCountry,n=navigator.languages.some((e=>"en-ca"===e.toLowerCase())),s=navigator.languages.some((e=>"fr-ca"===e.toLowerCase()));if(r||n||s){const e={id:"FRENCH_WHITESPACE",language:"fr",description:"Insertion des espaces fines insécables",turnOffDate:new Date},r=tr._storageController.getSettings().ignoredRules;r.push(e),t.ignoredRules=r}if("ZA"===e.geoIpCountry){const e={id:"COMMA_PERIOD_CONFUSION",language:"en",description:"Decimal separator in numbers",turnOffDate:new Date},r=tr._storageController.getSettings().ignoredRules;r.push(e),t.ignoredRules=r}{const e={id:"OXFORD_SPELLING_Z_NOT_S",language:"en",turnOffDate:new Date},{ignoredRules:r}=tr._storageController.getSettings();r.push(e),t.ignoredRules=r}tr._storageController.updateSettings(t),tr._setMotherTongue(),tr._setPreferredLanguages()})).catch((e=>{tr._setPreferredLanguages(),console.error(e),Wt.trackError("js",e&&e.message)})),Wt.trackInstall(),Ht.setNativeSpellCheck(!1)}}else if("update"===t){tr._assignToTestGroups(),tr._updateUninstallURL(),tr._migrate();const e=pt().runtime.getManifest(),t=e&&e.version||"unknown";r!==t&&Wt.trackEvent("Action","update",String(t))}}))},rr._onMessage=(e,t)=>(tr._currentAction=e&&e.command||null,new Promise(((e,t)=>{const r=self.setTimeout((()=>t()),3e4);tr._storageController.onReady((()=>{self.clearTimeout(r),e()}))})).then((()=>{let r;return!
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
function(e){return"PAGE_LOADED"===e.command}(e)?!function(e){return"LTASSISTANT_STATUS_CHANGED"===e.command}(e)?!function(e){return"CHECK_FOR_PAID_SUBSCRIPTION"===e.command}(e)?!function(e){return"TRACK_TEXT_LENGTH"===e.command}(e)?!function(e){return"TRACK_EVENT"===e.command}(e)?!function(e){return"OPEN_FEEDBACK_FORM"===e.command}(e)?!function(e){return"SEND_FEEDBACK"===e.command}(e)?!function(e){return"OPEN_OPTIONS"===e.command}(e)?!function(e){return"OPEN_PRIVACY_CONFIRMATION"===e.command}(e)?!function(e){return"CLOSE_CURRENT_TAB"===e.command}(e)?!function(e){return"CHECK_TEXT"===e.command}(e)?!function(e){return"LAUNCH_EDITOR"===e.command}(e)?!function(e){return"GET_VALIDATOR_DATA"===e.command}(e)?!function(e){return"START_DICTIONARY_SYNC"===e.command}(e)?!function(e){return"ADD_WORD_TO_DICTIONARY"===e.command}(e)?!function(e){return"BATCH_ADD_WORDS_TO_DICTIONARY"===e.command}(e)?!function(e){return"REMOVE_WORD_FROM_DICTIONARY"===e.command}(e)?!function(e){return"CLEAR_DICTIONARY"===e.command}(e)?!function(e){return"GET_PREFERRED_LANGUAGES"===e.command}(e)?!function(e){return"LOAD_SYNONYMS"===e.command}(e)?!function(e){return"ABORT_SYNONYMS_REQUEST"===e.command}(e)?!function(e){return"LOAD_PHRASES"===e.command}(e)?!function(e){return"REPORT_PHRASE"===e.command}(e)?!function(e){return"ABORT_PHRASE_REQUESTS"===e.command}(e)?!function(e){return"LOAD_SPLIT_SENTENCE"===e.command}(e)?!function(e){return"UPDATE_DICTIONARY"===e.command}(e)?!function(e){return"OPEN_URL"===e.command}(e)?!function(e){return"OPEN_PREMIUM_PAGE"===e.command}(e)?!function(e){return"LOGIN"===e.command}(e)?!function(e){return"LOGOUT"===e.command}(e)?!function(e){return"ON_LOGIN"===e.command}(e)?!function(e){return"ON_LOGOUT"===e.command}(e)?!function(e){return"BACKGROUND_PING"===e.command}(e)?!function(e){return"INITIALIZE_USER_ACTIVITY"===e.command}(e)?!function(e){return"SEND_USER_ACTIVITY_PINGS"===e.command}(e)?!function(e){return"UPDATE_USER_ACTIVITY_TEXT_STATISTICS"===e.command}(e)?!function(e){return"UPDATE_USER_ACTIVITY_APPLIED_SUGGESTIONS"===e.command}(e)?!function(e){return"UPDATE_USER_ACTIVITY_APPLIED_REWRITINGS"===e.command}(e)?!function(e){return"UPDATE_USER_ACTIVITY_META"===e.command}(e)?!function(e){return"DESTROY_USER_ACTIVITY"===e.command}(e)?!function(e){return"SEND_USER_ACTIVITY"===e.command}(e)?!function(e){return"UPDATE_CONTEXT_MENU"===e.command}(e)?!function(e){return"TOOLBOX_NETWORK_GET_REQUEST_DATA"===e.command}(e)?function(e){return"TOOLBOX_NETWORK_ABORT_REQUEST"===e.command}(e)&&(r=tr._abortToolboxNetworkRequest(e)):r=tr._initiateToolboxNetworkRequest(e):r=tr._setContextMenu():r=tr._onSendUserActivity(t,e):r=tr._onDestroyUserActivity(t,e):r=tr._onUpdateUserActivityMeta(t,e):r=tr._onUpdateUserActivityAppliedRewritings(t,e):r=tr._onUpdateUserActivityAppliedSuggestions(t,e):r=tr._onUpdateUserActivityTextStatistics(t,e):r=tr._onHandleUserActivityPings(t,e):r=tr._onInitializeUserActivity(t,e):r=tr._onManifestV3Ping(t,e):r=tr._onLogoutUserMessage(t,e):r=tr._onLoginUserMessage(t,e):r=tr._logoutUserMessage(t,e):r=tr._loginUserMessage(t,e):r=tr._openPremiumPage(t,e):r=tr._onOpenURLMessage(t,e):r=tr._onUpdateDictionaryMessage(t,e):r=tr._onLoadSplitSentenceMessage(t,e):r=tr._onAbortPhraseRequestsMessage(t,e):r=tr._onReportRephraseMessage(t,e):r=tr._onLoadPhrasesMessage(t,e):r=tr._onAbortSynonymsRequestMessage():r=tr._onLoadSynonymsMessage(t,e):r=tr._onGetPreferredLanguagesMessage(t,e):r=tr._onClearDictionaryMessage(t,e):r=tr._onRemoveWordFromDictionaryMessage(t,e):r=tr._onBatchAddWordToDictionaryMessage(t,e):r=tr._onAddWordToDictionaryMessage(t,e):r=tr._onStartDictionarySyncMessage(t,e):r=tr._onGetValidatorDataMessage(t,e):r=tr._onLaunchEditorMessage(t,e):r=tr._onCheckTextMessage(t,e):r=tr._onCloseCurrentTabMessage(t,e):r=tr._onOpenPrivacyConfirmationMessage(t,e):r=tr._onOpenOptionsMessage(t,e):r=tr._onSendFeedbackMessage(t,e):r=tr._onOpenFeedbackFormMessage(t,e):r=tr._onTrackEventMessage(t,e):r=tr._onTrackTextLengthMessage(t,e):r=tr._onCheckForPaidSubscriptionMessage():r=tr._onLTAssistantStatusChangedMessage(t,e):r=tr._onPageLoadedMessage(t,e),r||Promise.resolve(null)}))),rr._onAlarm=e=>{switch(tr._currentAction=e.name,e.name){case"UPDATE_ICON":tr._updateIcon();break;case"CHECK_FOR_PAID_SUBSCRIPTION":tr._checkForPaidSubscription();break;case"LOAD_CONFIGURATION":tr._loadConfiguration();break;case"SYNC_USER_DATA":tr._syncUserData();break;case"SYNC_DICTIONARY":Vt.checkForInitialSync();break;case"SEND_AND_DESTROY_COMPLETED_USER_ACTIVITIES":!async function(){const e=Date.now();let t=3;const r=await zt.getAll();for(let n in r)if(e-r[n].lastPing>ke&&(await Jt(n),! --t))break}();break;default:console.warn("Unknown alarm '%s'",e.name)}},rr._onContextMenuItemClicked=(e,t)=>{if(e.menuItemId===tr.CONTEXT_MENU_ID){if(tr._currentAction="contextMenuClicked",t&&t.id&&!a.isThunderbird()){const r={command:"GET_SELECTED_TEXT"};pt().tabs.sendMessage(t.id,r).then((e=>{tr._launchEditor(e.selectedText,e.selectedHTML)})).catch((t=>{console.warn("Could not get selected text",t),tr._launchEditor(e.selectionText)}))}else tr._launchEditor(e.selectionText);tr._storageController.updateUIState({hasUsedValidator:!0})}},rr._handleUnhandledRejection=e=>{const t=String(e.reason).replace(/No (tab|window) with id: \d+/i,"No $1 with that id").replace(/Invalid (tab|window) ID: \d+/i,"Invalid $1 ID");t.includes("AbortError")||t.includes("browser is shutting down")||t.includes("FILE_ERROR_NO_SPACE")||Wt.trackError("js","unhandled_promise_rejection",(tr._currentAction||"unknown")+":"+t)},(()=>{const{manifest_version:e}=pt().runtime.getManifest();var t;if(At.init(new xt),Ft.init((()=>new Bt)),o.init(new Dt),Vt.init(),Wt.init(new er),(t=tr._getCustomUserActivityStorage())&&(zt=t),self.addEventListener("unhandledrejection",tr._handleUnhandledRejection),tr._storageController=Ft.create(),tr._storageController.onReady(tr._onDataLoaded),tr._storageController.addEventListener(Gt.eventNames.userCredentialsChanged,tr._onUserCredentialsChanged),tr._updateIcon(!0),pt().runtime.onInstalled.addListener(tr._onInstalled),pt().runtime.onMessage.addListener(tr._onMessage),pt().alarms.onAlarm.addListener(tr._onAlarm),tr._browserAction=(3===e?pt().action:pt().browserAction)||pt().composeAction,tr._contextMenu=pt().contextMenus||pt().menus,tr._setContextMenu(),a.isFirefox()||a.isThunderbird()){const e=()=>{pt().runtime.onUpdateAvailable.removeListener(e),tr._installUpdate()};pt().runtime.onUpdateAvailable.addListener(e)}tr._initThunderbird()})()})()})();