(()=>{"use strict";var t;!function(t){t.CHROME_EXTENSION_ID="CHROME_EXTENSION_ID",t.EXTN_PREFIX="EVENT_PREFIX",t.COLORS_GRAMMAR="COLORS_GRAMMAR",t.CARD_TARGET_BOX_MARGIN="CARD_TARGET_BOX_MARGIN",t.CARD_LAYOUT="CARD_LAYOUT"}(t||(t={}));const e={[t.CHROME_EXTENSION_ID]:"oldceeleldhonbafppcapldpdifcinji",[t.EXTN_PREFIX]:"lt",[t.COLORS_GRAMMAR]:{UNDERLINE:"#f2b24c",BACKGROUND:"rgba(242,179,77,0.3)",EMPHASIZE:"rgba(241,179,76,0.1)"},[t.CARD_LAYOUT]:{TARGET_BOX_MARGIN:5,HEADER_HEIGHT:36,FOOTER_HEIGHT:36,KEYBOARD_HINT_HEIGHT:60,MIN_HEIGHT_PARAPHRASE:200,MIN_HEIGHT_TOOLBOX:230,MAX_HEIGHT_TOOLBOX:360}};class n{constructor(){this.extnConfig=new Map,Object.keys(e).map((t=>{this.extnConfig.set(t,e[t])}))}static getInstance(){return this.instance||self._qb_lt_config||(this.instance=new n,self._qb_lt_config=this.instance),this.instance||self._qb_lt_config}get(t){return this.extnConfig.get(t)}set(t,e){this.extnConfig.set(t,e)}setAll(t){this.extnConfig=t}getAll(){return this.extnConfig}}const s=n.getInstance();document.documentElement.setAttribute(`data-${s.get(t.EXTN_PREFIX)}-ready`,"true");const o=s.get(t.CHROME_EXTENSION_ID);try{self._docs_annotate_canvas_by_ext=o;const t=self.chrome;self.chrome=self.chrome||{},self.chrome.runtime=self.chrome.runtime||{};const e=self.chrome.runtime.sendMessage;self.chrome.runtime.sendMessage=function(n){if(n!==o)return e.apply(this,arguments);t||delete self.chrome}}catch(t){}const r="#dd0000",i="#4285f4",a="#fce8e6",c="#e8f0fe",l=/rgba\(31,\s*161,\s*93,\s*0\.|rgba\(255,\s*0,\s*122,\s*0\.|rgba\(0,\s*163,\s*187,\s*0\.|rgba\(119,\s*119,\s*119,\s*0\.|rgba\(19,\s*115,\s*51,\s*0\.|rgba\(184,\s*6,\s*114,\s*0\.|rgba\(147,\s*52,\s*230,\s*0\.|rgba\(163,\s*90,\s*0,\s*0\./i,f=document.getElementsByTagName(`${s.get(t.EXTN_PREFIX)}-gdocs-disabled`);function g(){return!!f.length}let h=!1;const u=[];function p(t,e,n={}){var s;s=()=>{const s=new CustomEvent(e,{detail:n,bubbles:!0});t.dispatchEvent(s)},h?s():u.push(s)}document.addEventListener(`${s.get(t.EXTN_PREFIX)}-gdocs-init`,(()=>{u.forEach((t=>t())),u.length=0,h=!0}));const _=new Map,E=new Map,R=CanvasRenderingContext2D.prototype.moveTo;CanvasRenderingContext2D.prototype.moveTo=function(t,e){return _.set(this,{x:t,y:e}),R.apply(this,arguments)};const d=CanvasRenderingContext2D.prototype.lineTo;CanvasRenderingContext2D.prototype.lineTo=function(e,n){const o=this.strokeStyle.toString(),a=_.get(this);_.set(this,{x:e,y:n});if([r,i].includes(o.toLowerCase())&&!g())return;if(a?.y===n&&l.test(o)&&!g()){let o=E.get(this);o||(o=[],E.set(this,o));let{a:r,b:i,c,d:l,e:f,f:g}=this.getTransform();const h=Math.min(a.x,e)*r+f,u=Math.max(a.x,e)*r+f,_=n*l+g-this.lineWidth/2,R=n*l+g+this.lineWidth/2;o.push({left:h,right:u,top:_,bottom:R}),this.canvas&&p(this.canvas,`${s.get(t.EXTN_PREFIX)}-strikethroughchange`,{strikethroughLines:o})}return d.apply(this,arguments)};const C=CanvasRenderingContext2D.prototype.fillRect;CanvasRenderingContext2D.prototype.fillRect=function(t,e,n,s){const o=this.fillStyle.toString();if(!([a,c].includes(o.toLowerCase())&&!g()))return C.apply(this,arguments)};const T=CanvasRenderingContext2D.prototype.clearRect;CanvasRenderingContext2D.prototype.clearRect=function(e,n,o,r){let i=E.get(this);if(i&&!g()){let{a,b:c,c:l,d:f,e:g,f:h}=this.getTransform();const u=e*a+g,_=n*f+h,R={top:_,left:u,bottom:_+r*f,right:u+o*a},d=i.length;i=i.filter((t=>{return n=R,!!((e=t).left>n.right||e.right<n.left||e.top>n.bottom||e.bottom<n.top);var e,n})),d!==i.length&&(E.set(this,i),p(this.canvas,`${s.get(t.EXTN_PREFIX)}-strikethroughchange`,{strikethroughLines:i}))}return T.apply(this,arguments)};const y=CanvasRenderingContext2D.prototype.stroke;CanvasRenderingContext2D.prototype.stroke=function(){if(arguments[0]){const t=this.strokeStyle.toString();if([r,i].includes(t.toLowerCase())&&!g())return}return y.apply(this,arguments)};let m=null;function A(){try{if(null===m&&(m=function(){const t=self.KX_kixApp;if(!t)return null;const e=[[t,["KX_kixApp"]]],n=new Set([t]);for(const[t,s]of e){const o=Object.getOwnPropertyNames(t);for(const r of o)try{const o=t[r];if("string"==typeof o&&o.startsWith(""))return s.concat(r);!(!(s.length<20&&o instanceof Object)||o instanceof Node||o instanceof Window||o instanceof RegExp||o instanceof Date||o instanceof Map||Array.isArray(o)||n.has(o))&&(n.add(o),e.push([o,s.concat(r)]))}catch(t){}}return null}()),null===m)return"";let t=self;for(const e of m)t=t[e];if("string"==typeof t)return t}catch(t){}return""}document.addEventListener("LanguageTool-getFullText",(t=>{try{const e=t.detail?.datasetPropName;e&&(document.body.dataset[e]=A())}catch(t){}}))})();